## Билет 24

### Китайская теорема об остатках

#### Теорема 19

Пусть $m_1, \ldots, m_k$ — попарно взаимно простые натуральные числа, $m = m_1 \cdots m_k$, $a_1, \ldots, a_k \in \mathbb{Z}$. Тогда существует единственное такое $a \in \{0, 1, \ldots, m - 1\}$, что $a \equiv_{m_1} a_1, \ldots, a \equiv_{m_k} a_k$.

**Доказательство.**

- Пусть $n_\ell = m_1 \cdots m_\ell$. Докажем индукцией по $\ell$ существование такого $b_\ell \in \mathbb{Z}$, что $b_\ell \equiv_{m_1} a_1, \ldots, b_\ell \equiv_{m_\ell} a_\ell$.
  - База $\ell = 1$ очевидна.
  - Переход $\ell \rightarrow \ell + 1$.
    - Так как $(m_{\ell+1}, n_\ell) = 1$ по [Теореме 13](#теорема-13), числа $b_\ell, b_\ell + n_\ell, b_\ell + 2n_\ell, \ldots, b_\ell + (m_{\ell+1} - 1)n_\ell$ — ПСВ (mod $m_{\ell+1}$) (они получены из ПСВ $0, 1, \ldots, m_{\ell+1} - 1$ умножением на $n_\ell$ и прибавлением $b_\ell$).
    - Значит, среди этих чисел есть число $kn_\ell + b_\ell \equiv_{m_{\ell+1}} a_{\ell+1}$.
    - Положим $b_{\ell+1} := kn_\ell + b_\ell$.
    - Тогда $b_{\ell+1} \equiv_{m_{\ell+1}} a_{\ell+1}$.
    - По построению $b_{\ell+1} \equiv_{n_\ell} b_\ell$. Так как по индукционному предположению $b_\ell \equiv_{m_i} a_i$ для всех $i \in \{1, \ldots, \ell\}$, мы имеем $b_{\ell+1} \equiv_{m_i} a_i$ для всех $i \in \{1, \ldots, \ell\}$.
- Итак, мы получили число $b_k$, удовлетворяющее всем требованиям теоремы, кроме одного: число должно быть от $0$ до $m - 1$.
  - Для получения такого числа $a$ поделим $b_k$ с остатком на $m$: пусть $b_k = mq + a$, $0 \le a \le m - 1$.
  - Так как $a \equiv_{m} b_k$ и $b_k \equiv_{m_i} a_i$, то и $a \equiv_{m_i} a_i$ для всех $i \in \{1, \ldots, k\}$.
- Предположим, что $a$ и $a'$ — два различных числа, удовлетворяющих условию. Тогда $a - a' \equiv_{m_i} 0$ для всех $i \in \{1, \ldots, k\}$.
  - Так как $m_1, \ldots, m_k$ попарно взаимно просты, по [Лемме 7](#лемма-7) $a - a' \equiv_{m} 0 = m_1 \cdots m_k$. Но $|a - a'| < m$, противоречие.

- Из доказательства единственности в [Теореме 19](#теорема-19) видно, что все целые числа $a$, для которых $a \equiv_{m_i} a_i$ при всех $i \in \{1, \ldots, k\}$ образуют в точности один вычет по модулю $m = m_1 \cdots m_k$.