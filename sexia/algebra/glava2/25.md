## Билет 25

### Алгоритмы поиска решения для КТО

#### Алгоритмы поиска решения для КТО

- Пусть $m_1, \ldots, m_k$ — попарно взаимно простые натуральные числа, $m = m_1 \cdots m_k$, $a_1, \ldots, a_k \in \mathbb{Z}$.
- Мы ищем такое $a$, что $a \equiv_{m_1} a_1, \ldots, a \equiv_{m_k} a_k$.

Будет использоваться алгоритм поиска обратного вычета, описанный выше.

#### Алгоритм 1

- Пусть $m'_i = \frac{m}{m_i}$. Тогда $(m'_i, m_i) = 1$.
- $b_i \in \{0, 1, \ldots, m_i - 1\}$ — такое число, что $b_i \cdot m'_i \equiv 1 \pmod{m_i}$ (мы найдем $b_i$ с помощью алгоритма поиска обратного вычета) [Билет 22](#Билет-22).

**Утверждение**

$a = a_1 b_1 m'_1 + a_2 b_2 m'_2 + \cdots + a_k b_k m'_k$ — решение.

**Доказательство.**

- Так как $m'_j \ \vdots \ m_i$ при всех $j \neq i$, для любого $i \in \{1, \ldots, k\}$ $a \equiv a_i b_i m'_i \equiv a_i \pmod{m_i}$.
- Как сказано выше, все решения системы — это в точности числа, сравнимые с $a$ по модулю $m$.
- Поделив $a$ на $m$ с остатком, мы найдем решение системы среди чисел $0, 1, \ldots, m - 1$.

#### Алгоритм 2

- Индукцией по $s$ найдем $x_s$, удовлетворяющее первым $s$ сравнениям: $x_s \equiv_{m_1} a_1, \ldots, x_s \equiv_{m_s} a_s$.
- База $s = 1$ очевидна: подойдет $x_1 = a_1$.

**Переход $s \rightarrow s + 1$**

- Пусть $n_s = m_1 \cdots m_s$. Будем искать решение в виде $x_{s+1} = x_s + c_s n_s$.
- Тогда $x_{s+1} - x_s \vdots m_j$ для всех $j \in \{1, \ldots, s\}$, поэтому $x_{s+1}$ удовлетворяет первым $s$ сравнениям.
- Подберем $c_s$ так, чтобы $x_{s+1} \equiv a_{s+1} \pmod{m_{s+1}}$: $x_s + c_s n_s \equiv a_{s+1} \pmod{m_{s+1}} \Leftrightarrow c_s n_s \equiv a_{s+1} - x_s \pmod{m_{s+1}} \Leftrightarrow c_s \equiv (a_{s+1} - x_s) \cdot n_s^{-1} \pmod{m_{s+1}}$.
- Так как $(n_s, m_{s+1}) = 1$, обратный вычет $n_s^{-1}$ существует и может быть найден с помощью описанного выше алгоритма.
- Второй алгоритм решения КТО на первый взгляд сложнее, чем первый, но требует применения $k - 1$ алгоритмов поиска обратного вычета (а не $k$): мы не ищем обратный вычет по модулю $m_1$.
- Поэтому, целесообразно нумеровать модули так, чтобы $m_1$ оказался самым большим.
