## Билет 1

## Делимость. Свойства. Теорема о делении с остатком
## Делимость

### Определение

Пусть $a,b \in \mathbb{Z}$, $b \neq 0$. Тогда $a$ делится на $b$ (обозначение: $a \vdots b$) или, что то же самое, $b$ делит $a$ (обозначение: $b \mid a$), если $a = bc$, где $c \in \mathbb{Z}$. Если $a \vdots b$, то $b$ — делитель $a$.

### Свойство 1

Если $a \vdots b$ и $b \vdots c$, то $a \vdots c$.

#### Доказательство

Тогда $a = kb$ и $b = nc$, где $k,n \in \mathbb{Z}$, откуда следует $a = knc$.

### Свойство 2

Пусть $a,b \vdots d$, а $x,y \in \mathbb{Z}$. Тогда $ax + by \vdots d$.

#### Доказательство

Тогда $a = kd$ и $b = nd$, где $k,n \in \mathbb{Z}$, откуда следует $ax + by = (kx + ny)d$.

### Свойство 3

Пусть $a,d \in \mathbb{N}$, $a \vdots d$. Тогда $a \geq d$.

#### Доказательство

Тогда $a = kd$, где $k \in \mathbb{N}$, откуда следует $a = kd \geq d$.

## Теорема о делении с остатком

### Теорема 1

Пусть $a \in \mathbb{Z}$, $b \in \mathbb{N}$. Тогда существуют единственные такие $q,r \in \mathbb{Z}$, что $0 \leq r < b$ и $a = bq + r$.

- Число $r$ называется остатком от деления $a$ на $b$.

#### Доказательство

$\exists$. Пусть $q$ — такое целое число, что $bq \leq a < b(q+1)$, а $r = a - bq$. Тогда $0 \leq r < b$ (вычтем из всех трех частей первого неравенства $bq$).

- Пусть $a = bq_1 + r_1 = bq_2 + r_2$, причем $0 \leq r_1 < b$ и $0 \leq r_2 < b$.
- НУО $r_1 > r_2$. Тогда $0 < r_1 - r_2 < b$.
- С другой стороны, $r_1 - r_2 = b(q_2 - q_1) \geq b$. Противоречие.


## Билет 2

## НОД. Свойства.

## НОД

### Определение

Пусть $a_1, \ldots, a_n \in \mathbb{Z}$. Обозначим через $\text{OD}(a_1, \ldots, a_n)$ множество всех общих делителей этих чисел, а через $(a_1, \ldots, a_n)$ — их НОД (наибольший из общих делителей).

### Свойство 1

Если $b \in \mathbb{N}$ и $a \vdots b$, то $\text{OD}(a, b)$ — это все делители $b$ и $(a, b) = b$.

#### Доказательство

- Если $d$ — общий делитель $a$ и $b$, то $d$ — делитель $b$.
- Если $d$ — делитель $b$, то $a \vdots d$ по свойству 1 делимости. Значит, $d$ — общий делитель $a$ и $b$.

### Свойство 2 НОД

Пусть $a, b, c, k \in \mathbb{Z}$ и $c = a + kb$. Тогда $\text{OD}(a, b) = \text{OD}(c, b)$, а следовательно, и $(a, b) = (c, b)$.

#### Доказательство

- Пусть $d \in \text{OD}(a, b)$. Тогда $c \vdots d$, а значит, $d \in \text{OD}(c, b)$.
- Наоборот, если $d \in \text{OD}(c, b)$, то $a = c - kb \ \vdots \  d$, а значит, $d \in \text{OD}(a, b)$.


## Билет 3

## Алгоритм Евклида. Следствия из алгоритма Евклида.

## Алгоритм Евклида

### Описание алгоритма

- Пусть $a,b \in \mathbb{N}$, $a > b$. Каждая строка алгоритма - деление с остатком.

  1) $a = bq_1 + r_1$, $0 \leq r_1 < b$
  2) $b = r_1q_2 + r_2$, $0 \leq r_2 < r_1$
  3) $r_1 = r_2q_3 + r_3$, $0 \leq r_3 < r_2$
  4) $\ldots$
  5) $r_{n-2} = r_{n-1}q_n + r_n$, $0 \leq r_n < r_{n-1}$
  6) $r_{n-1} = r_nq_{n+1}$
- Так как $b > r_1 > r_2 > \ldots$ и все эти числа неотрицательны, алгоритм обязательно закончит работу.

### Теорема 2

$(a, b) = r_n$, а $\text{OD}(a,b)$ - это все делители $(a,b)$.

#### Доказательство

- По свойству 2 НОД $\text{OD}(a,b) = \text{OD}(b,r_1) = \text{OD}(r_1,r_2) = \ldots = \text{OD}(r_{n-1},r_n)$, а это по свойству 1 НОДа - все делители $r_n$.

> $r_1=a-k_1b$
> $r_2 = b - k_2r_1$
> $\vdots$
> $r_n=r_{n-2}-k_nr_{n-1}$

- Тогда $(a,b)$ - наибольший из делителей $r_n$, а это $r_n$.

### Теорема 3

Пусть $a,b,m,d \in \mathbb{N}$. Тогда:

1) $(am,bm) = m(a,b)$.
2) Если $d \in \text{OD}(a,b)$, то $\left(\frac{a}{d}, \frac{b}{d}\right) = (a,b)$.

#### Доказательство

- НУО $a > b$.

1) Рассмотрим первую строку алгоритма Евклида для $am$ и $bm$:
   $am = bm \cdot q_1 + r_1m$, $0 \leq r_1m < bm$.
   - Неполное частное не меняется, а остаток умножается на $m$.
   - Так будет и со следующими строчками, в результате получится столько же строк, сколько в алгоритме Евклида для $a$ и $b$, а НОД — последний ненулевой остаток — умножится на $m$.
2) Рассмотрим первую строку алгоритма Евклида для $\frac{a}{d}$ и $\frac{b}{d}$:
   $\frac{a}{d} = \frac{b}{d} \cdot q_1 + \frac{r_1}{d}$, $0 \leq \frac{r_1}{d} < \frac{b}{d}$.
   - Неполное частное не меняется, а остаток мы делим на $d$ (в результате он остается целым).
   - Так будет и со следующими строчками, в результате получится столько же строк, сколько в алгоритме Евклида для $a$ и $b$, а НОД — последний ненулевой остаток — разделится на $d$.


## Билет 4

### Линейное представление НОД

#### Теорема 4

Пусть $a,b \in \mathbb{Z}$. Тогда существуют такие $x,y \in \mathbb{Z}$, что $(a, b) = ax + by$.

- Это называется линейным представлением НОДа.

#### Доказательство

- Так как делители у чисел $a$ и $-a$ одни и те же, $(a,b) = (a,-b)$. Поэтому, можно считать, что $a,b \in \mathbb{N}$.
- НУО $a \geq b$. Воспользуемся алгоритмом Евклида и соответствующими обозначениями, дополним их: пусть $r_0 = b$ и $r_{-1} = a$.
- Докажем, что существует представление $(a, b) = x_k r_k + y_k r_{k-1}$ для всех $k = \{n, \ldots, 0\}$ (где $(a,b) = r_n$) индукцией с обратным ходом. При $k = 0$ получим утверждение теоремы.
- База $k = n$ очевидна: $(a,b) = 1 \cdot r_n + 0 \cdot r_{n-1}$.
- Переход $k \rightarrow k - 1$. Из алгоритма Евклида мы знаем, что $r_k = r_{k-2} - r_{k-1} q_k$. Подставим:
  $$
  (a, b) = x_k r_k + y_k r_{k-1} = x_k (r_{k-2} - r_{k-1} q_k) + y_k r_{k-1} = (-x_k q_k + y_k) r_{k-1} + x_k r_{k-2}
  $$


## Билет 5

### НОД нескольких чисел через НОД двух чисел. Линейное представление НОД нескольких чисел.

#### НОД нескольких чисел

**Теорема 5**

Пусть $n \geq 2$, $a_1, \ldots, a_n \in \mathbb{Z}$. Положим $m_2 = (a_1, a_2)$, $m_3 = (m_2, a_3)$, $\ldots$, $m_n = (m_{n-1}, a_n)$. Тогда $m_n = (a_1, \ldots, a_n)$, а $\text{OD}(a_1, \ldots, a_n)$ - это все делители $m_n$.

**Доказательство.**

- Индукцией по $k$ докажем, что $\text{OD}(a_1, \ldots, a_k)$ - все делители $m_k$.
- База $k = 2$ доказана в [Теореме 2](#теорема-2).
- Переход $k \rightarrow k + 1$. $\text{OD}(a_1, \ldots, a_k, a_{k+1})$ - это все числа из $\text{OD}(a_1, \ldots, a_k)$, являющиеся делителями $a_{k+1}$.
- Так как $\text{OD}(a_1, \ldots, a_k)$ - это все делители $m_k$, получаем, что $\text{OD}(a_1, \ldots, a_k, a_{k+1}) = \text{OD}(m_k, a_{k+1})$, а это все делители $m_{k+1} = (m_k, a_{k+1})$ по [Теореме 2](#теорема-2).
- Итак, утверждение доказано и $\text{OD}(a_1, \ldots, a_n)$ - это все делители $m_n$. Теперь понятно, что $m_n = (a_1, \ldots, a_n)$.

#### Следствие 1

Для $a_1, \ldots, a_n \in \mathbb{Z}$ существует линейное представление НОД, то есть, такие $x_1, \ldots, x_n \in \mathbb{Z}$, что $(a_1, \ldots, a_n) = x_1 a_1 + \ldots + x_n a_n$.

**Доказательство.**

- Докажем индукцией по $k$, что существует линейное представление $m_k = (a_1, \ldots, a_k)$.
- База $k = 2$ доказана в [Теореме 4](#теорема-4).
- Переход $k \rightarrow k + 1$. По [Теореме 5](#теорема-5) и индукционному предположению, $m_{k+1} = (a_1, \ldots, a_k, a_{k+1}) = (m_k, a_{k+1}) = y m_k + x_{k+1} a_{k+1} = y (x'_1 a_1 + \ldots + x'_k a_k) + x_{k+1} a_{k+1} = (y x'_1) a_1 + \ldots + (y x'_k) a_k + x_{k+1} a_{k+1}$.
- Все коэффициенты $y x'_1, \ldots, y x'_k$ очевидно целые.


## Билет 6

### Взаимно простые числа. Свойства.

#### Взаимно простые числа

**Определение**

- Числа $a_1, \ldots, a_n \in \mathbb{Z}$ называются взаимно простыми, если $(a_1, \ldots, a_n) = 1$.
- Если любые два из $a_1, \ldots, a_n$ взаимно просты, эти числа называются попарно взаимно простыми.

#### Свойство 1

Если $a_1, \ldots, a_n \in \mathbb{Z}$ попарно взаимно просты, то они взаимно просты.

**Доказательство.** Если $(a_1, \ldots, a_n) = d > 1$, то $(a_1, a_2) \ \vdots \ d$, а значит, $(a_1, a_2) > 1$.

#### Свойство 2

Если $a, b, c \in \mathbb{Z}$ и $(a, b) = 1$, то $(ac, b) = (c, b)$.

**Доказательство.**

- Пусть $d = (c, b)$ и $f = (ac, b)$.
- Из $c \ \vdots \ d$ следует, что $ac \ \vdots \ d$. Значит, $d \in \text{OD}(ac, b)$ и по [Теореме 2](#теорема-2) $f \ \vdots \ d$.
- Из $b \ \vdots \ f$ следует, что $bc \ \vdots \ f$. Значит, $f \in \text{OD}(ac, bc)$.
- По [Теоремам 3 и 2](#теорема-3), $c = c(a, b) = (ac, bc) \ \vdots \ f$.
- Следовательно, $f \in \text{OD}(c, b)$ и по [Теореме 2](#теорема-2) $d \ \vdots \ f$.
- Из $d, f \in \mathbb{N}$, $d \ \vdots \ f$ и $f \ \vdots \ d$ следует, что $d = f$.

#### Свойство 3 взаимно простых чисел

Если $a, b, c \in \mathbb{Z}$, $(a, b) = 1$ и $ac \ \vdots \ b$, то $c \ \vdots \ b$.

**Доказательство.** По Свойству 2 $(c, b) = (ac, b) = b$ (последнее верно так как $ac \ \vdots \ b$). Следовательно, $c \vdots b$.

#### Свойство 4 для взаимно простых чисел

Пусть $a_1, \ldots, a_n, b_1, \ldots, b_m \in \mathbb{Z}$, причем $(a_i, b_j) = 1$ для всех $i \in \{1, \ldots, n\}$ и $j \in \{1, \ldots, m\}$. Тогда $(a_1 \ldots a_n, b_1 \ldots b_m) = 1$.

**Доказательство.**

- Докажем, что $(a_1 \ldots a_k, b_j) = 1$ для всех $j \in \{1, \ldots, m\}$ и $k \in \{1, \ldots, n\}$ индукцией по $k$.
- База $k = 1$: дано в условии.
- Переход $k \rightarrow k + 1$: $(a_1 \cdots a_k a_{k+1}, b_j) = (a_1 \cdots a_k, b_j) = 1$ по свойству 2 (так как $(a_{k+1}, b_j) = 1$).
- Пусть $A = a_1 \cdots a_n$. Докажем, что $(A, b_1 \cdots b_k) = 1$ для всех $k \in \{1, \ldots, m\}$ индукцией по $k$.
- База $k = 1$: доказано выше.
- Переход $k \rightarrow k + 1$: $(A, b_1 \cdots b_k b_{k+1}) = (A, b_1 \cdots b_k) = 1$ по свойству 2 (так как $(A, b_{k+1}) = 1$).


## Билет 7

### Простые числа, свойства. Бесконечность количества простых

#### Простые числа

**Определение**

- Натуральное число, имеющее ровно два натуральных делителя, называется простым.
- Натуральное число, имеющее более двух натуральных делителя, называется составным.
- Множество всех простых чисел обозначается $P$.
- Если $p \in P$, то натуральные делители числа $p$ — это $1$ и $p$.
- $1 \notin P$. Любое натуральное число, большее $1$ — простое или составное.

**Определение**

- Пусть $a \in \mathbb{N}$. Собственный делитель числа $a$ — это любой его делитель, отличный от $1$.

#### Свойство 1

Если $a \in \mathbb{N}$ — составное, то существует разложение $a = bc$, где $b, c \in \mathbb{N}$, $a > b$, $c > 1$.

**Доказательство.**

- Составное число $a$ имеет собственный делитель $b < a$. Тогда $a = bc$, где $c \in \mathbb{N}$. Очевидно, $1 < c < a$.

#### Свойство 2

Пусть $a \in \mathbb{N}$, $a \neq 1$, а $d$ — минимальный собственный делитель $a$. Тогда $d \in P$.

**Доказательство.**

- По определению, $d > 1$.
- Предположим, что $d$ — составное. По свойству 1 тогда $d = bc$, где $d > b > 1$.
- Из $a \vdots d$ и $d \vdots b$ следует, что $a \vdots b$. Значит, $b < d$ — собственный делитель $a$, противоречие с выбором $d$.

#### Теорема 6

Простых чисел бесконечно много.

**Доказательство.**

- Предположим противное, пусть $P = \{p_1, \ldots, p_n\}$.
- Пусть $m = p_1 \cdots p_n + 1$, а $q$ — наименьший собственный делитель $m$.
- По свойству 2 тогда $q \in P$. Значит, $q = p_i$ для некоторого $i \in \{1, \ldots, n\}$.
- Так как $m - 1 \vdots p_i$, $(m, p_i) = (1, p_i) = 1$ (по свойству 2 НОДа). Значит, $m \  не \  делитися \ на \  p_i$, противоречие.

#### Свойство 3

Пусть $a \in \mathbb{Z}$, $p \in P$. Тогда либо $a \vdots p$, либо $(a, p) = 1$.

**Доказательство.**

- Так как $d = (a, p) \in \mathbb{N}$ и $p \vdots d$, то $d = 1$ или $d = p$.
- Во втором случае $(a, p) = p$, следовательно, $a \vdots p$.

#### Свойство 4

Пусть $a_1, \ldots, a_n \in \mathbb{Z}$ и $p \in P$ таковы, что $a_1 \cdots a_n \ \vdots \  p$. Тогда существует такое $i \in \{1, \ldots, n\}$, что $a_i \vdots p$.

**Доказательство.**

- Предположим противное, пусть $a_i \not\vdots \ \  p$ для всех $i \in \{1, \ldots, n\}$. По Свойству 3 тогда $(a_i, p) = 1$.
- По [Свойству 4](#Свойство-4-для-взаимно-простых-чисел) взаимно простых чисел, тогда и $(a_1 \cdots a_n, p) = 1$. Значит, $a_1 \cdots a_n \not\vdots \ \ p$. Противоречие.


## Билет 8

### Основная теорема арифметики в $\mathbb{Z}$

#### Основная теорема арифметики

**Теорема 7**

Любое натуральное число $a > 1$ раскладывается в произведение простых чисел. Такое разложение единственно с точностью до порядка сомножителей.

**Доказательство.**

- $\exists$. Индукция.

  - База $a \in P$ очевидна: подходит разложение $a = a$.
  - Переход. Пусть $a$ — составное, а для всех меньших чисел теорема доказана.
    - Тогда $a = bc$, где $1 < b, c < a$. Следовательно, $b = p_1 \ldots p_n$ и $c = q_1 \ldots q_m$.
    - Тогда $a = p_1 \ldots p_n q_1 \ldots q_m$ — искомое разложение.
- Предположим противное, пусть $a = p_1 \ldots p_n = q_1 \ldots q_m$ — два разложения $a$ в произведение простых, причем $a$ — наименьшее натуральное число, для которого разложение в произведение простых неединственно.

  - Из $a = p_1 \ldots p_n \ \vdots \  q_1$ следует, что $p_i \vdots q_1$ для некоторого $i \in \{1, \ldots, n\}$. НУО $i = 1$.
  - Из $p_1, q_1 \in P$ и $p_1 \vdots q_1$ следует, что $p_1 = q_1$ (единственным делителем простого $p_1$, большим $1$, является само $p_1$).
  - Тогда $a' = \frac{a}{p_1} = p_2 \ldots p_n = q_2 \ldots q_m$. Но разложение $a'$ в произведение простых единственно с точностью до порядка сомножителей, откуда следует, что разложение $a$ — тоже единственно с точностью до порядка сомножителей.


## Билет 9

### Каноническое разложение. Количество натуральных делителей числа.

#### Каноническое разложение

**Определение**

- Каноническое разложение — это представление натурального числа в виде $n = p_1^{k_1} \cdots p_s^{k_s}$, где $p_1, \ldots, p_s \in P$ различны.

**Определение**

- Для $n \in \mathbb{N}$ обозначим через $d(n)$ количество натуральных делителей $n$.

#### Теорема 8. Количесвто натуральных делителей числа.

Пусть $n = p_1^{k_1} \cdots p_s^{k_s}$ — каноническое разложение. Тогда выполнены следующие утверждения:

1. $n \vdots d$, если и только если $d = p_1^{\ell_1} \cdots p_s^{\ell_s}$, где $0 \leq \ell_i \leq k_i$ для всех $i \in \{1, \ldots, s\}$.
2. $d(n) = (k_1 + 1) \cdots (k_s + 1)$.

**Доказательство**

1. $\Leftarrow$. Очевидно.

   $\Rightarrow$. Если $n \vdots d$, то $d$ не может иметь простых делителей, кроме $p_1, \ldots, p_s$. Следовательно, $d = p_1^{\ell_1} \cdots p_s^{\ell_s}$.

   - Если $\ell_i > k_i$ для какого-то $i \in \{1, \ldots, s\}$, то очевидно, что $n \not\vdots \ \ d$.
2. Показатель степени простого числа $p_i$ в каноническом разложении делителя $d \mid n$ можно выбрать $k_i + 1$ способами (0, 1, ..., $k_i$).

   - Перемножаем количество вариантов для $p_1, \ldots, p_s$ и получаем доказываемую формулу.


## Билет 10

## Представление НОД чисел через их канонические разложения.

### Теорема 9

Пусть $a_1, \ldots, a_m \in \mathbb{N}$, $p_1, \ldots, p_s \in P$ причем $a_i = p_1^{k_{i,1}} \cdots p_s^{k_{i,s}}$ для всех $i \in \{1, \ldots, m\}$ (некоторые из показателей могут быть равны 0). Тогда

$$
(a_1, \ldots, a_m) = p_1^{\min(k_{1,1}, \ldots, k_{m,1})} \cdots p_s^{\min(k_{1,s}, \ldots, k_{m,s})}.
$$

**Доказательство.**

- По [Теореме 8](#теорема-8), $d \ \vdots \ a_t$, если и только если $d = p_1^{\ell_1} \cdots p_s^{\ell_s}$, где $\ell_j \leq k_{t,j}$ для всех $j \in \{1, \ldots, s\}$.
- Следовательно, $d \in \text{OD}(a_1, \ldots, a_m)$, если и только если $d = p_1^{\ell_1} \cdots p_s^{\ell_s}$, где $\ell_i \leq \min(k_{1,i}, \ldots, k_{m,i})$ для всех $i \in \{1, \ldots, s\}$.
- Теперь понятно, что наибольший элемент в $\text{OD}(a_1, \ldots, a_m)$ вычисляется в точности по формуле из условия.


## Билет 11

## Линейные диофантовы уравнения с двумя неизвестными

Линейные диофантовы уравнения с двумя неизвестными:

- $ax + by = c$ (*)
  , где $a, b, c \in \mathbb{Z}$ — константы, $x, y \in \mathbb{Z}$ — неизвестные.
- Пусть $d = (a, b)$. Если $c \not\vdots \ \ d$, то $(*)$ не имеет решений.
- Далее $c \vdots d$. Пусть $a = da'$, $b = db'$, $c = dc'$. Тогда уравнение $(*)$ эквивалентно

  $$
  a'x + b'y = c' \ \ \ \ , где \ (a', b') = 1. \ \ \ \ \ \ \ \ (**)
  $$
- Существует линейное представление НОД: $a'x_0 + b'y_0 = 1$. Умножив на $c'$, получим $a'(x_0c') + b'(y_0c') = c'$.

### Теорема 10

Решения уравнения $(*)$ представляются в виде $x = x_0c' + tb'$, $y = y_0c' - ta'$, где $t \in \mathbb{Z}$.

**Доказательство.**

- Будем работать с эквивалентным уравнением $(**)$. Проверим, что это действительно его решения:
  $$
  a'(x_0c' + tb') + b'(y_0c' - ta') = a'(x_0c') + b'(y_0c') + a'tb' - b'ta' = c'.
  $$
- Пусть $(x, y)$ — решение $(*)$. Тогда $a'x + b'y = c' = a'(x_0c') + b'(y_0c') \Rightarrow a'(x - x_0c') = b'(y_0c' - y)$.
- Тогда $a'(x - x_0c') \ \vdots \ b'$. Так как $(a', b') = 1$, откуда $x - x_0c' \ \vdots \  b'$. Пусть $x - x_0c' = tb'$.
- Аналогично, $y_0c' - y \ \vdots \ a'$. Пусть $y_0c' - y = sa'$.
- Тогда $a'tb' = b'sa'$, откуда $s = t$.


## Билет 12

### Идеалы в $\mathbb{Z}$

Идеалы в $\mathbb{Z}$:
- Пусть $m \in \mathbb{N}$, тогда нетрудно проверить, что $m\mathbb{Z} = \{mx : x \in \mathbb{Z}\}$ — идеал в $\mathbb{Z}$.

#### Теорема 11

Пусть $I$ — идеал в $\mathbb{Z}$. Тогда $I = m\mathbb{Z}$, где $m \in \mathbb{N}_0$.

**Доказательство.**

- Если $I = \{0\}$, то подходит $m = 0$.
- Далее $I \neq \{0\}$.
- Пусть $a \in I$, $a \neq 0$. Тогда и $-a \in I$. Одно из чисел $a$ и $-a$ — натуральное. Таким образом, $I' = I \cap \mathbb{N} \neq \emptyset$.
- Тогда существует минимальный элемент в $I'$, обозначим его $m$. Докажем, что $I = m\mathbb{Z}$.
- Предположим противное, пусть $b \in I$, $b \not\in m\mathbb{Z}$. Тогда $b = mq + r$, где $0 < r < m$ (теорема о делении с остатком).
- Так как $b, m \in I$, имеем $r = b - mq \in I$. Тогда $r \in I'$. Противоречие с минимальностью $m$.

## Билет 13

## Линейное представление НОД: доказательство существования с помощью идеала

### НОД через идеал

**Теорема 12**

Пусть $a_1, \ldots, a_n \in \mathbb{Z} \setminus \{0\}$. Тогда существует линейное представление $(a_1, \ldots, a_n)$, а $\text{OD}(a_1, \ldots, a_n)$ состоит из всех делителей $(a_1, \ldots, a_n)$.

**Доказательство.**

- Пусть $I = \langle \{a_1, \ldots, a_n\} \rangle$. Этот идеал состоит из линейных комбинаций чисел $a_1, \ldots, a_n$.
- Очевидно, $I \neq \{0\}$. Тогда по [Теореме 11](#теорема-11) существует такое $d \in \mathbb{N}$, что $I = d\mathbb{Z}$ — состоит из кратных $d$.
- Так как $a_1, \ldots, a_n \in I$, все они делятся на $d$, значит, $d \in \text{OD}(a_1, \ldots, a_n)$.
- С другой стороны, $d \in I$, а значит, $d = x_1a_1 + \cdots + x_na_n$, где $x_1, \ldots, x_n \in \mathbb{Z}$.
- Значит, для любого $f \in \text{OD}(a_1, \ldots, a_n)$ мы имеем $d \ \vdots \ f$.
- Так как $d > 0$, $d$ — наибольший элемент в $\text{OD}(a_1, \ldots, a_n)$, то есть, $d = (a_1, \ldots, a_n)$.


## Билет 14

## Сравнения по модулю натурального числа, свойства. Вычеты.

### Сравнения

**Определение**

Пусть $m \in \mathbb{N}$; $a, b \in \mathbb{Z}$. Будем говорить, что $a$ сравнимо с $b$ по модулю $m$, если $a - b \ \vdots \ m$. Обозначения: $a \equiv_m b$ или $a \equiv b \ (\text{mod} \ m)$.

### Лемма 1

Пусть $m \in \mathbb{N}$; $a, b \in \mathbb{Z}$. Следующие утверждения равносильны:

1. $a \equiv b \ (\text{mod} \ m)$.
2. $a - b \ \vdots \ m$.
3. $a$ и $b$ имеют одинаковые остатки от деления на $m$.
4. $a \equiv b \ (\text{mod} \ m\mathbb{Z})$.

**Доказательство.**

1. $1 \Leftrightarrow 2$ по определению сравнения.
2. $2 \Leftrightarrow 3$ очевидно.
3. $2 \Leftrightarrow 4$ по определению главного идеала $m\mathbb{Z}$.

### Свойство 1

Если $a \equiv_m a'$ и $b \equiv_m b'$, а $x, y \in \mathbb{Z}$, то $ax + by \equiv_m a'x + b'y$.

**Доказательство.**

$ax + by - (a'x + b'y) = x(a - a') + y(b - b') \ \vdots \  m$.

### Свойство 2

Если $a \equiv_m a'$ и $b \equiv_m b'$, то $ab \equiv_m a'b'$.

**Доказательство.**

$ab - a'b' = (ab - a'b) + (a'b - a'b') = (a - a')b + a'(b - b') \ \vdots \  m$.

### Свойство 3

Если $a \equiv_m b$ и $n \in \mathbb{N}$, то $a^n \equiv_m b^n$.

**Доказательство.**

- Индукция по $n$. База $n = 1$ очевидна.
- Переход $n \rightarrow n+1$. Так как $a^n \equiv_m b^n$ (по индукционному предположению) и $a \equiv_m b$, по свойству 2 имеем $a^{n+1} = a^n \cdot a \equiv_m b^n \cdot b = b^{n+1}$.

### Свойство 4 сравнений

Если $(a, m) = 1$ и $ab \equiv_m ac$, то $b \equiv_m c$.

**Доказательство.**

$ab \equiv_m ac \Rightarrow a(b - c) \ \vdots \ m \Rightarrow b - c \ \vdots \  m \Rightarrow b \equiv_m c$ (по свойству 3 взаимно простых чисел можно сократить на $a$).

## Вычеты

**Определение**

$\equiv_m$ — отношение эквивалентности, так как это частный случай сравнения по модулю идеала (впрочем, можно несложно проверить напрямую).

- **Вычет** по модулю $m$ — это класс эквивалентности по $\equiv_m$.
- Перечислим тривиальные следствия Леммы 1.
- Каждый вычет по модулю $m$ имеет вид $a + m\mathbb{Z}$ для некоторого $a \in \mathbb{Z}$.
- В каждом вычете все числа имеют одинаковый остаток от деления на $m$, а числа из разных вычетов имеют разные остатки.
- Существует ровно $m$ вычетов по модулю $m$.


## Билет 15

## Полная система вычетов, свойства.

### Определение

Числа $a_1, \ldots, a_m \in \mathbb{Z}$ образуют полную систему вычетов по модулю $m$ (сокращенно: ПСВ (mod $m$)), если каждый вычет по модулю m содержит ровно одно из них.

### Лемма 2

$a_1, \ldots, a_m \in \mathbb{Z}$ — ПСВ (mod $m$), если и только если никакие два из них не сравнимы по модулю $m$.

**Доказательство.**

- $\Rightarrow$ очевидно следует из определения.
- $\Leftarrow$ Если есть $m$ чисел, и никакие два из них не сравнимы по модулю $m$, то в каждом вычете по модулю $m$ ровно одно из них.

### Теорема 13

Пусть $a_1, \ldots, a_m$ — ПСВ (mod $m$), $k, b \in \mathbb{Z}$, причем $(k, m) = 1$. Тогда $ka_1 + b, \ldots, ka_m + b$ — ПСВ (mod $m$).

**Доказательство.**

- Достаточно проверить критерий из [Леммы 2](#лемма-2).
- Пусть $ka_i + b \equiv_m ka_j + b \Leftrightarrow k(a_i - a_j) \ \vdots \ m$.
- Так как $(k, m) = 1$, это означает, что $a_i - a_j \ \vdots \ m \Leftrightarrow a_i \equiv_m a_j$, что не так.
- Если $a \equiv_m b$, то $a - b \ \vdots \ m$ и по [свойству 2](#свойство-2-НОД) НОД мы имеем $(a, m) = (b, m)$.
- Таким образом, для каждого вычета $\overline{a} = a + m\mathbb{Z}$ корректно определен НОД $(\overline{a}, m) := (a, m)$.


## Билет 16

## Приведенная система вычетов, свойства.

### Определение

1. Вычет $a$ по модулю $m$ называется взаимно простым с модулем $m$, если $(a,m) = 1$.
2. Для $m \in \mathbb{N}$ функция Эйлера $\varphi(m)$ — количество чисел от 1 до $m$, взаимно простых с $m$.
   - $\varphi(1) = 1$.
   - Существует ровно $\varphi(m)$ вычетов по модулю $m$, взаимно простых с $m$.

### Определение

Числа $a_1, \ldots, a_{\varphi(m)}$ образуют приведенную систему вычетов по модулю $m$ (сокращенно: ПрСВ (mod $m$)), если каждый вычет по модулю $m$, взаимно простой с $m$, содержит ровно одно из них.

пример: **{**1**,**3**,**7**,**9**}** для модуля 10.

### Лемма 3

$a_1, \ldots, a_{\varphi(m)} \in \mathbb{Z}$ — ПрСВ (mod $m$), если и только если все эти числа взаимно просты с $m$ и никакие два из них не сравнимы по модулю $m$.

**Доказательство.**

- $\Rightarrow$ очевидно следует из определения.
- $\Leftarrow$ Есть $\varphi(m)$ чисел, и никакие два из них не сравнимы по модулю $m$, а также есть ровно $\varphi(m)$ вычетов в ПрСВ (взаимно простых с $m$). Значит, в каждом вычете из ПрСВ ровно одно из этих чисел.

### Теорема 14

Пусть $a_1, \ldots, a_{\varphi(m)}$ — ПрСВ (mod $m$), $k \in \mathbb{Z}$, причем $(k, m) = 1$. Тогда $ka_1, \ldots, ka_{\varphi(m)}$ — ПрСВ (mod $m$).

**Доказательство.**

- Достаточно проверить критерий из [Леммы 3](#лемма-3).
- Так как $(k,m) = 1$ и $(a_i,m) = 1$, то $(ka_i,m) = 1$ (для всех $i \in \{1, \ldots, \varphi(m)\}$).
- Если $ka_i \equiv_m ka_j$, то $a_i \equiv_m a_j$ по [Свойству 4 сравнений](#свойство-4-сравнений), что не так.


## Билет 17

## Теорема Эйлера

### Теорема 15 теорема Эйлера

Пусть $m \in \mathbb{N}$, $a \in \mathbb{Z}$, $(a,m) = 1$. Тогда $a^{\varphi(m)} \equiv 1 \ (\text{mod} \ m)$.

**Доказательство.**

- Пусть $r_1, \ldots, r_{\varphi(m)}$ — ПрСВ (mod $m$).
- По [Теореме 14](#теорема-14) тогда и $ar_1, \ldots, ar_{\varphi(m)}$ — ПрСВ (mod $m$).
- Введем обозначения $i_1, \ldots, i_{\varphi(m)}$ так, что $r_1 \equiv_m ar_{i_1}$, $\ldots$, $r_{\varphi(m)} \equiv_m ar_{i_{\varphi(m)}}$ и $\{1, \ldots, \varphi(m)\} = \{i_1, \ldots, i_{\varphi(m)}\}$.
- Пусть $R = r_1 \cdot \ldots \cdot r_{\varphi(m)}$. Тогда $(R,m) = 1$.
- Перемножая записанные выше сравнения, получаем $R \equiv r_1 \cdot \ldots \cdot r_{\varphi(m)} \equiv ar_1 \cdot \ldots \cdot ar_{\varphi(m)} \equiv a^{\varphi(m)} \cdot R \ (\text{mod} \ m)$.
- Сокращая на $R$, получаем $1 \equiv a^{\varphi(m)} \ (\text{mod} \ m)$.

## Билет 18

## Функция Эйлера

### Лемма 4

Функция Эйлера мультипликативна, то есть, если $a, b \in \mathbb{N}$ взаимно просты, то $\varphi(ab) = \varphi(a)\varphi(b)$.

**Доказательство.**

- Запишем числа от 1 до $ab$ в таблицу $a \times b$ так, что в первой строке — числа от 1 до $a$, во второй — от $a + 1$ до $2a$, и т.д., в $b$ строке — числа от $(b-1)a + 1$ до $ba$.
- Все числа в $i$ столбце принадлежат одному вычету $i = i + a\mathbb{Z}$ по модулю $a$. Эти числа взаимно просты с $a$, если и только если $(i, a) = 1$.
- Вычеркнем все столбцы с номерами $i$, не взаимно простыми с $a$. Останутся ровно $\varphi(a)$ столбцов.
- Все числа, взаимно простые с $ab$, должны быть взаимно простыми и с $a$, они лежат в оставшихся $\varphi(a)$ столбцах.
- Рассмотрим любой оставшийся столбец, пусть числа в нем имеют вид $j, a + j, \ldots, (b - 1)a + j$. Эти числа образуют ПСВ (mod $b$) в силу [Теоремы 13](#теорема-13) (так как получены из ПСВ $0, 1, \ldots, b - 1$ умножением на $a$, взаимно простое с $b$ и прибавлением $j$: $0 \rightarrow j, 1 \rightarrow a + j, \ldots, b - 1 \rightarrow (b - 1)a + j$).
- Значит, среди чисел $j, a + j, \ldots, (b - 1)a + j$ ровно $\varphi(b)$ взаимно простых с $b$. Остальные числа точно не взаимно просты с $ab$, вычеркнем их.
- Оставшиеся $\varphi(a)\varphi(b)$ чисел взаимно просты и с $a$, и с $b$, а значит, взаимно просты с $ab$. Значит, осталось ровно $\varphi(ab)$ чисел (все числа от 1 до $ab$, взаимно простые с $ab$).

### Пример: \( a = 3, b = 4 \), значит \( ab = 12 \)

#### 1. Исходная таблица (числа от 1 до 12)

В таблице будет \( b = 4 \) строк и \( a = 3 \) столбца, числа от 1 до 12 распределены по таблице.


|   | 1  | 2  | 3  |
| - | -- | -- | -- |
| 1 | 1  | 2  | 3  |
| 2 | 4  | 5  | 6  |
| 3 | 7  | 8  | 9  |
| 4 | 10 | 11 | 12 |

---

#### 2. Вычёркиваем столбцы с номерами, не взаимно простыми с \( a = 3 \)

Числа в столбцах с номерами \( i \), не взаимно простыми с 3, вычёркиваем. Остаётся два столбца (1 и 2):


|   | **1** | **2** | ~~3~~  |
| - | ----- | ----- | ------ |
| 1 | 1     | 2     | ~~3~~  |
| 2 | 4     | 5     | ~~6~~  |
| 3 | 7     | 8     | ~~9~~  |
| 4 | 10    | 11    | ~~12~~ |

Мы оставили **$ \varphi(3) = 2 $ столбца**.

---

#### 3. В каждом оставшемся столбце числа образуют ПСВ по модулю \( b = 4 \)

Смотрим отдельно на числа в оставшихся столбцах:

- В столбце 1: \( 1, 4, 7, 10 \)
- В столбце 2: \( 2, 5, 8, 11 \)

Эти группы образуют полную систему вычетов по модулю \( 4 \).

Теперь вычёркиваем числа, не взаимно простые с \( b = 4 \) (то есть делящиеся на 2 или 4):


|   | **1**  | **2**  | ~~3~~  |
| - | ------ | ------ | ------ |
| 1 | **1**  | ~~2~~  | ~~3~~  |
| 2 | ~~4~~  | **5**  | ~~6~~  |
| 3 | **7**  | ~~8~~  | ~~9~~  |
| 4 | ~~10~~ | **11** | ~~12~~ |

Остались числа **$ \varphi(3) \cdot \varphi(4) = 2 \times 2 = 4 $ взаимно простых с \( 12 \)**:

\[
\{1, 5, 7, 11\}
\]

Это подтверждает, что $ \varphi(12) = 4 $ и теорема верна.


## Билет 19

### Функция Эйлера: значение на степени простого числа, явный вид

#### Лемма 5

Если $p \in \mathbb{P}$, $n \in \mathbb{N}$, то $\varphi(p^n) = p^n - p^{n-1}$.

**Доказательство.**

- Посчитаем количество чисел от 1 до $p^n$, не взаимно простых с $p^n$.
- Пусть $(a, p^n) = d > 1$. Так как $p^n \ \vdots \ d$, должно быть $d \ \vdots \ p$.
- Следовательно, числа от 1 до $p^n$, не взаимно простые с $p^n$ — это в точности числа от 1 до $p^n$, кратные $p$. Их количество равно $\frac{p^n}{p} = p^{n-1}$.

#### Теорема 16

Если $n \in \mathbb{N}$ имеет каноническое разложение $n = p_1^{k_1} \cdots p_m^{k_m}$, то $\varphi(n) = n \left(1 - \frac{1}{p_1}\right) \cdots \left(1 - \frac{1}{p_m}\right)$.

**Доказательство.**

- Докажем индукцией по количеству простых делителей $s$, что $\varphi(p_1^{k_1} \cdots p_s^{k_s}) = \prod_{i=1}^s \varphi(p_i^{k_i})$.
- База для $s = 1$ очевидна.
- Переход $s \rightarrow s+1$. Так как $(p_1^{k_1} \cdots p_s^{k_s}, p_{s+1}^{k_{s+1}}) = 1$, по [Лемме 4](#лемма-4) и индукционному предположению имеем
  $$
  \varphi(p_1^{k_1} \cdots p_s^{k_s} \cdot p_{s+1}^{k_{s+1}}) = \varphi(p_1^{k_1} \cdots p_s^{k_s}) \cdot \varphi(p_{s+1}^{k_{s+1}}) = \prod_{i=1}^s \varphi(p_i^{k_i}) \cdot \varphi(p_{s+1}^{k_{s+1}}) = \prod_{i=1}^{s+1} \varphi(p_i^{k_i}).
  $$
- Следовательно,
  $$
  \varphi(n) = \prod_{i=1}^m \varphi(p_i^{k_i}) = \prod_{i=1}^m (p_i^{k_i} - p_i^{k_i-1}) = \prod_{i=1}^m p_i^{k_i} \left(1 - \frac{1}{p_i}\right) = n \cdot \prod_{i=1}^m \left(1 - \frac{1}{p_i}\right).
  $$


## Билет 20

### Сумма функции Эйлера по делителям числа

#### Теорема 17

Для любого $n \in \mathbb{N}$
$$
\sum_{d \in \mathbb{N}, d \mid n} \varphi(d)=n
$$

**Доказательство.**

- Рассмотрим все $N$ числа от 1 до $n$ — их как раз $n$ штук. Каждое из них имеет НОД с $n$ — и этот НОД — делитель $n$.
- Для любого $d \mid n$ подсчитаем количество всех чисел из $\{1, \ldots, n\}$, чей НОД с $n$ равен $d$.
- Такие числа делятся на $d$, значит, их нужно искать среди $d, 2d, \ldots, n = \frac{n}{d}$.
- Так как $d = (kd, n) = (kd, \frac{n}{d}) = d \cdot (k, \frac{n}{d}) \Leftrightarrow (k, \frac{n}{d}) = 1$, количество чисел из $\{1, \ldots, n\}$, чей НОД с $n$ равен $d$ — это в точности количество таких $k \in \{1, \ldots, \frac{n}{d}\}$, что $(k, \frac{n}{d}) = 1$, а это количество равно $\varphi(\frac{n}{d})$.
- Если $d$ пробегает все натуральные делители $n$, то $d' = \frac{n}{d}$ также пробегает все натуральные делители $n$. Поэтому,
  $$
  n = \sum_{d \in \mathbb{N}, d \mid n} \varphi(\frac{n}{d}) = \sum_{d' \in \mathbb{N}, d' \mid n} \varphi(d').
  $$


## Билет 21

## Кольцо вычетов и его обратимые элементы. Поле вычетов по простому модулю

### Кольцо вычетов

- Вычеты по модулю $m \in \mathbb{Z}$ — они же вычеты по модулю идеала $m\mathbb{Z}$ — образуют кольцо вычетов $\mathbb{Z}_m := \mathbb{Z}/m\mathbb{Z}$.

### Лемма 6

Обратимые элементы $\mathbb{Z}_m$ — это в точности вычеты из ПрСВ (mod $m$).

**Доказательство.**

- Если $a \in \mathbb{Z}_m$ обратим, то существует такой $b \in \mathbb{Z}_m$, что $ab = 1 \Leftrightarrow ab \equiv_m 1$. Тогда $(ab, m) = 1$, а значит и $(a, m) = 1$.
- Наоборот, пусть $(a, m) = 1$. По [Теореме 13](#теорема-13) тогда $0, a, 2a, \ldots, (m - 1)a$ — ПСВ (mod $m$). Значит, $\exists b : ab \equiv_m 1 \Rightarrow ab = 1$.
- Если вычет $a$ обратим, то обратный вычет $a^{-1}$ единственен (это доказано в общем случае для кольца ранее, а в данном случае следует из доказательства Леммы 6).

### Теорема 18

Если $p \in \mathbb{P}$, то $\mathbb{Z}_p$ — поле.

**Доказательство.**

- Так как все некратные $p$ числа взаимно просты с $p$, ПрСВ (mod $p$) — это все ненулевые вычеты.
- Тогда по [Лемме 6](#лемма-6), все ненулевые элементы $\mathbb{Z}_p$ обратимы.


## Билет 22

### Алгоритм поиска обратного вычета. Решение сравнения с одним неизвестным.

#### Алгоритм поиска обратного вычета

- Пусть $a \in \mathbb{Z}$, $m \in \mathbb{N}$, причем $(a, m) = 1$. Как найти обратный вычет $a^{-1}$?
- Пусть $r$ — остаток от деления $a$ на $m$. Тогда $0 \le r < m$.
- Если $r = 0$, то $(a, m) > 1$ и обратного вычета не существует.
- Если $r > 0$, то с помощью алгоритма Евклида ищем $d = (r, m) = (a, m)$.
- Если $d > 1$, то обратного вычета не существует.
- Если $d = 1$, то при помощи (выполненного ранее) алгоритма Евклида ищем линейное представление НОД: $1 = ax + my$.
- Тогда $ax \equiv 1 \pmod{m}$, а значит, $a^{-1} = x$ в $\mathbb{Z}_m$.

#### Линейное сравнение с одним неизвестным

- Пусть $a, b \in \mathbb{Z}$, $m \in \mathbb{N}$. Нужно решить (относительно $x$) сравнение $ax \equiv b \pmod{m}$.
- Пусть $d = (a, m)$. Если $d\  \not\vdots \ \  b$, то очевидно, решений не имеет.
- Если $d \ \vdots \ b$, то пусть $a = a'd$, $b = b'd$, $m = m'd$. Тогда $ax \equiv b \pmod{m} \Leftrightarrow a'x \equiv b' \pmod{m'}$.
- Так как $(a', m') = 1$, существует обратный вычет $\overline{a'}^{-1}$ в $\mathbb{Z}_{m'}$.
- Пусть $s = \overline{a'}^{-1}$. Тогда $x \equiv b's \pmod{m'}$ — решение сравнения, а значит, и исходного сравнения.


## Билет 23

### Делимость на попарно взаимно простые числа

#### Лемма 7

Пусть $m_1, \ldots, m_k$ — попарно взаимно простые натуральные числа, $m = m_1 \cdots m_k$. Пусть $b \in \mathbb{Z}$ таково, что $b \ \vdots \ m_1, \ldots, b \ \vdots \ m_k$. Тогда $b \ \vdots \ m$.

**Доказательство.**

- Пусть $n_\ell = m_1 \cdots m_\ell$. Докажем индукцией по $\ell$, что $b \ \vdots \ n_\ell$.
  - База $\ell = 1$ очевидна.
  - Переход $\ell \rightarrow \ell+1$.
    - По индукционному предположению $b = cn_\ell$, где $c \in \mathbb{Z}$.
    - Так как $cn_\ell = b \ \vdots \ m_{\ell+1}$ и $(n_\ell, m_{\ell+1}) = 1$, по [Свойству 3](#свойство-3-взаимно-простых-чисел) взаимно простых чисел имеем $c  \ \vdots \ m_{\ell+1}$.
    - Тогда $c = dm_{\ell+1}$ и $b = dm_{\ell+1}n_\ell = dn_{\ell+1}$.


## Билет 24

### Китайская теорема об остатках

#### Теорема 19

Пусть $m_1, \ldots, m_k$ — попарно взаимно простые натуральные числа, $m = m_1 \cdots m_k$, $a_1, \ldots, a_k \in \mathbb{Z}$. Тогда существует единственное такое $a \in \{0, 1, \ldots, m - 1\}$, что $a \equiv_{m_1} a_1, \ldots, a \equiv_{m_k} a_k$.

**Доказательство.**

- Пусть $n_\ell = m_1 \cdots m_\ell$. Докажем индукцией по $\ell$ существование такого $b_\ell \in \mathbb{Z}$, что $b_\ell \equiv_{m_1} a_1, \ldots, b_\ell \equiv_{m_\ell} a_\ell$.
  - База $\ell = 1$ очевидна.
  - Переход $\ell \rightarrow \ell + 1$.
    - Так как $(m_{\ell+1}, n_\ell) = 1$ по [Теореме 13](#теорема-13), числа $b_\ell, b_\ell + n_\ell, b_\ell + 2n_\ell, \ldots, b_\ell + (m_{\ell+1} - 1)n_\ell$ — ПСВ (mod $m_{\ell+1}$) (они получены из ПСВ $0, 1, \ldots, m_{\ell+1} - 1$ умножением на $n_\ell$ и прибавлением $b_\ell$).
    - Значит, среди этих чисел есть число $kn_\ell + b_\ell \equiv_{m_{\ell+1}} a_{\ell+1}$.
    - Положим $b_{\ell+1} := kn_\ell + b_\ell$.
    - Тогда $b_{\ell+1} \equiv_{m_{\ell+1}} a_{\ell+1}$.
    - По построению $b_{\ell+1} \equiv_{n_\ell} b_\ell$. Так как по индукционному предположению $b_\ell \equiv_{m_i} a_i$ для всех $i \in \{1, \ldots, \ell\}$, мы имеем $b_{\ell+1} \equiv_{m_i} a_i$ для всех $i \in \{1, \ldots, \ell\}$.
- Итак, мы получили число $b_k$, удовлетворяющее всем требованиям теоремы, кроме одного: число должно быть от $0$ до $m - 1$.
  - Для получения такого числа $a$ поделим $b_k$ с остатком на $m$: пусть $b_k = mq + a$, $0 \le a \le m - 1$.
  - Так как $a \equiv_{m} b_k$ и $b_k \equiv_{m_i} a_i$, то и $a \equiv_{m_i} a_i$ для всех $i \in \{1, \ldots, k\}$.
- Предположим, что $a$ и $a'$ — два различных числа, удовлетворяющих условию. Тогда $a - a' \equiv_{m_i} 0$ для всех $i \in \{1, \ldots, k\}$.
  - Так как $m_1, \ldots, m_k$ попарно взаимно просты, по [Лемме 7](#лемма-7) $a - a' \equiv_{m} 0 = m_1 \cdots m_k$. Но $|a - a'| < m$, противоречие.

- Из доказательства единственности в [Теореме 19](#теорема-19) видно, что все целые числа $a$, для которых $a \equiv_{m_i} a_i$ при всех $i \in \{1, \ldots, k\}$ образуют в точности один вычет по модулю $m = m_1 \cdots m_k$.

## Билет 25

### Алгоритмы поиска решения для КТО

#### Алгоритмы поиска решения для КТО

- Пусть $m_1, \ldots, m_k$ — попарно взаимно простые натуральные числа, $m = m_1 \cdots m_k$, $a_1, \ldots, a_k \in \mathbb{Z}$.
- Мы ищем такое $a$, что $a \equiv_{m_1} a_1, \ldots, a \equiv_{m_k} a_k$.

Будет использоваться алгоритм поиска обратного вычета, описанный выше.

#### Алгоритм 1

- Пусть $m'_i = \frac{m}{m_i}$. Тогда $(m'_i, m_i) = 1$.
- $b_i \in \{0, 1, \ldots, m_i - 1\}$ — такое число, что $b_i \cdot m'_i \equiv 1 \pmod{m_i}$ (мы найдем $b_i$ с помощью алгоритма поиска обратного вычета) [Билет 22](#Билет-22).

**Утверждение**

$a = a_1 b_1 m'_1 + a_2 b_2 m'_2 + \cdots + a_k b_k m'_k$ — решение.

**Доказательство.**

- Так как $m'_j \ \vdots \ m_i$ при всех $j \neq i$, для любого $i \in \{1, \ldots, k\}$ $a \equiv a_i b_i m'_i \equiv a_i \pmod{m_i}$.
- Как сказано выше, все решения системы — это в точности числа, сравнимые с $a$ по модулю $m$.
- Поделив $a$ на $m$ с остатком, мы найдем решение системы среди чисел $0, 1, \ldots, m - 1$.

#### Алгоритм 2

- Индукцией по $s$ найдем $x_s$, удовлетворяющее первым $s$ сравнениям: $x_s \equiv_{m_1} a_1, \ldots, x_s \equiv_{m_s} a_s$.
- База $s = 1$ очевидна: подойдет $x_1 = a_1$.

**Переход $s \rightarrow s + 1$**

- Пусть $n_s = m_1 \cdots m_s$. Будем искать решение в виде $x_{s+1} = x_s + c_s n_s$.
- Тогда $x_{s+1} - x_s \vdots m_j$ для всех $j \in \{1, \ldots, s\}$, поэтому $x_{s+1}$ удовлетворяет первым $s$ сравнениям.
- Подберем $c_s$ так, чтобы $x_{s+1} \equiv a_{s+1} \pmod{m_{s+1}}$: $x_s + c_s n_s \equiv a_{s+1} \pmod{m_{s+1}} \Leftrightarrow c_s n_s \equiv a_{s+1} - x_s \pmod{m_{s+1}} \Leftrightarrow c_s \equiv (a_{s+1} - x_s) \cdot n_s^{-1} \pmod{m_{s+1}}$.
- Так как $(n_s, m_{s+1}) = 1$, обратный вычет $n_s^{-1}$ существует и может быть найден с помощью описанного выше алгоритма.
- Второй алгоритм решения КТО на первый взгляд сложнее, чем первый, но требует применения $k - 1$ алгоритмов поиска обратного вычета (а не $k$): мы не ищем обратный вычет по модулю $m_1$.
- Поэтому, целесообразно нумеровать модули так, чтобы $m_1$ оказался самым большим.


## Билет 26

### Функция Мёбиуса. Сумма функции Мёбиуса по промежуточным делителям.

#### Функция Мёбиуса

**Определение**

$$
\mu(n) :=
\begin{cases} 
1, & \text{если } n = 1, \\
(-1)^k, & \text{если } n = p_1 \cdots p_k \text{ — произведение различных простых чисел}, \\
0, & \text{если } n \text{ делится на квадрат простого числа}.
\end{cases}
$$

#### Лемма 8 Сумма функции Мёбиуса по промежуточным делителям.

Пусть $m, d \in \mathbb{N}$, $m \vdots d$. Тогда

$$
\sum_{d \mid n \mid m} \mu\left(\frac{m}{n}\right) = 
\begin{cases} 
1, & \text{если } m = d, \\
0, & \text{если } m > d.
\end{cases}
$$

(суммирование ведется по всем $n$, кратным $d$ и делящим $m$).

**Доказательство.**

- Пусть $k := \frac{m}{d} = p_1^{t_1} \cdots p_r^{t_r}$ — каноническое разложение. Тогда

$$
\sum_{d|n|m}\mu(\frac{m}{n}) = \sum_{s|\frac{m}{d}=p_1^{t_1}...p_r^{t_r}}\mu(s) =
$$

$$
= \sum_{s \mid p_1 \cdots p_r} \mu(s) = \sum_{\ell=0}^{r} C_r^{\ell} (-1)^\ell = (1 - 1)^r = 0
$$

(так как ненулевое значение $\mu$ достигается только на произведениях различных простых).

- Наша сумма равна 0 во всех случаях, кроме $r = 0$ (а это в точности $k = 1 \Leftrightarrow m = d$). В последнем случае сумма равна 1.


## Билет 27

### Формула обращения Мёбиуса. Аддитивный вариант

#### Теорема 20

Пусть $f, g : \mathbb{N} \to \mathbb{R}$, причем $\displaystyle f(m) = \sum_{d \mid m} g(d)$. Тогда $\displaystyle g(m)= \sum_{n|m}\mu(\frac{m}{n})f(n)$

**Доказательство.**

$$
\sum_{n \mid m} \mu\left(\frac{m}{n}\right) f(n) = \sum_{n \mid m} \mu\left(\frac{m}{n}\right) \times \sum_{d \mid n} g(d) = \sum_{d \mid m} \left( (g(d) \times \sum_{d \mid n \mid m} \mu\left(\frac{m}{n}\right)\right)
$$

по [Лемме 8](#Лемма-8).

$$
\sum_{d \mid n \mid m} \mu\left(\frac{m}{n}\right) = 
\begin{cases} 
1, & \text{если } m = d, \\
0, & \text{если } m > d.
\end{cases}
$$

Таким образом,

$$
\sum_{n \mid m} \mu\left(\frac{m}{n}\right) f(n) = g(m).
$$


## Билет 28

### Вывод формулы для функции Эйлера из формулы обращения Мёбиуса.

#### Функция Эйлера через формулу обращения Мёбиуса

**Теорема 21**

Пусть $n = p_1^{k_1} \cdots p_s^{k_s}$ — каноническое разложение числа $n$. Тогда

$$
\varphi(n) = n \left(1 - \frac{1}{p_1}\right) \cdots \left(1 - \frac{1}{p_s}\right).
$$

**Доказательство.**

- По [Теореме 17](#Теорема-17),
- По Формуле обращения Мёбиуса,

$$
\varphi(n) = \sum_{d \in \mathbb{N}, d \mid n} \mu(d) \cdot \frac{n}{d}.
$$

- Напомним, что при $d = p_{i_1} \cdots p_{i_t}$ мы имеем $\mu(d) = (-1)^t$ (здесь $i_1, \ldots, i_t$ — различные индексы), $\mu(1) = 1$, а в остальных случаях $\mu(d) = 0$. Поэтому,

$$
\varphi(n) = n - \sum_{1 \leq i \leq s} \frac{n}{p_i} + \sum_{1 \leq i_1 < i_2 \leq s} \frac{n}{p_{i_1} p_{i_2}} - \sum_{1 \leq i_1 < i_2 < i_3 \leq s} \frac{n}{p_{i_1} p_{i_2} p_{i_3}} + \cdots = n \left(1 - \frac{1}{p_1}\right) \left(1 - \frac{1}{p_2}\right) \cdots \left(1 - \frac{1}{p_s}\right).
$$

## Билет 29

### Формула обращения Мёбиуса. Мультипликативный вариант

#### Теорема 22

Пусть $K$ — поле, $f, g : \mathbb{N} \to K \setminus \{0\}$, причем $\displaystyle f(m) = \prod_{n \mid m} g(d)$. Тогда $\displaystyle g(m) = \prod_{n \mid m} f(n)^{\mu\left(\frac{m}{n}\right)}$.

#### Доказательство

$$
\prod_{n \mid m} f(n)^{ \mu\left(\frac{m}{n}\right)} = \prod_{n \mid m} \left( \prod_{d \mid n} g(d) \right)^{\mu\left(\frac{m}{n}\right)} =
$$

$$
= \prod_{d \mid m} g(d)^{ \displaystyle \sum_{d \mid n \mid m} \mu\left(\frac{m}{n}\right)}
$$

$$
= g(m)
$$

по [Лемме 8](#Лемма-8).


## Билет 30

### Сумма мультипликативной функции по делителям числа мультипликативна

#### Теорема 23

Пусть $f : \mathbb{N} \to \mathbb{R}$ — мультипликативная функция, $\displaystyle g(n) = \sum_{d \mid n} f(d)$. Тогда $g$ — мультипликативная функция.

#### Доказательство

- Пусть $a, b \in \mathbb{N}$, $(a, b) = 1$.
- $a = p_1^{k_1} \cdots p_s^{k_s}$ и $b = q_1^{\ell_1} \cdots q_t^{\ell_t}$ — канонические разложения.
- Так как $(a, b) = 1$, все эти простые различны и $ab = p_1^{k_1} \cdots p_s^{k_s} q_1^{\ell_1} \cdots q_t^{\ell_t}$ — каноническое разложение.
- По [Теореме 8](#Теорема-8), $d \mid ab \Leftrightarrow d = p_1^{k_1'} \cdots p_s^{k_s'} q_1^{\ell_1'} \cdots q_t^{\ell_t'}$, где $0 \leq k_i' \leq k_i$ для всех $i \in \{1, \ldots, s\}$ и $0 \leq \ell_j' \leq \ell_j$ для всех $j \in \{1, \ldots, t\}$.
- Следовательно, $d = d_a d_b$, где $d_a \mid a$ и $d_b \mid b$, причем $(d_a, d_b) = 1$ и такое представление единственно: $d_a = p_1^{k_1'} \cdots p_s^{k_s'}$ и $d_b = q_1^{\ell_1'} \cdots q_t^{\ell_t'}$.

$$
g(ab) = \sum_{d \mid ab} f(d) = \sum_{d_a \mid a} \sum_{d_b \mid b} f(d_a d_b) = \left( \sum_{d_a \mid a} f(d_a) \right) \left( \sum_{d_b \mid b} f(d_b) \right) = g(a) g(b).
$$

## Билет 31

### Сумма натуральных делителей числа

#### Определение

Для $n \in \mathbb{N}$, $\sigma(n)$ — сумма натуральных делителей $n$.

#### Теорема 24

Если $n = p_1^{k_1} \cdots p_s^{k_s}$, то $\sigma(n) = \frac{p_1^{k_1+1} - 1}{p_1 - 1} \cdots \frac{p_s^{k_s+1} - 1}{p_s - 1}$.

#### Доказательство

- Пусть $n_r = p_1^{k_1} \cdots p_r^{k_r}$.
- Докажем индукцией по $r$, что $\sigma(n_r) = \frac{p_1^{k_1+1} - 1}{p_1 - 1} \cdots \frac{p_r^{k_r+1} - 1}{p_r - 1}$.

**База для $r = 1$:**

Делители $p_1^{k_1}$ — это $1, p_1, \ldots, p_1^{k_1}$ и по формуле суммы геометрической прогрессии их сумма равна $\frac{p_1^{k_1+1} - 1}{p_1 - 1}$.

**Переход $r \to r+1$:**

Так как $(n_r, p_{r+1}^{k_{r+1}}) = 1$, а по [Теореме 23](#Теорема-23) функция $\displaystyle \sigma(n) = \sum_{d \mid n} d$ мультипликативна,

$$
\sigma(n_{r+1}) = \sigma(n_r p_{r+1}^{k_{r+1}}) = \sigma(n_r) \sigma(p_{r+1}^{k_{r+1}}) = \frac{p_1^{k_1+1} - 1}{p_1 - 1} \cdots \frac{p_r^{k_r+1} - 1}{p_r - 1} \cdot \frac{p_{r+1}^{k_{r+1}+1} - 1}{p_{r+1} - 1}.
$$


## Билет 32

### Первообразные корни из 1 в $\mathbb{C}$

#### Определение

Пусть $n \in \mathbb{N}$. Число $\varepsilon \in \mathbb{C}$ такое, что $\varepsilon^n = 1$, но $\varepsilon^k \neq 1$ при натуральных $k < n$ называется первообразным корнем из 1 степени $n$.

- Пусть $\varepsilon_0, \ldots, \varepsilon_{n-1}$ — все корни степени $n$ из 1, $\varepsilon_k = \left(\cos\left(\frac{2\pi k}{n}\right), \sin\left(\frac{2\pi k}{n}\right)\right)$.

#### Теорема 25

1. Существует в точности $\varphi(n)$ первообразных корней степени $n$ из 1, это в точности такие корни $\varepsilon_j$, что $(j, n) = 1$.
2. Если $\varepsilon_j$ — первообразный корень степени $n$ из 1, то $\varepsilon_j, \varepsilon_j^2, \ldots, \varepsilon_j^n$ — все корни степени $n$ из 1.

#### Доказательство

- По формуле Муавра, $\arg(\varepsilon_j^k) = \frac{2\pi kj}{n}$.

Разберем два случая.

**Случай 1: $(j, n) = d > 1$.**

- Тогда $m = \frac{n}{d} \in \mathbb{N}$, $m < n$ и $y = \frac{j}{d} \in \mathbb{Z}$.
- Следовательно, $\arg(\varepsilon_j^m) = \frac{2\pi mdy}{md} = 2\pi y$ и $\varepsilon_j^m = 1$. Это означает, что $\varepsilon_j$ не является первообразным корнем из 1 степени $n$.

**Случай 2: $(j, n) = 1$.**

- Тогда аргументы $\varepsilon_j, \varepsilon_j^2, \ldots, \varepsilon_j^{n-1}, \varepsilon_j^n$ — это $\frac{2\pi j}{n}, \ldots, \frac{2\pi nj}{n}$.
- По [Теореме 13](#Теорема-13), числа $j, 2j, \ldots, nj$ — ПСВ (mod $n$). Значит, среди их остатков от деления на $n$ каждый встречается ровно один раз.
- Тогда $\frac{2\pi j}{n}, \frac{2\pi 2j}{n}, \ldots, \frac{2\pi nj}{n}$ — это в точности такие аргументы, как $\frac{2\pi}{n}, \frac{4\pi}{n}, \ldots, \frac{2n\pi}{n}$ (напомним, что аргумент не меняется при прибавлении $2\pi$).
- Это означает, что $\varepsilon_j, \varepsilon_j^2, \ldots, \varepsilon_j^{n-1}, \varepsilon_j^n$ — это в точности $\varepsilon_0, \ldots, \varepsilon_{n-1}$ — все корни степени $n$ из 1.
- Понятно, что $\varepsilon_j^n = 1$, значит, в меньших степенях $\varepsilon_j$ не равен 1, то есть, это первообразный корень степени $n$ из 1.


