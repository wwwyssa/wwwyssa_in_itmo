# Компоненты сильной связности ориентированного графа, граф компонент сильной связности. Их свойства.

## Определение 
1) Мы будем называть рёбра орграфа **стрелками**, а множество всех стрелок ориентированного графа $D$ будем обозначать через $A(D)$. Будем использовать обозначение $a(D)$ = $|A(D)|$. 
2) Через $E(D)$ мы будем обозначать множество ребер орграфа $D$ без ориентации (каждую стрелку заменим обычным неориентированным ребром).
3) Для непересекающихся множеств $X,Y \subset V(D)$ через $A_D(X,Y)$ мы будем обозначать множества всех стрелок орграфа $D$ с началом в $X$ и концом в $Y$. Будем использовать обозначение $a_D(X,Y) = |A_D(X,Y)|$.
4) Запись $e = xy \in A(D)$ будет обозначать, что $e$ — стрелка с началом $x$ и концом $y$. В случае, когда допускаются кратные стрелки, эта запись не утверждает, что $e$— единственная стрелка с началом $x$ и концом $y$.
• Если не оговорено обратное, мы будем считать, что в орграфе нет петель и сонаправленных кратных стрелок (у которых совпадают и начала, и концы).
• Пары встречных стрелок (вида $uv$ и $vu$), как правило, допускаются.
• **Подграф** орграфа (в частности, **индуцированный подграф**) определяется так же, как для неориентированных графов. Индуцированный подграф орграфа $D$ на множестве вершин $X \subset V(D)$ будем обозначать через $D(X)$.
• Для любой вершины $v$ орграфа $D$ мы через $N^+_D(v)$ обозначим множество вершин орграфа $D$, в которые выходят стрелки из $v$, а через $N^-_ D(v)$обозначим множество вершин орграфа $D$, из которых выходят стрелки в $v$.
• $N_D(v) = N^+_D(v)\cup N^−_D(v)$ — окрестность вершины v.
• **Степень** вершины $x \in V(D)$ — это количество инцидентных ей рёбер из E(D).
• Для вершины $x \in V(D)$ через $d^+_D(x)$ мы будем обозначать исходящую степень вершины $v$, то есть, количество стрелок орграфа $D$, выходящих из вершины $x$, а через $d^−_D(x)$ мы будем обозначать входящую степень вершины $v$ — количество стрелок орграфа $D$, входящих в вершину $x$.
• $δ(D), δ^+(D) и δ^−(D)$ — **минимальные** степень, исходящую степень и входящую степень вершин D соответственно.
 Аналогично, $∆(D), ∆^+(D) и ∆^−(D)$ — это **максимальные** степень, исходящая степень и входящая степень орграфа $D$.
• Нетрудно понять, что для орграфа $D$ и вершины $v ∈V(D)$ выполнено $d_D(v) = d^+_D(v)+d^−_D(v)$
• Если в орграфе нет кратных стрелок, то $d^+_D(v) = |N^+_D(v)|, d^−_D(v) = |N^−_D(v)|,$ $d_D(v) = |N_D(v)|$.
• **Пути** и **циклы** в ориентированном графе отличаются от обычного графа тем, что каждая стрелка может быть пройдена только в соответствии с направлением от начала к концу. Таким образом, у каждого пути в орграфе есть **начало** и **конец**, а у каждого цикла — фиксированное направление обхода.
• **Расстояние** $dist_D(x,y)$ от вершины $x$ до вершины $y$ в орграфе $D$ есть длина кратчайшего $xy-пути$. В орграфе $D$ возможно, что $dist_D(x,y)\ne dist_D(y,x).$
• Удаление вершин и стрелок из орграфа мы определим и будем обозначать так же, как удаление вершин и рёбер из неориентированного графа
• Аналогично неориентированному графу определяется стягивание стрелки.
• Для неориентированного графа $H$ его ориентацией является любой орграф $\vec{H}$ с $V(\vec{H}) = V(H)$, стрелки которого — это ориентированные каким-либо способом рёбра из $E(H)$. Таким образом, у графа $H$ есть $2^{e(H)}$ ориентаций.
• Для орграфа $D$ определим неориентированный граф $\underline{D}$ с множеством вершин $V(D)$ и множеством рёбер $E(D)$.
• Иногда допускается **частичная ориентация** рёбер графа G, когда часть рёбер остается неориентированными, по ним разрешен проход в обе стороны.
### Сильная связность 
**Определение** 
Вершины $a$ и $b$ ориентированного графа $G$ назовем связанными, если в графе G существуют пути из $a$ в $b$ и из $b$ в $a$. 
Ориентированный граф $G$ называется **сильно связным**, если любые две его вершины связаны.
• Отношение связанности вершин ориентированного графа G является отношением эквивалентности (рефлексивно, симметрично, транзитивно).
• Множество вершин $V(G)$ разбивается на классы попарно связанных вершин, которые мы будем называть **компонентами сильной связности**.
• Для краткости, вместо “компонента сильной связности” будем писать КСС.
• Построим для орграфа $G$ **орграф компонент сильной связности** $C(G)$, вершины которого — КСС $G$. Проведем в орграфе $C(G)$ стрелку $V_i → V_j$ тогда и только тогда, когда в орграфе $G$ есть хотя бы одна стрелка, направленная от КСС $V_i \  к \ V_j$.\
### Определение 
Орграф называется **ациклическим**, если он не имеет ориентированных циклов.
## Лемма 1
 Для любого ориентированного графа G выполняются следующие утверждения. 
 1) C(G) — ациклический орграф. 
 2) Для любой компоненты сильной связности $V_i$ индуцированный подграф $G(V_i)$ сильно связен.
## Доказательство.
 1) Предположим противное, пусть в C(G) есть цикл $V_1V_2...V_k$. Тогда в орграфе $G$ все вершины из $\displaystyle\bigcup_{i=1}^k V_i$ попарно связаны и, следовательно, входят в одну КCC. Противоречие.
 2) • Пусть $w_1,w_2 \in V_i$. Тогда существует $w_1w_2$-путь $S$ и $w_2w_1$-путь $T$ в орграфе $G$. 
 • Понятно, что все вершины из $V(S)\cup V(T) \ni w_1,w_2$ связаны в орграфе $G$, следовательно, $V(S) \cup V(T) \subset V_i$, то есть, вершины $w_1$ и $w_2$ связаны в $G(V_i)$. Таким образом, орграф $G(V_i)$ сильно связен.

## Определение 
Пусть $V_i$ — компонента сильной связности ориентированного графа G. 
• Назовем эту компоненту **промежуточной**, если в графе $C(G)$ существует стрелка, входящая в $V_i$, и существует стрелка, выходящая из $V_i$ 
• В противном случае назовем компоненту $V_i$ **крайней**.
• Так как в $C(G)$ нет циклов, любой максимальный путь в этом графе начинается в вершине, из которой все ребра выходят, и заканчивается в вершине, в которую все ребра входят. Такие вершины соответствуют крайним компонентам сильной связности.
• Таким образом, любая промежуточная компонента сильной связности орграфа $G$ лежит в $C(G)$ на пути между какими-то двумя крайними компонентами.


# Критерии сильной связности и ацикличности орграфа.
## Лемма 2
 Орграф $D$ сильно связен, **если и только если** для любого множества $W ⊊ V(D)$ существует стрелка из $W в V(D)$\ $W$. 
## Доказательство.
 **⇒**. Если из некоторого множества $W ⊂V(D)$ нет стрелки в $V(D)$ \ $W$, то невозможно попасть из $W$ в $V(D)$ \ $W$, что противоречит сильной связности $D$.
 **⇐**. Если орграф не является сильно связным, то он имеет крайнюю компоненту сильной связности $W$, из которой не выходит ни одной стрелки в $V(D)$ \ $W$, что противоречит условию, что для любого множества $W ⊊ V(D)$ существует стрелка из $W в V(D)$\ $W$.

## Лемма 3
Орграф $D$ является **ациклическим**, если и только если его вершины можно занумеровать так, что любая стрелка ведет из вершины с меньшим номером к вершине с большим номером.
## Доказательство. 
**⇐.** Если такая нумерация существует, отсутствие циклов очевидно: ни из какой вершины нельзя попасть в вершину с меньшим номером. 
**⇒**. Существование нумерации для орграфа, не являющегося сильно связным, докажем по индукции.
• База для одновершинного орграфа очевидна.
• Понятно, что в ациклическом орграфе есть вершина a, из которой не выходит ни одной стрелки. По индукционному предположению построим нумерацию для (очевидно, ациклического) орграфа $D − a$, после чего присвоим вершине $a$ последний, самый большой номер.

# Входящее и исходящее дерево вершины.
## Определение 
Пусть $T$ — такой орграф, что неориентированный граф $T$ — дерево, $a ∈ V(T)$. 
1) Если из каждой вершины орграфа $T$, кроме $a$, выходит ровно одно ребро, то $T$ называется входящим деревом вершины a. 
2) Если в каждую вершину орграфа $T$, кроме $a$, входит ровно одно ребро, то T называется исходящим деревом вершины $a$.
## Лемма 4 
1) Если $D$ — входящее дерево вершины $a$, то из каждой вершины $D$ существует путь до $a$. 
2) Если $D$ — исходящее дерево вершины $a$, то из $a$ существует путь до каждой вершины $D$.
## Доказательство.
 1) Пусть $x ∈ V(D)$. Построим максимальный путь $P$ с началом в $x$. Так как $D$ — ациклический орграф, из конца пути $P$ не выходит ни одной стрелки, значит, этот конец — вершина $a$. 
 2) Аналогично.

## Теорема 1 
Пусть G — орграф, $a ∈ V(G)$, $V^−_a$ — множество всех вершин $G$, из которых можно дойти до $a$, а $V^+_a$ — множество всех вершин $G$, до которых можно дойти из $a$ (мы считаем, что $a ∈ V^−_a \ и \ a ∈ V^+_a$). Тогда существует входящее дерево вершины $a$ с множеством вершин $V^−_a$ и исходящее дерево вершины $a$ с множеством вершин $V^+_a$ .

## Доказательство. 
Построим входящее дерево, исходящее строится аналогично
• Положим $L_0 = \{a\}$, пусть $L_k = \{x : dist_G(x,a) = k\}$. Если $m$ — наибольшее расстояние от вершины множества $V^−_a$ до $a$, то $\displaystyle\bigcup_{k=0}^m L_k = V^−_a$ .
• Для всех $k > 0$ проведем от каждой вершины $x ∈ L_k$ ровно одну стрелку, выходящую из $x$ к вершине уровня $L_{k−1}$ — предку $x$ (такая стрелка, очевидно, есть). Обозначим через $D$ орграф с построенным множеством стрелок. В $D$ из каждой вершины, кроме $a$, выходит ровно одна стрелка.
• Предположим, что в $\underline{D}$ есть цикл $Z$. Пусть $v$ — вершина наибольшего уровня $L_m$ в $Z$.
• Тoгда оба соседа $v$ в $Z$ должны лежать в уровнях не более $m$. Но по построению $v$ смежна в $D$ только с одной вершиной уровня не более $m$ — со своим предком. Противоречие.
• Значит, $\underline{D}$ ацикличен, тогда $D$ — входящее дерево вершины a.

## Следствие 1 
В сильно связном орграфе G для любой вершины $a$ существует исходящее и входящее деревья вершины $a$ с множеством вершин $V(G)$.
## Доказательство. 
Так как орграф $G$ сильно связен, $V^−_a = V^+_a = V(G)$.

# Минимальные сильно связные графы. Оценки на число стрелок.

## Теорема 2
Для сильно связного орграфа $G$ на $n$ вершинах выполняются следующие утверждения.
1) Существует сильно связный остовный подграф орграфа $G$, в котором не более $2n −2$ стрелок.
2) Пусть $k$ — длина наибольшего простого цикла в орграфе $G$. Тогда существует сильно связный остовный подграф орграфа $G$, в котором не более $2n −k$ стрелок.
## Доказательство. 
1) Пусть $v ∈ V(G), а\ T^+_v \ и \ T^− _v$ — это исходящее и входящее деревья вершины $v$, соответственно (они сущестувуют по [Cледствию 1](#следствие-1) тк граф сильносвязный).
• Понятно, что остовный подграф орграфа $G$, полученный объединением этих двух деревьев, будет сильно связным и содержит не более $2n −2$ стрелок.
2) Пусть Z — простой цикл длины k в G.
• Построим новый орграф $G^′$, объединив все вершины цикла $Z$ в одну новую вершину $z$. (Все стрелки, соединяющие остальные вершины орграфа $G$ с вершинами цикла $Z$, в новом графе будут соединять эти же вершины с $z$. Возможно, в орграфе $G^′$ появятся кратные стрелки.)
• Орграф $G^′$ на $n−k +1$ вершинах также будет сильно связным.
• По **пункту 1** в нем можно оставить не более $2(n −k)$ стрелок, обеспечивающих его сильную связность. В орграфе $G$ к соответствующим стрелкам мы добавим $k$ стрелок цикла $Z$ и получим сильно связный остов, в котором не более $2(n −k)+k = 2n−k$ стрелок.
## Следствие 
Если в сильно связном орграфе $G$ между **любыми** двумя вершинами проведено **не более** одной стрелки, то существует сильно связный остовный подграф орграфа $G$, в котором не более $2n −3$ стрелок.
## Доказательство. 
• Очевидно, в сильно связном орграфе есть простой цикл. Пусть $k$ — длина наибольшего простого цикла в $G$. Из условия следует, что k ≥ 3.
• По пункту 2 [Теоремы 2](#теорема-2) у $G$ существует сильно связный остовный подграф, в котором не более чем $2(n −k)+k ≤2n−3$ стрелок

## Критерий существования гамильтонова цикла в орграфе.
• **Гамильтонов цикл в орграфе** — это простой ориентированный цикл, проходящий по всем вершинам. 
• Можно обобщить на орграфы и один из классических критериев гамильтоновости — критерий Дирака. С критерием Оре это сделать не получается.

## Лемма 5
Пусть орграф $G$ таков, что $max(δ^+(G),δ^−(G)) = k$. Тогда $G$ имеет простой путь длины хотя бы $k$ и простой цикл длины хотя бы $k +1$.

## Доказательство. 
• НУО $δ^+(G) ≥ k$.
• Рассмотрим путь максимальной длины $P = a_1a_2...a_n$ в орграфе $G$. Из его последней вершины $a_n$ выходит хотя бы $k$ стрелок. Так как путь $P$ нельзя продлить, все эти стрелки выходят в $a_1, ..., a_{n−1}$.
• Пусть $a_m$ — вершина наименьшего номера, для которой $a_na_m ∈ A(G)$ . Тогда в множестве {$a_m,...,a_{n−1}$} лежат не менее $k$ концов выходящих из $a_n$ стрелок, следовательно, в этом множестве хотя бы $k$ вершин. Значит, путь и цикл $a_m...a_{n−1}a_n$ нам подходят.

## Теорема 3
**(A.Ghouila-Houri, 1960.)** Пусть орграф G таков, что $min(δ^+(G),δ^−(G)) ≥ \frac{v(G)}{2}$ . Тогда G имеет гамильтонов цикл.
## Доказательство. 
• Рассмотрим максимальный цикл $C =v_1...v_m$. Тогда $m ≥ \frac{v(G)}{2} +1$ по [Лемме 5](#лемма-5). Нумерацию вершин считаем циклической по модулю m.
• Предположим, что цикл $C$ не является гамильтоновым и рассмотрим орграф $H = G −V(C)$. Пусть $P = u_1...u_k$ — максимальный путь в $H$.
• Тогда $m+k ≤v(G)$ и $k ≤ \frac{v(G)}{2} −1$.
• Положим $S =\{i : v_iu_1 ∈ A(G)\}$ и $T =\{i : u_kv_{i+1} ∈ A(G)\}$.
• Если $S ∩T ∋i$, то мы увеличим цикл $C$, заменив стрелку $v_iv_{i+1}$ на путь $v_iu_1Pu_nv_{i+1}$ (см. рис.a), что противоречит максимальности цикла C. Следовательно, S ∩ T = ∅.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/digraph/1.png?raw=true)
• В силу максимальности пути $P$ мы имеем $N^+_G(u_k) ⊂ V(C)∪V(P)$ и $N^−_ G(u_1) ⊂ V(C)∪V(P)$.
• Cледовательно, $\frac{v(G)}{2} ≤d^+_G(u_k) ≤ k −1+|T|$ и $\frac{v(G)}{2} ≤d^−_G(u_1) ≤ k −1+|S|.$
• Так как $S ∩T =∅$ и $k ≤ \frac{v(G)}{2} −1$, получим $|S| ≥ 1$, $|T| ≥1$ и $|S ∪T| =|S|+|T| ≥ v(G)−2k +2 ≥m−k +2.$
• Существуют такие индексы $i$ и $j$, что $i ∈ S$, $i +1,...,i +j −1 \not\in S ∪T$ и $i +j ∈ T$. По доказанному выше $j −1 ≤k −2$.
• Тогда $v_iu_1,u_kv_{i+j+1} ∈ A(G)$ и мы получаем цикл $v_{i+j+1}Cv_iu_1Pu_k$ (см. рис.b), в котором хотя бы на одну вершину больше чем в C. Противоречие.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/digraph/2.png?raw=true)

# Существование гамильтонова пути в турнире.
## Турниры 
Турниром, называется орграф, в котором любые две вершины соединены ровно одной стрелкой. 
• Такие орграфы называют турнирами, так как с их помощью удобно изображать однокруговые турниры без ничьих.
## Лемма 6 
В турнире существует **гамильтонов** путь.
## Доказательство. 
• Рассмотрим самый длинный простой путь $P =a_1...a_k$ в турнире $T$.
• Предположим, что он не гамильтонов и рассмотрим не вошедшую в $P$ вершину $b ∈ V(T)$.
• Если $ba_1 ∈ A(T)$, то добавим $b$ в начало пути. Если $a_nb ∈ A(T)$, то добавим $b$ в конец пути. Так как это противоречит максимальности $P$, $a_1b ∈ A(T)$ и $ba_n ∈ A(T)$
• Тогда существует такое $i ≤ k −1$, что $a_ib ∈ A(T)$ и $ba_{i+1} ∈ A(T)$. В этом случае можно вставить $b$ между $a_i$ и $a_{i+1}$ и увеличить путь. Противоречие с максимальностью P. 
• Значит, наше предположение неверно и P — гамильтонов путь.

## Следствие 2 
Cтруктура компонент сильной связности турнирного графа представляет собой простой путь $V_1V_2...V_m$, в котором для любых двух различных компонент $V_i$ и $V_j$, где i < j, все ребра графа ориентированы от $V_i$ к $V_j$. 
## Доказательство.
 • Между любыми двумя компонентами турнира $T$ есть стрелка. Следовательно, орграф КСС $C(T)$ — турнир. 
 • Пусть $V_1,...,V_m$ — все КСС турнира $T$. По [Лемме 6](#лемма-6) в $C(T)$ есть гамильтонов путь $V_1V_2...V_m$. 
 • Так как турнир $C(T)$ ацикличен, $V_iV_j ∈ A(C(T))$ при $i < j$.
# Существование гамильтонова цикла в сильно связном турнирном графе.
## Теорема 4 
**(P. Camion, 1959.)** В сильно связном турнире существует гамильтонов цикл.
## Доказательство. 
• В сильно связном турнире $T$ есть циклы. Рассмотрим максимальный простой цикл $C = a_1a_2...a_k$. Предположим, что он не гамильтонов, пусть вершина $b$ не вошла в этот цикл.
• Пусть не все стрелки между $b$ и циклом $C$ ориентированы одинаково. Тогда существуют последовательные вершины цикла $a_i$ и $a_{i+1}$ такие, что $a_ib,b_a{i+1}$ ∈ A(T) (см. рис.a). В этом случае можно удлинить максимальный цикл $C$, вставив вершину $b$ между $a_i$ и $a_{i+1}$, противоречие.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/digraph/3.png?raw=true)
• Пусть из всех вершин цикла $C$ стрелки входят в $b$ (если стрелки выходят из $b$ к $C$ — аналогично). Ввиду сильной связности турнира $T$ существует путь $S$ от $b$ до цикла $C$.
• Пусть $S$ впервые пересекает цикл $C$ в вершине $a_{i+1} (см. рис.b). Тогда можно удлинить $C$, заменив стрелку $a_ia_{i+1}$ на путь $a_ibSa_{i+1}.$ Противоречие.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/digraph/4.png?raw=true)
# Удаление вершин из сильно связного турнирного графа с сохранением сильной связности
## Теорема 5 
В сильно связном турнире $G$ с четырьмя и более вершинами существуют две такие вершины $a,b ∈ V(G)$, что турниры $G −a$ и $G −b$ сильно связны.
## Доказательство. 
• По [Теореме 4](#теорема-4) в турнире $G$ есть ГЦ $a_1a_2 ...a_k$ (нумерация вершин — циклическая).
• Если $a_ia_{i+2} ∈ A(G)$, то турнир $G −a_{i+1}$ сильно связен. Если таких $i$ хотя бы два, то теорема доказана.
• Пусть в $A(G)$ существует не более чем одна стрелка вида $a_ia_{i+2}$. Тогда можно предположить, что $a_{i+2}a_i ∈ A(G)$ при $i= k$, а ориентация ребра $a_ka_{k+2} = a_ka_2$ может быть произвольной.
• Докажем, что в таком случае орграф $G −a_k$ сильно связен. Для этого достаточно показать, что существует путь из $a_{k−1}$ в $a_1$. Это несложно: по стрелкам-диагоналям ГЦ существует путь $a_{k−1}a_{k−3}..$., приходящий, в зависимости от четности $k −1$, в $a_1$ (рис.a) или в $a_2$ (рис.b). Во втором случае дополним этот путь участком $a_2a_3a_1$.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/digraph/5.png?raw=true) ![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/digraph/6.png?raw=true)
• Таким образом, турнир $G −a_k$ сильно связен. Отметим, что мы не пользовались при этом рёбрами $a_ka_2$ и $a_ka_{k−2}$, их ориентация не имеет для нас значения. Поэтому аналогично доказывается, что турнир $G − a_2$ сильно связен
# Циклы в сильно связных турнирах. Теорема Муна.
**(J. W.Moon, 1966.)** Пусть $G$ — сильно связный турнир, а $k ∈N, 3≤k ≤v(G)$. Тогда выполнены следующие утверждения. 
1) Для любой вершины $v ∈ V(G)$ существует простой цикл длины $k$, проходящий через $v$. 
2) В турнире $G$ существует хотя бы $v(G)+1−k$ простых циклов длины $k$.

## Доказательство. 
• Зафиксируем $k$ и будем доказывать оба утверждения индукцией по количеству вершин турнира $G$. При $v(G) = k$ оба утверждения следуют из [Теоремы 4](#теорема-4): в сильно связном турнире G есть гамильтонов цикл.
1) • Пусть $v(G) > k$. Тогда по [Теореме 5](#теорема-5) существует такая вершина $w\ne v$, что турнир $G −w$ сильно связен. 
• Так как $3 ≤ k ≤v(G)−1=v(G −w)$, по индукционному предположению в турнире $G −w$ есть простой цикл длины $k$, проходящий через $v$. Этот же цикл есть и в турнире $G$.
2) • Пусть $v(G) > k$. Тогда по  [Теореме 5](#теорема-5) существует такая вершина $w$, что турнир $G −w$ сильно связен. 
• В турнире $G −w$ существует не менее $v(G −w)+1−k =v(G)−k$ простых циклов длины k. 
• По пункту 1 в турнире $G$ существует простой цикл длины $k$, проходящий через вершину $w$, следовательно, в турнире $G$ не менее чем $v(G)−k +1$ простых циклов длины $k$.

# Теорема Хватала-Ловаса о независимом множестве в ориентированном графе
• Пусть $G$ — орграф. Как и в неориентированном случае, $α(G)$ — количество вершин в максимальном независимом множестве вершин орграфа G (то есть, максимальном множестве вершин, никакие две из которых не соединены стрелкой).
# Теорема 7 
**(V.Chvatal; L.Lovasz, 1974.)** В любом орграфе $G$ существует такое независимое множество $S ⊂ V(G)$, что для любой вершины $v ∈ V(G)$\ $S$ существует путь длины не более $2$ с началом в $S$ и концом $v$.

## Доказательство. 
Доказательство будет индукцией по количеству вершин в орграфе. 
**База** при $v(G) = 1$ очевидна.
• **Индукционный переход**. Пусть для меньших орграфов утверждение доказано. Рассмотрим любую вершину $v ∈V(G)$. Если $V(G) = \{v\}∪N^+_G(v)$, то утверждение теоремы очевидно, нам подходит $S = \{v\}$.
• Пусть $V(G) \ne \{v\}∪N^+_G(v)$. Для орграфа $G^′ =G −({v}∪N^+_G(v))$ утверждение доказано, возьмем соответствующее этому графу независимое множество $S^′$.
• Если существует такая вершина $w ∈ S^′$, что $v ∈ N^+_G(w)$, то множество $S^′$ подходит и для графа $G$ (см. рис.a).
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/digraph/7.png?raw=true)
• Если такой вершины $w$ нет, положим $S = S^′ ∪\{v\}$. Так как $S^′ ∩N^+_G(v) = ∅$, в этом случае множество $S$ независимо, и любая вершина $x ∈ V(G)$\ $S$ достижима из $S$ по пути длины не более $2$ (см. рис.b).
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/digraph/8.png?raw=true)
## Следствие 3 
В любом турнире $G$ существует такая вершина $v$, что для любой вершины $w ∈ V(G)$ существует $vw$-путь длины не более $2$.

# Теорема Роя-Галлаи о раскрасках и ориентациях.
## Теорема 8
**(B.Roy, 1967; T.Gallai, 1968)** Пусть $G$ — неориентированный граф, $\vec{G}$ — его ориентация. Тогда орграф $\vec{G}$ содержит путь длины не менее $χ(G)−1$.
## Доказательство. 
• Пусть $A ⊂ A(\vec{G})$ — минимальное по включению такое множество стрелок, что орграф $G^′ = \vec{G} −A$ — ациклический.
• Для любой вершины $v ∈ V(G)$ положим $ρ(v)$ равным длине наибольшего простого пути в орграфе $G^′$ с началом в $v$. Покажем, что $ρ$ — правильная раскраска вершин графа $G$.
### Утверждение 
Пусть вершины $a,b ∈ V(G)$ соединены простым путём $P$ в орграфе $G′$. Тогда $ρ(a) > ρ(b)$.
### Доказательство. 
Рассмотрим путь $P_b$ длины $ρ(b)$ в орграфе $G^′$. Так как $G^′$ — ациклический, то любой путь в орграфе $G^′$ — простой. В частности, равный объединению $P$ и $P_b$ путь $P_a$ с началом в $a$ — простой. Так как $|P_a| > |P_b|$, то $ρ(a) > ρ(b)$
• **Вернемся к доказательству теоремы 8**.
 • Пусть $x,y ∈ V(G)$ и $xy ∈ E(G)$. HУО $xy ∈ A(\vec{G})$. Если $xy ∈ A(G′)$, то, как доказано выше, $ρ(x) \ne ρ(y)$.
• Если $xy \not\in  A(G^′)$, то $xy ∈ A$. Из минимальности $A$ следует, что в орграфе $G^′ +xy$ есть цикл, но тогда в орграфе $G^′$ есть $yx$-путь, а следовательно, $ρ(x) \ne ρ(y).$
• Мы доказали правильность раскраски $ρ$. Пусть $k$ — номер наибольшего цвета в $ρ$. Тогда в орграфе $G^′$ (а значит, и в $\vec{G}$) есть простой путь длины $k$. Поскольку раскраска $ρ$ красит вершины в цвета $0,1,...,k$, то $χ(G) ≤ k +1$.

# Ядро орграфа. Критерий раскрашиваемости графа в терминах ядер ориентаций.
## Ядро орграфа и списочные раскраски рёбер. 
## Определение 
Пусть $H$ — орграф. Независимое множество вершин $U ⊂V(H)$ называется **ядром**, если для любой вершины $v ∈V(H)$\  $U$ существует хотя бы одна стрелка $v u ∈ A(H)$, где $u ∈ U$.
## Лемма 7 
Пусть $H$ — орграф, каждой вершине $v ∈ V(H)$ соответствует список цветов $L(v)$, причём $d^+_H(v) < ℓ(v)$. Предположим, что каждый индуцированный подграф орграфа $H$ имеет ядро. Тогда существует правильная раскраска вершин $H$ в соответствии с данными списками.
## Доказательство. 
• Индукция по $v(H)$, база для пустого орграфа очевидна.
• Предположим, что для меньших орграфов лемма доказана. Пусть $i$ — цвет, присутствующий в списках, $V_i ⊂ V(H)$ — множество из всех вершин, чьи списки содержат цвет $i$, $H_i = H(V_i)$.
• По условию, орграф $H_i$ имеет ядро $U_i$. Покрасим все вершины из $U_i$ в цвет $i$ (это не нарушит правильности раскраски, так как ядро является независимым множеством), после чего исключим цвет $i$ из списков всех вершин $v ∈ V_i$\ $U_i$ и получим новые списки $L^′(v)$.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/digraph/9.png?raw=true)
• Пусть $H^′$ = $H −U_i$. Поскольку $U_i$ — ядро орграфа $H_i$ = $H(V_i)$, то для любой вершины $v ∈ V_i$\ $U_i$ выполняется $d^+_{H^′}(v) ≤ d^+_{H}(v) − 1 < ℓ(v) − 1 = ℓ^′(v).$
• По индукционному предположению, вершины орграфа $H^′$ можно покрасить правильным образом по новым спискам, в которых нет цвета $i$. В результате получится правильная раскраска всех вершин орграфа $H$ по спискам.

# Теорема Гэльвина о списочных рёберных раскрасках двудольного графа.
**(F. Galvin, 1995.)** Для любого двудольного графа $G$ выполняется $ch^′(G) = χ^′(G) = ∆(G)$.
## Доказательство. 
• Пусть $G = (V_1,V_2,E)$, $k = ∆(G)$. По теореме 4.9 (теорема Кёнинга) мы имеем χ′(G) = k, то есть, существует правильная раскраска $ρ$ рёбер графа $G$ в $k$ цветов (пусть это цвета $1, ..., k$).
• Обозначим через $G^′$ рёберный граф двудольного графа $G$. (Вершины $G^′$ соответствуют рёбрам $G$. Две вершины $G^′$ смежны, если и только если смежны соответствующие рёбра.)
• Пусть каждому ребру $e$ графа $G$ (а значит, и каждой вершине графа $G^′$) соответствует список $L(e)$ из $k$ цветов. Наша цель — построить правильную раскраску вершин графа $G^′$ по данным спискам. Для этого мы хотим применить к рёберному графу $G^′$ [Лемму 7](#лемма-7).
• Введём множество предпочтений для вершин исходного графа $G$. Для вершины $a ∈ V_1$ предпочтение $<_a$ строго упорядочивает инцидентные $a$ рёбра по возрастанию их цветов в раскраске $ρ$, а для вершины $b ∈ V2$, предпочтение $<_b$ строго упорядочивает инцидентные $b$ рёбра по убыванию их цветов в раскраске $ρ$
• Мы ориентируем каждое ребро $ef$ рёберного графа $G^′$ от $e$ к $f$, если для их общей вершины $v$ рёбер $e$ и $f$ имеет место $e$ $<_v$ $f$. Тем самым, мы получим ориентацию $\vec{G^′}$ графа $G^′$.
• По построению множества предпочтений мы имеем $d^+_{\vec{G^′}} (e) ≤ k −1 < ℓ(e)$. (Если e = ab, $a ∈ V_1$, $b ∈ V_2$ и $ρ(e) = i$, то из $e$ могут выходить стрелки к инцидентным $a$ рёбрам цветов $i +1,...,k$ и к инцидентным $b$ рёбрам цветов $1,...,i −1$, всего не более $k −1$ стрелки, см. рис.)
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/digraph/10.png?raw=true)
• Остаётся доказать, что у любого индуцированного подграфа $\vec{H^′}$ орграфа $\vec{G^′}$ есть ядро. Для этого мы воспользуемся теоремой Гэйла-Шепли (Stable Marriage Theorem).
• Пусть $F$ — множество всех рёбер графа G, соответствующих вершинам из $\vec{H^′}$, а $H = G(F)$. Для введённого выше множества предпочтений существует стабильное паросочетание $M$ графа $H$. Рёбра из $M$ образуют независимое множество вершин орграфа $\vec{H^′}$.
• По определению стабильного паросочетания и по построению ориентации  $\vec{H^′}$, для любого ребра $f ∈ F$\ $M$ существует такое ребро $e ∈ M$ и общая вершина $v$ рёбер $e$ и $f$, что $f$ $<_v$ $e$, то есть, $fe ∈ A(\vec{H^′})$. Таким образом, M — ядро  $\vec{H^′}$.
• Теперь воспользуемся [Леммой 7](#лемма-7) и получим, что существует правильная раскраска вершин графа $G^′$ (и, соответственно, рёбер графа $G$) по заданным спискам. Таким образом, $ch^′(G) = k$.

# Теорема Галлаи-Мильграма о покрытии орграфа путями.
## Теорема 10 
**(T.Gallai; A.Milgram, 1960.)** Вершины орграфа G можно покрыть не более, чем $α(G)$ попарно непересекающимися простыми путями.
## Доказательство. 
• Для каждого простого пути $P$ обозначим его конец через $t(P)$.
• Будем называть **покрытием** орграфа $G$ множество из нескольких попарно непересекающихся простых путей в $G$, покрывающих все его вершины. Для каждого покрытия $\mathcal{P}$ обозначим через $T(\mathcal{P})$ множество концов всех путей из $\mathcal{P}$.
• На множестве покрытий орграфа $G$ мы введём отношение порядка: будем считать, что $\mathcal{P}_1$ < $\mathcal{P}_2$, если $|\mathcal{P}_1| < |\mathcal{P}_2|$ и $T(\mathcal{P}_1) ⊂ T(\mathcal{P}_2).$

### Утверждение 
Пусть $\mathcal{P}$ — минимальное по введённому отношению порядка покрытие орграфа $G$. Тогда на каждом пути из $\mathcal{P}$ можно выбрать по вершине так, чтобы множество выбранных вершин было независимым.
### Доказательство. 
• Будем считать, что для меньших орграфов утверждение доказано.
• Пусть $\mathcal{P}$ = {$P_1,...,P_n$}, $u_i = t(P_i)$. Если множество {$u_1,...,u_n$} — независимое, то утверждение доказано. 
• Предположим, что $u_iu_j ∈ A(G)$. Пусть путь $Q_i$ получен из $P_i$ добавлением стрелки $u_iu_j$. 
  • Если $V(P_j) = \{u_j\}$, то заменой $P_i$ и $P_j$ на $Q_i$ получаем строго меньшее в нашем порядке чем $\mathcal{P}$, покрытие, что невозможно.
  • Значит, $V(P_j) \ne \{u_j\}$. Тогда рассмотрим орграф $G^′ =G −u_j$ и его покрытие $\mathcal{P}^′$, полученное заменой пути $P_j$ на $P^′_j = P_j −u_j$.
  • Докажем, что $\mathcal{P}^′$ — минимальное покрытие орграфа $G^′$.
  • Если это не так, рассмотрим строго меньшее в нашем порядке покрытие $\mathcal{Q}^′$ орграфа $G^′$.
  • Пусть $u^′_j = t(P^′_j)$, ясно, что $u^′_ju_j ∈ A(G)$. Отметим, что единственная вершина, которая может входить в $T(\mathcal{Q}^′)$ и не входит в $T(\mathcal{P})$ — это $u^′_j$ . Рассмотрим три случая.
 
 #### Случай 1: Существует путь $Q^′ ∈ \mathcal{Q}^′$ с $t(Q^′) = u^′_j$.
 • Пусть $Q = Q^′u^′_ju_j$, тогда $t(Q) = u_j$.
 • Рассмотрим покрытие $\mathcal{Q}$ орграфа G, полученное из $\mathcal{Q}^′$ заменой пути $Q^′$ на $Q$. Очевидно $\mathcal{Q}$ < $\mathcal{P}$: мы имеем $T(\mathcal{Q}) ⊂ T(\mathcal{P})$ и $|Q| = |Q^′| < |P^′| = |P|$. Противоречие с выбором $\mathcal{P}$.
 #### Случай 2: В $\mathcal{Q}^′$ нет пути с концом в $u^′_j$, но существует путь $Q^′ ∈ \mathcal{Q}′$ с $t(Q^′) = u_i$.
 • Пусть путь $Q$ получен из $Q^′$ добавлением ребра $u_iu_j$, тогда $t(Q) = u_j$. 
 • Рассмотрим покрытие $\mathcal{Q}$ орграфа $G$, полученное из $\mathcal{Q}^′$ заменой пути $Q^′$ на $Q$. Очевидно $\mathcal{Q}$ < $\mathcal{P}$: мы имеем $T(\mathcal{Q}) ⊂ T(\mathcal{P})$ и $|\mathcal{Q}| = |\mathcal{Q}^′| < |\mathcal{P}^′| = |\mathcal{P}|$. Противоречие с выбором $\mathcal{P}$.

#### Случай 3: В покрытии $\mathcal{Q}^′$ нет ни пути с концом в $u^′_j$, ни пути с концом в $u_i$. 
• Тогда $|T(\mathcal{Q}^′)| ≤ |T(\mathcal{P}^′)|−2$, следовательно, $|\mathcal{Q}^′| ≤ |\mathcal{P}^′| − 2$. 
• Дополним $\mathcal{Q}^′$ до покрытия $\mathcal{Q}$ орграфа $G$, добавив путь {$u_j$}. И на этот раз оказывается, что $\mathcal{Q}$ < $\mathcal{P}$, противоречие


• Таким образом, $\mathcal{P}^′$ — минимальное покрытие орграфа $G^′$.
• Так как $v(G^′) < v(G)$, по индукционному предположению на путях покрытия $\mathcal{P}^′$ можно выбрать по вершине так, чтобы множество выбранных вершин было независимым. По построению покрытия $\mathcal{P}^′$, выбранные вершины подходят и для покрытия $\mathcal{P}$ орграфа G.

• Теперь легко доказать теорему. Рассмотрим любое минимальное покрытие $\mathcal{P}$ орграфа $G$. На путях покрытия $\mathcal{P}$ можно выбрать по вершине так, чтобы эти вершины образовывали независимое множество, следовательно, $|\mathcal{P}| ≤ α(G)$.

# Теорема Дилворса
## Определение 
Пусть $V$— частично упорядоченное множество с порядком $<$. Подмножество $U ⊂ V$ — **цепь**, если любые два его элемента сравнимы и **антицепь**, если никакие два его элемента несравнимы.

**(R.P.Dilworth, 1950.)** Пусть $V$ — конечное частично упорядоченное множество. Тогда минимальное количество цепей, покрывающих $V$, равно количеству вершин в максимальной антицепи множества $V$.

## Доказательство. 
• Построим орграф $G$ на элементах множества $V$, как на вершинах: для любых $x,y ∈ V$ мы положим $xy ∈ A(G)$, если и только если $x < y$. \
• Очевидно, $α(G)$ равно количеству вершин в максимальной антицепи множества $V$, а путь в орграфе $G$ проходит по вершинам цепи множества V. 
• По [Теореме 10](#теорема-10) вершины орграфа $G$ можно покрыть не более, чем $α(G)$ путями, то есть, множество $V$ можно покрыть не более, чем $α(G)$ цепями. 
• Остаётся лишь добавить, что две вершины антицепи не могут оказаться в одной цепи, поэтому покрывающих множество $V$ цепей будет ровно $α(G)$.
