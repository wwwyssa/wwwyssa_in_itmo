# Теория Рамсея
В графе на достаточно большом количестве вершин без больших клик обязательно есть большое независимое множество вершин.
# Числа Рамсея
- Основным объектом изучения в этом разделе будут полные графы, рёбра которых покрашены в несколько цветов. Напомним, что множество вершин, образующих полный подграф, а также сам этот подграф мы называем кликой.

# Определение числа Рамсея
- Пусть $m,n ∈ \N$. **Число Рамсея $r(m,n)$** — это наименьшее из всех таких чисел $x ∈ N$, что при любой раскраске рёбер полного графа на $x$ вершинах в два цвета обязательно найдётся клика на n вершинах с рёбрами цвета 1 или клика на m вершинах с рёбрами цвета 2.
- Рамсей доказал, что число r(m,n) существует (то есть, конечно).
-  Очевидно, 
- - $r(n,1) = r(1, n) = 1,$ 
- - $r(n,2) = r(2,n) = n$,
- -  $r(m,n) = r(n,m).$

# Двумерные числа Рамсея: оценки сверху для случая двух цветов.
## Теорема 1
**(P. Erdos, G.Szekeres, 1935.)* Пусть $n,m ≥ 2$ — натуральные числа. Тогда выполнены следующие утверждения.
1) $r(n,m) ≤r(n,m−1)+r(n−1,m).$
2) Если оба числа $r(n,m−1)$ и $r(n−1,m)$ — чётные, то
 $r(n,m) ≤ r(n,m −1)+r(n−1,m)−1$.
 
## Доказательство. 
1) • Рассмотрим клику на $r(n, m −1)+r(n−1,m)$ вершинах с рёбрами цветов $1$ и $2$ и ее произвольную вершину $a$. От вершины a отходит $r(n, m −1)+r(n−1,m)−1$ рёбер цветов $1$ и $2$.
• Предположим, что от вершины $a$ отходит хотя бы $r(n, m −1)$ рёбер цвета $2$. Рассмотрим концы этих ребер. Среди них есть либо клика на $n$ вершинах с рёбрами цвета $1$, либо клика на $m −1$ вершинах с рёбрами цвета $2$. В первом случае теорема доказана, а во втором случае случае добавим вершину $a$ и получим клику на $m$ вершинах с рёбрами цвета $2$.
• Предположим, что от вершины $a$ отходит не более $r(n, m−1)−1$ рёбер цвета $2$. Тогда $a$ инцидентна хотя бы $r(n −1,m)$ рёбрам цвета $1$. Аналогично получаем, что в графе есть искомая клика.
2) • Рассмотрим клику на $r(n,m −1)+r(n −1,m)−1$ вершинах с рёбрами цветов 1 и 2 и её произвольную вершину a.
• Если вершине a инцидентны хотя бы $r(n,m −1)$ рёбер цвета $2$ или хотя бы $r(n −1,m)$ рёбер цвета $1$, то мы найдём в графе клику на $n$ вершинах с рёбрами цвета $1$ или клику на $m$ вершинах с рёбрами цвета $2$ 
• Остаётся случай, когда вершине a инцидентны ровно $r(n, m −1)−1$ рёбер цвета $2$ и ровно $r(n−1,m)−1$ рёбер цвета $1$, то же самое для всех остальных вершин.
• Это означает, что в графе из рёбер цвета $2$ всего $r(n, m −1)+r(n−1,m)−1$ вершин и степень каждой вершины равна $r(n,m −1)−1$. Однако, тогда в графе нечётное количество вершин нечётной степени.

# Оценка снизу на r(k,k).
## Теорема 2
**(P. Erdos, 1947.)** Для любого натурального числа k ≥ 2 выполняется неравенство $r(k,k) ≥ 2^{k/2}$.
## Доказательство. 
- $r(2,2) = 2 ≥ 2^{2/2}$. Далее $k ≥ 3$.
-  Зафиксируем множество различных помеченных вершин $v_1, . . ., v_n$. Пусть $g(n,k)$ — доля среди всех графов на вершинах $v_1,...,v_n$ тех графов, что содержат клику на $k$ вершинах.
Всего графов на наших вершинах, очевидно, $2^{C^2_n}$ (каждое из возможных $C^2_n = \frac{n(n−1)}{2}$ рёбер можно провести или не провести). 
Посчитаем графы с кликой на $k$ вершинах так: cуществует
$$
C^k_n = \frac{n!}{k!(n-k)!}=\frac{n(n-1)(n-2)...(n-k+1)}{k!} < \frac{n^k}{k!}
$$
способов выбрать $k$ вершин для клики в нашем множестве, после чего все рёбра между ними будем считать проведёнными, а остальные рёбра выбираются произвольным образом.
- Таким образом, каждый граф с кликой на $k$ вершинах будет посчитан, причём некоторые даже более одного раза. Количество графов с кликой размера $k$ оказывается не более,
$C_n^k*2^{C_n^2-C_k^2}$. Следовательно,
$$
g(n, k) \leq \frac{C_n^k*2^{C_n^2-C_k^2}}{2^{C^2_n}} = \frac{C_n^k}{2^{C^2_k}} < \frac{n^k}{k!*2^{C^2_k}}   \ \ \ \ \ \ \ \ \ \  (1)
$$

• Подставив $n < 2^{k/2}$ в неравенство (1), мы получаем
$$
\frac{2^{k^2/2}*2^{-C^2_k}}{k!}=\frac{2^{k/2}}{k!} < \frac{1}{2}
$$

• Предположим, что $r(k,k) = n < 2^{k/2}$ и разобьём все графы на n вершинах на пары $G, \overline{G}$ (граф и его дополнение).
• Так как $g(n,k) < \frac{1}{2}$, то существует пара, в которой ни $G$, ни $\overline{G}$ не содержат клики на $k$ вершинах. Рассмотрим раскраску рёбер $K_n$ в два цвета, в которой рёбра цвета $1$ образуют граф $G$. В такой раскраске нет клики на $k$ вершинах ни цвета $1$, ни цвета $2$, противоречие.
• Следовательно, $r(k,k) ≥ 2^{k/2}$.

## Следствие 1
Для любых $k,m ∈ \N$ таких, что $2 ≤ k ≤ m$, выполняется неравенство $r(k,m) ≥ 2^{k/2}.$

# Двумерные числа Рамсея: оценка сверху для случая более чем двух цветов.

**Числа Рамсея для раскрасок в несколько цветов**
 • Естественным обобщением классических чисел Рамсея является случай, когда рёбра полного графа красятся не в два, а в произвольное число цветов.
## Определение
 Пусть $k,n_1,...,n_k ∈ \N$. Число Рамсея $r(k;n_1,...,n_k)$ — это наименьшее из всех таких чисел $x ∈ \N$, что при любой раскраске рёбер полного графа на $x$ вершинах в $k$ цветов для некоторого $i ∈ [1..k]$ обязательно найдётся клика на $n_i$ вершинах с рёбрами цвета $i$.
 • Отметим, что $r(2;n,m)$ — это определённое ранее число Рамсея $r(n,m)$.

## Теорема 3
**(P. Erdos, G.Szekeres, 1935.)** Пусть $k,n_1,...,n_k ≥ 2$ — натуральные числа. Тогда
$$
r(k;n_1,...,n_k) ≤ r(k;n_1−1,n_2,...,n_k)+r(k;n_1,n_2−1,...,n_k)+ · · · + r(k;n_1,n_2,...,n_k − 1) − k +2.
$$
## Доказательство. 
• Рассмотрим клику на $p=r(k;n_1−1,n_2,...,n_k)+r(k;n_1,n_2−1,...,n_k)+ · · · + r(k;n_1,n_2,...,n_k − 1) − k +2$ вершинах с рёбрами цветов $1, . . . , k$ и ее произвольную вершину $a$. От вершины $a$ отходит $p −1$ рёбер цветов $1,...k$.
• Мы хотим доказать, что существует такое $j ∈ \{1,...,k\}$, для которого найдется клика на $n_j$ вершинах с рёбрами цвета $j$.
• Предположим, что от вершины $a$ отходит хотя бы $r(k;n_1,...,n_i − 1,...,n_k)$ рёбер цвета $i$. Рассмотрим концы этих ребер. Среди них есть либо клика на $n_s$ вершинах с рёбрами цвета $s\ne i$, либо клика на $n_i −1$ вершинах с рёбрами цвета $i$. В последнем случае добавим вершину a и получим клику на m вершинах с рёбрами цвета $i$.
• Остается случай, когда для каждого $i$ вершине $a$ инцидентно не более $r(k;n_1,...,n_i − 1,...,n_k) − 1$ рёбер цвета $i$. Тогда a инцидентна не более чем
$$
r(k;n_1 − 1,n_2,...,n_k) − 1 + r(k;n_1,n_2 − 1,...,n_k) − 1 + · · · + r(k;n_1,n_2,...,n_k − 1) − 1 = p −2 \ \ рёбрам,
$$
противоречие.

# Многомерные числа Рамсея: доказательство конечности.
• Результат этого раздела не относится к классической теории графов, но тесно с ней связан. Даже формулировать определения и результаты мы будем не на языке графов.
## Определение 
Пусть $m,k,n_1,...,n_k ∈ \N$, причём $n_1,...,n_k ≥ m$. Число Рамсея $r_m(k;n_1,...,n_k)$ — это наименьшее из всех таких чисел $x ∈ \N$, что при любой раскраске $m$-элементных подмножеств $x$-элементного множества $M$ в $k$ цветов для некоторого $i ∈ [1..k]$ обязательно найдётся такое множество $W_i$, что $|W_i|$ = $n_i$ и все $m$-элементные подмножества множества $W_i$ имеют цвет $i$. Число $m$ называется размерностью числа Рамсея $r_m(k;n_1,...,n_k)$.
• Нетрудно понять, что числа Рамсея размерности $2$ — это определённые выше числа Рамсея для клик.
• При количестве цветов, равном $2$, этот параметр мы будем опускать и писать $r_m(n_1,n_2)$ вместо $r_m(2;n_1,n_2).$
• Для каждого множества $M$ через $M^k$ мы будем обозначать множество всех $k$-элементных подмножеств $M$.
# Теорема 4
**(F. Ramsey, 1930.)** Пусть $m,k,n_1,...,n_k$ — натуральные числа, причём
$k ≥2$, а $n_1,...,n_k ≥ m$. Тогда число Рамсея $r_m(k;n_1,...,n_k)$ существует (то есть, конечно).
## Доказательство. 
1. • Мы будем доказывать теорему **по индукции**. Начнем со случая $k = 2$. Приступая к доказательству для числа $r_m(n_1,n_2)$ мы будем считать доказанным утверждение теоремы для чисел Рамсея всех меньших размерностей и чисел Рамсея размерности $m$ с меньшей суммой $n_1 +n_2$. В качестве базы будем использовать случай чисел Рамсея размерности $2$, разобранный в [Теореме 1](#теорема-1).
• Мы докажем, что
$$ 
r_m(n_1,n_2) − 1 ≤ p = r_{m−1}(r_m(n_1 −1,n_2), r_m(n_1,n_2 −1)).
$$
• Рассмотрим $(p +1)$-элементное множество $M$ и выделим в нём элемент $a$.
• Пусть $M_0 = M$ \ $\{a\}$, а $ρ : M^m →\{1,2\}$ — произвольная раскраска в два цвета. Определим раскраску $ρ^′ : M^{m−1}_ 0 →\{1,2\}$: для каждого множества $B ∈ M^{m−1}$ положим $ρ^′(B) := ρ(B ∪\{a\})$.
• Так как $|M_0| = p = r_{m−1}(r_m(n_1 −1,n_2),r_m(n_1,n_2 −1))$, либо существует $r_m(n_1 − 1,n_2)$-элементное подмножество $M_1 ⊂M_0$, для которого $ρ^′(B) = 1$ на всех $B ∈ M^{m−1}_1$ , либо существует $r_m(n_1,n_2 − 1)$-элементное подмножество $M_2 ⊂M_0$, для которого $ρ^′(B) = 2$ на всех $B ∈ M^{m−1}_2$ Случаи аналогичны, рассмотрим первый случай и множество $M_1$.
• По индукционному предположению из $|M_1| = r_m(n_1 −1,n_2)$ следует, что либо существует $n_1 − 1$ элементное подмножество $N_1 ⊂ M_1$, для которого $ρ(A) = 1$ на всех $A ∈ N^m_1$ , либо существует $n_2$-элементное подмножество $N_2 ⊂ M_1$, для которого $ρ(A) = 2$ на всех $A ∈N^m_2$
• Во втором случае искомое подмножество найдено (это $N_2$)
• Рассмотрим первый случай и множество $N = N_1 ∪ \{a\}$. Пусть $A ∈ N_m$. Если $A \not\ni a$, то $A ∈ N^m_1$ и, следовательно, $ρ(A) = 1$. Если же $A ∋ a$, то множество $A$\ {$a$} $∈ N^{m−1}_1 ⊂M^{m−1}_1$ и потому $ρ(A) = ρ^′(A$\ $\{a\}) = 1$. Учитывая, что $|N| = n_1$, мы нашли искомое подмножество и в этом случае.
2) • При k >2 будем вести индукцию по k с доказанной выше базой k = 2.
• Докажем неравенство 
$r_m(k;n_1,...,n_k) ≤ q = r_m(r_m(k−1;n_1,...,n_{k−1}),n_k).$
• Рассмотрим множество $M$ на $q$ вершинах и произвольную раскраску $ρ : M^m → [1..k]$ в $k$ цветов.
• Рассмотрим раскраску $ρ^′ : M^m → {0,k}$, в которой цвета $1, . . ., k − 1$ раскраски $ρ$ склеены в цвет $0$.
• Тогда существует либо такое подмножество $M_0 ⊂ M$, что $|M_0| = r_m(k −1;n_1,...,n_{k−1})$ и $ρ^′(A) = 0$ на всех $A ∈ M^m_0$ , либо существует такое $n_k$-элементное подмножество $M_k ⊂ M$, что $ρ(A) = ρ^′(A) = k$ на всех $A ∈ M^m_k$ .
• Во втором случае $M_k$ — искомое подмножество, а в первом случае заметим, что на любом подмножестве $A ∈ M^m_0$ из $ρ^′(A) = 0$ следует $ρ(A) ∈ [1..k −1]$. Исходя из размера множества $M_0$, по индукционному предположению получаем, что найдётся искомое подмножество множества $M$ для одного из цветов $1,...,k − 1$.

# Применение теории Рамсея: задача о выпуклом n-угольнике.
• Для любого $m ≥ 3$ мы докажем, что если взять на плоскости очень много точек общего положения (никакие три не лежат на одной прямой), среди них найдется $m$, образующих выпуклый $m$-угольник
• Выпуклая оболочка $k$ точек — минимальный по включению выпуклый многоугольник, все их содержащий. Известно, что вершины выпуклой оболочки — всегда некоторые из наших точек.
• Если все $k$ точек являются вершинами своей выпуклой оболочки, то они образуют выпуклый $k$-угольник.

## Лемма 1
На плоскости дано множество $M$ из $k$ точек общего положения на плоскости таких, что любой $4$-угольник с вершинами в $4$ из этих точек выпуклый. Тогда точки из $M$ образуют выпуклый $k$-угольник.

## Доказательство. 
• Предположим противное и рассмотрим выпуклую оболочку точек множества $M$, тогда в ней $s < k$ вершин. 
• Триангулируем этот $s$-угольник диагоналями и рассмотрим точку $A ∈ M$, не являющуюся вершиной $M$.
• Точка $A$ попала внутрь одного из треугольников триангуляции — скажем, в $B_1B_2B_3$ (см. рисунок). Тогда $B_1B_2AB_3$ — невыпуклый четырёхугольник, противоречие.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/ramsey/1.png?raw=true)
## Лемма 2
Из любых 5 точек общего положения на плоскости можно выбрать 4, образующие выпуклый 4-угольник.
## Доказательство
• Рассмотрим выпуклую оболочку наших $5$ точек. Если это $4$- или $5$-угольник, Лемма доказана.
• Пусть выпуклая оболочка — треугольник $ABC$. Внутри него расположены еще оставшиеся точки — скажем, $X$ и $Y$.
• Прямая $XY$ не может проходить через вершину треугольника $ABC$ (точки в общем положении), а значит, $XY$ пересекает две стороны треугольника — скажем, $AB$ и $BC$ (см. рисунок).
• Тогда 4-угольник $AXYC$ — выпуклый.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/ramsey/2.png?raw=true)

## Теорема 5
Для любого $m ≥ 3$ существует такое $k_m ∈ \N$, что среди любых $k_m$ точек общего положения на плоскости есть $m$, образующих выпуклый $m$-угольник.
## Доказательство
• Пусть $k_m = r_4(m,5)$
• Рассмотрим любые $k_m$ точек общего положения на плоскости и покрасим четверки этих точек в цвет $1$, если они образуют выпуклый $4-угольник$, и в цвет $2 — если \ не \ выпуклый$.
• Тогда найдутся либо $m$ точек, все четверки среди которых цвета $1$, либо $5$ точек, все четверки среди которых цвета $2$.
• В первом случае по [Лемме 1](#лемма-1) мы нашли m точек, образующих выпуклый m-угольник.
• Второй случай невозможен по [Лемме 2](#лемма-2).

# Применение теории Рамсея: теорема Шура об одноцветном решении уравнения $x+y = z$.

## Теорема 6 
**(I. Schur, 1917.)** Пусть $n ∈ \N$, а натуральные числа от $1$ до $n$ покрашены в $k$ цветов. Тогда при любом достаточно большом $n$ найдется одноцветное решение уравнения $x +y =z$ в числах {$1,...,n$}.

## Доказательство
• Пусть $n ≥ r(k;3,...,3)$ (здесь $k$ троек)
• Соединим каждые два числа $s,t ∈ \{1,···n\}$ ребром, покрашенным в цвет $|s −t|$.
• Тогда найдется треугольник c одноцветными рёбрами — скажем, из чисел $a > b > c$.
• Это означает, что $a −b$, $b −c$, $a−c$ — одноцветное решение уравнения $x +y = z$, так как $(a −b)+(b−c) =a−c$.

# Лемма о произвольном дереве-подграфе

• Ещё один способ обобщения классической теории Рамсея — замена клик на произвольные графы-шаблоны.
## Определение 
Пусть $H_1,H_2$ — два данных графа. Число Рамсея $r(H_1,H_2)$ — это наименьшее из всех таких чисел $x ∈ \N$, что при любой раскраске рёбер полного графа на $x$ вершинах в два цвета обязательно найдётся подграф с рёбрами цвета $1$, изоморфный $H_1$, или подграф с рёбрами цвета $2$, изоморфный $H_2$.
• Из результатов классической теории Рамсея понятно, что числа $r(H_1,H_2)$ обязательно существуют (то есть, конечны). Интересно, что иногда их можно точно вычислить.
## Лемма 3 
Пусть $m > 1$, а граф $H$ таков, что $v(H) ≥ (m−1)(n−1)+1$ и $α(H) ≤ m−1$. Тогда граф $H$ содержит в качестве подграфа любое дерево на $n$ вершинах.
## Доказательство. 
• Зафиксируем $m$ и проведём индукцию по $n$. База для $n = 1$ очевидна.

**Индукционный переход** $n −1 → n (n > 1).$ 
• Рассмотрим произвольное дерево $T_n$ на $n$ вершинах, пусть дерево $T_{n−1}$ получено из $T_n$ удалением висячей вершины (см. рис.а).
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/ramsey/3.png?raw=true)
• Пусть $U$ — максимальное независимое множество вершин графа $H$. Тогда $|U| = α(H) ≤ m−1$, следовательно,$v(H − U) ≥ (m −1)(n −2)+1$ и, очевидно, $α(H −U) ≤ m−1$
• По индукционному предположению граф $H −U$ содержит в качестве подграфа дерево $T_{n−1}$. Пусть $a$ — вершина этого дерева, присоединив к которой висячую вершину, мы получим дерево $T_n$.
• Заметим, что множество $U ∪ \{a\}$ не является независимым ввиду максимальности $U$, следовательно, вершина $a$ смежна хотя бы с одной вершиной $x ∈ U$.
• Так как $x \not\in V(T_{n−1})$, можно присоединить вершину $x$ к вершине $a$ дерева $T_{n−1}$. В результате мы получим дерево $T_n$ в качестве подграфа графа $H$.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/ramsey/4.png?raw=true)

#  Числа Рамсея для проимзвольных графов. Теорема Хватала
## Теорема 7
**(V.Chvatal, 1977.)** Пусть $T_n$ — дерево на $n$ вершинах. Тогда $r(T_n,K_m) = (m −1)(n −1)+1$.
Доказательство. 
1. • Докажем, что $r(T_n,K_m) ≥ (m−1)(n−1)+1$
• Для этого предъявим раскраску рёбер графа $K_{(m−1)(n−1)}$, в которой нет ни одного связного подграфа на $n$ вершинах с рёбрами цвета $1$ и нет клики на $m$ вершинах с рёбрами цвета $2$. 
Разобьём вершины графа на $m−1$ клику по $n−1$ вершине и покрасим все рёбра этих клик в цвет $1$, а остальные рёбра — в цвет $2$.
• Тогда любой связный подграф с рёбрами цвета $1$ содержит не более $n −1$ вершины, в частности, нет подграфа с рёбрами цвета $1$, изоморфного $T_n$. Рёбра цвета $2$ (то есть, все оставшиеся рёбра) образуют $(m −1)$-дольный граф, в котором, очевидно, нет клики на $m$ вершинах.
2. • Рассмотрим произвольную раскраску рёбер полного графа $K_{(m−1)(n−1)+1}$ в два цвета и его остовный подграф $G_1$ с рёбрами первого цвета.
• Предположим, что не существует клики на $m$ вершинах с рёбрами цвета $2$. Тогда $m > 1$ и $α(G1) ≤ m−1$. По [Лемме 3](#лемма-3) граф $G_1$ содержит в качестве подграфа любое дерево на $n$ вершинах, в частности, дерево, изоморфное $T_n$

# Оценка количества рёбер в графе, удовлетворяющем наследственному свойству.

## Наследственное свойство
## Определение 
• Назовем свойство $P$ графа наследственным, если для любого графа $G$, удовлетворяющего свойству $P$, любой индуцированный подграф $H$ графа $G$ также удовлетворяет свойству $P$. 
• Обозначим через $P(n)$ наибольшее возможное количество рёбер в графе на $n$ вершинах, удовлетворяющем свойству $P$. 
• Наследственных свойств довольно много. Например, свойства “граф не содержит подграфа, изоморфного данному” или “хроматическое число графа не превосходит $k$” являются наследственными.

## Теорема 8
Пусть $P$ — наследственное свойство графов и $n≥ 3$. Тогда $P(n) ≤ \frac{n}{n−2}P(n −1)$
## Доказательство
• Рассмотрим удовлетворяющий свойству $P$ граф $G$ на $n$ вершинах с $e(G) = P(n)$. Пусть $V(G) = {v_1,...,v_n}.$
• Так как граф $G_i = G −v_i$ — индуцированный подграф $G$ —также удовлетворяет свойству $P$, мы имеем неравенство $e(G) − d_G(v_i) = e(G_i) ≤ P(n −1).$
• Сложив такие неравенства для всех $i ∈ [1..n]$, мы получим
$$
(n−2)P(n) = (n−2)e(G) = ne(G)−\sum_{i=1}^n d_G(v_i) ≤ n·P(n−1),
$$
тк
$$
\sum_{i=1}^n d_G(v_i)  = 2e(G)
$$
откуда немедленно следует утверждение теоремы.


## Задача о запрещенном подграфе

**Определение.** Пусть H — некоторый фиксированный граф. Через $ex(v,H)$ мы обозначим наибольшее возможное количество рёбер в графе на $v$ вершинах, не содержащем подграфа, изоморфного $H$.

• Мы рассмотрим самый простой случай задачи о запрещенном подграфе — это задача о максимальном числе рёбер в графе без полного подграфа $K_n$
• (n −1)-дольный граф — это граф, вершины которого разбиты на $n −1$ долю так, что внутри долей нет ребер.
• Полный $(n−1)$-дольный граф имеет все рёбра между долями.
• Очевидно, полный $s$-дольный граф при $s ≥ n$ содержит $K_n$, а при $s ≤ n−1$ не содержит $K_n$
• Пусть $v = q(n−1)+r$, где $r$ — остаток от деления $v$ на $n −1$. Обозначим через $T_{v,n}$ полный $(n −1)$-дольный граф на $v$ вершинах с $r$ долями размера $q +1$ и $n−1−r$ долями размера $q$.



## Лемма 4 
Среди всех $s$-дольных графов на $v$ вершинах, где $s ≤n−1$, наибольшее число ребер имеет $T_{v,n}$
## Доказательство.
 • Пусть $H$ — подходящий под условие граф с максимальным числом ребер. Понятно, что он является полным $s$-дольным для некоторого $s ≤ n −1$.
 • Можно считать $H$ полным $(n−1)$-дольным графом с долями размеров $k_1,...,k_{n−1}$ (при $s < n −1$ добавим доли размера $0$), где $k_1 +··· +k_{n−1} = v$.
 • Количество ребер полного графа на $v$ вершинах равно $\frac{v(v-1)}{2}$, а количество рёбер полного графа на $k_i$ вершинах равно $\frac{k_i(k_i−1)}{2}$
 • Следовательно,
 $$
 e(H) = \frac{v(v-1)}{2} - \sum_{i=1}^{n-1}{\frac{k_i(k_i−1)}{2}} = \frac{v(v-1)}{2} + \sum_{i=1}^{n-1}{\frac{k_i}{2}} -\sum_{i=1}^{n-1}{\frac{k^2_i}{2}}=\frac{v^2}{2} - \sum_{i=1}^{n-1}{\frac{k^2_i}{2}}
$$ 
• Значит, e(H) максимально, когда $\sum_{i=1}^{n-1}{k^2_i}$ минимально
• При $\sum_{i=1}^{n-1}{k_i}=v$ минимум суммы квадратов достигается на “почти равных” $k_1,...,k_{n−1}$ — случае графа $T_{v,n}$
• В самом деле, пусть для $k_1,...,k_{n−1}$ сумма их квадратов минимальна. Рассмотрим наибольшее и наименьшее числа — скажем, $k_i$ и $k_j$. Если $k_i −k_j ≥ 2$, то $k^2_i + k^2_j > (k_i −1)^2 +(k_j +1)^2$, что противоречит выбору $k_1, . . ., k_{n−1}.$
• Значит, при минимальной $\sum_{i=1}^{n-1}{k^2_i}$ минимум и максимум из чисел $k_1,...,k_{n−1}$ отличаются не более чем на $1$. Так как они целые числа, то при $v = q(n−1)+r$, где $r$ — остаток от деления $v$ на $n−1$ это как раз $r$ чисел $q +1$ и $n−1−r$ чисел $q$. Это случай графа $T_{v,n}$.
• Количество ребер графа Tv,n Нетрудно подсчитать:
$$
e(T_{v,n})=\frac{(n-2)(v^2-r^2)}{2(n-1)}+\frac{r(r-1)}{2}
$$
где r — остаток от деления v на n−1.

# Графы без $K_n$: теорема Турана.
## Теорема 9
**(P. Tur´ an, 1941.)** При n ≥ 3
$$
ex(v, K_n)=e(T_{v,n})=\frac{(n-2)(v^2-r^2)}{2(n-1)}+\frac{r(r-1)}{2}
$$
где r — остаток от деления v на n−1.
## Доказательство
• Пусть $H$ — граф без $K_n$ на $v$ вершинах.
• Для $a,b ∈ V(H)$ будем писать $a ∼ b$, если $N_H(a) = N_H(b)$
• Если $a ∼ b$, то очевидно, что $a$ и $b$ несмежны. Следовательно, $a$ и $b$ не могут входить в одну клику $K_n$.
• Понятно, что $a ∼ b$ — отношение эквивалентности. Значит, $V(H)$ разбито на классы эквивалентности по $∼$.
• Пусть $a \not∼ b$ и эти вершины несмежны. НУО $d_H(a) ≥ d_H(b)$. Тогда заменим весь класс эквивалентности вершины $b$ на вершины, эквивалентные $a$. Количество ребер не уменьшится, но станет меньше классов эквивалентности. Так как эквивалентные вершины не могут входить вместе в $K_n$, в полученном графе также нет $K_n$.
• Будем выполнять такие операции, пока это возможно. Процесс конечен (уменьшается число классов эквивалентности), значит, он закончится, и в результате получится граф $G$ без $K_n$, в котором $e(G) ≥ e(H)$ и любые две неэквивалентные вершины смежны.
• Пусть в $G$ ровно $s$ классов эквивалентности. Тогда $G$ — Полный $s$-дольный граф, в котором доли — именно эти классы. Так как $G$ не содержит $K_n$, $s ≤ n−1$.
• По Лемме 4 мы имеем $e(G) ≤ e(T_{v,n})$