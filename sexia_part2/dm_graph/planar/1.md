# Изображение графа на плоскости, грань.  
  
## Определение  
Граф называется **планарным**, если его можно изобразить  
на плоскости так, чтобы его рёбра не пересекались во  
внутренних точках. Вершины изображаются точками, а  
рёбра — ломаными. Внутренние точки любой ломаной,  
изображающей ребро графа, не должны быть вершинами  
графа.  
  
## Грань плоского графа  
  
 • Изображение плоского графа делит плоскость на части —  
 грани. Это ключевой объект для плоского графа, отличающий  
 его от абстрактного планарного графа. Ниже мы дадим  
 формальное определение граней.  
 • На плоскости изображен плоский граф G. Пусть M —  
 множество всех точек плоскости, не входящих в изображение  
 G.  
 • Пусть запись A ∼ B означает, что точки A,B ∈ M можно  
 соединить ломаной, не пересекающей изображение графа G.  
 Укажем три важных свойства ∼.  
 ### Утверждение  
 ∼ —отношение эквивалентности.  
 ### Доказательство.
  • Рефлексивность. A ∼ A  
 • Симметричность. Если A ∼ B, то B ∼ A.  
 • Транзитивность. Если A ∼ B и B ∼ C, то A ∼ C.

## Определение 
Грани плоского графа G — классы эквивалентности по отшению ∼. 

• Таким образом, все точки плоскости, не лежащие на изображении графа G, разбиты на грани. 
• Множество всех граней графа G обозначается через F(G), а их количество — через f(G). 
• Две точки из одной грани графа G могут быть соединены ломаной, не пересекающей изображение G. 
• Любая ломаная, соединяющая две точки из разных граней, пересекает изображение G


# Теорема Жордана для замкнутой ломаной.

## Теорема 1 Жордана
**(C.Jordan, 1887.)** Замкнутая несамопересекающаяся ломаная P делит точки плоскости, не лежащие на P, на две такие части, что выполнены следующие условия: 
1) любые две точки из одной части можно соединить ломаной, не пересекающей P; 
2) любая ломаная, соединяющая две точки из разных частей, пересекает P.

### Доказательство
• Пусть $P_1 ...P_m$ — вершины $P$ в порядке обхода по часовой стрелке. Обозначим через $M$ множество всех точек плоскости, не лежащих на $P$.

• Зафиксируем на плоскости вектор $ℓ$, не параллельный ни одной из сторон $P$. Из каждой точки $A \in M$ выпустим луч $ℓ(A)$ в направлении $ℓ$.

• В случае, если $ℓ(A)$ содержит вершину $P_i$ многоугольника $P$, но стороны $P_{i−1}P_i$ и $P_iP_{i+1}$ лежат в одной полуплоскости относительно содержащей $ℓ(A)$ прямой, мы будем говорить, что многоугольник P в вершине $P_i$ **касается** $ℓ(A)$

• Посчитаем число $p(A)$ точек пересечения $ℓ(A)$ с $P$, не являющихся касаниями. Очевидно, что $p(A)$ конечно.

• Часть $M_0$ будет состоять из всех точек $A \in M$, для которых $p(A)$ четно, а часть $M_1$ будет состоять из всех точек $B \in M$, для которых $p(B)$ нечетно.

### Утверждение $М_0$ и $М_1$ непусты
### Доказательство
• Рассмотрим прямую $ℓ_0$, параллельную вектору $ℓ$, и проходящую через внутреннюю точку ломаной $P$ (то есть точку, не являющуюся ее вершиной).
• При движении по $ℓ_0$ в направлении вектора $ℓ$ отметим последнее пересечение с $ℓ$ во внутренней точке — пусть это точка $X$.
• Рассмотрим содержащий $X$ малый отрезок $[Y,Z]$ на этом $ℓ_0$, не пересекающий $P$ в отличных от $X$ точках, пусть $Y$ лежит перед $X$ при движении в направлении $ℓ$.
• Тогда $p(Y) = 1$ (единственное пересечение в точке $X$), а $p(Z) = 0$.

### Утверждение 
Пусть $A,B \in M$ и отрезок $[A,B]$ не пересекает $P$. Тогда $p(A)$ и $p(B)$ имеют одинаковую четность. В частности, выполнено условие (2).

### Доказательство
• Если $AB ∥ ℓ$, то утверждение очевидно.
• Если нет, то отметим на отрезке $AB$ все такие точки $A_1, ..., A_k$ в направлении от $A$ к $B$, что $ℓ(A_i)$ касается $P$ (если они есть). Положим $A_0 = A$ и $A_{k+1} = B$.
• Тогда для каждого $i \in [0..k]$, все точки отрезка $[A_i,A_{i+1}]$ имеют, очевидно, одинаковое значение функции $p$, а при переходе на соседний отрезок функция $p$ может иметь четный скачок (каждое касание $ℓ(A_i)$ многоугольника $P$ добавляет точкам с одной стороны от $A_i$ двойку к количеству пересечений, см. рис.a).
• В любом случае, на всем отрезке $[A,B]$ функция $p$ имеет одинаковую четность.
Рисунок а:
![Рисунок а](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/1.png?raw=true)

#### Докажем (1). 
• Пусть $A,B \in M_i$. Если отрезок $[A,B]$ не пересекает $P$, то все понятно. Пусть пересекает, причем $A_1 и B_1$ — ближайшие к $A$ и $B$ соответственно точки пересечения.

• Отметим на отрезке $[A,A_1]$ точку $A′$ очень близко к $A_1$, а на отрезке $[B_1,B]$ — точку $B′$ очень близко к $B_1$, пусть $|A1A′|$ = $|B1B′|$ = $\delta$ (см. рис. b). Тогда $p(A) = p(A′)$ и $p(B) = p(B′)$.
Рисункок b:
![Рисунок b](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/2.png?raw=true)
• Проведем вдоль каждой стороны многоугольника $P$ две параллельных прямых на расстоянии $\delta$ с разных сторон, выбрав это число столь малым, чтобы в результате получились два “очень близких” к $P$ многоугольника $P′$ и $P′′$ так, чтобы стороны $P′$ и $P′′$ не пересекали сторон $P$. (Достаточно выбрать $\delta$ меньше, чем минимальное расстояние от стороны $P$ до вершины, на ней не лежащей.)
• НУО $A′$ лежит на $P′$. Если и $B′$ лежит на $P′$, то мы построили от $A′$ до $B′$ ломаную, не пересекающую $P$, тогда такая ломаная построена и от $A$ до $B$.
• Пусть $B′$ лежит на $P′′$, тогда обозначим через $B^∗$ точку пересечения $P′$ с прямой $AB$, лежащую около $B$ (разумеется, на расстоянии $\delta$).
• Несложно понять, что $p(B∗) −p(B′) = ±1$ (разница состоит в том, что ровно для одной из этих точек учитывается пересечение около точки $B_1$).
• Однако применив доказанное выше утверждение, получим $p(B^∗) ≡ p(A′) ≡ p(A) ≡ p(B) ≡ p(B′) (mod 2)$, противоречие. 


# Изображение графа на плоскости и сфере, их соответствие. Внешняя грань.


## Плоскость и сфера
• Плоскость и сфера переводятся друг в друга стереографической проекцией.
• Поставим сферу на плоскость, точку касания назовём южным полюсом, противоположную точку — северным полюсом $N$. Каждая точка $A \ne N$ сферы перейдёт в точку пересечения плоскости и луча $NA$

## Утверждение 
Граф является планарным тогда и только тогда, когда его можно изобразить на сфере без пересечения рёбер во внутренних точках.

## Доказательство.
 • Переводя изображение графа со сферы на плоскость нужно лишь выбрать северный полюс так, чтобы он не совпадал ни с одной из вершин графа и не попадал на рёбра
 • Плоское изображение планарного графа ограничено (его можно поместить в большой круг).
 • Поэтому в плоском изображении планарного графа есть ровно одна неограниченная внешняя грань, которая визуально сильно отличается от всех остальных, а в сферическом изображении такой грани нет.
 • Грань сферического изображения графа, содержащая северный полюс будет соответствовать при стереографической проекции внешней грани плоского изображения.
 • Таким образом, перемещая северный полюс на разные грани, можно любую грань сферического изображения сделать внешней гранью в плоском изображении графа. Это лишний раз подчеркивает, что на самом деле внешняя грань не отличается от остальных.

# Граница грани. Свойства.

## Граница грани
• Рассмотрим ребро $e$ плоского графа $G$. Либо по разные стороны от $e$ расположены разные грани (тогда ребро e — **граничное** ребро этих двух граней), либо по обе стороны от $e$ — одна и та же грань, тогда назовем ребро $e$ **внутренним** ребром этой грани. Обозначим через **$E_d$** множество всех граничных и внутренних рёбер грани $d$.

• Граничные вершины грани $d$ — это концы ребер из $E_d$. Обозначим множество граничных вершин грани $d$ через $V_d$.

• Граничные и внутренние рёбра грани $d$ — это в точности те рёбра, до которых от внутренней точки грани $d$ можно дойти по ломаной, не пересекая изображение графа.

• Граничные вершины грани $d$ — это в точности те вершины, до которых можно дойти по ломаной от внутренних точек этой грани, не пересекая её граничных и внутренних рёбер.

• **Граница** грани $d$ — это подграф $B(d)$ графа $G$ с множеством вершин $V_d$ и множеством рёбер $E_d$.

• **Размер границы** грани $d$ мы определим, как количество граничных рёбер этой грани плюс удвоенное количество внутренних рёбер. Обозначать эту величину будем через $b(d)$.

## Свойство 1
 Если сложить размеры границ всех граней, получится удвоенное количество рёбер.
 
## Доказательство
Внутреннее ребро грани два раза считается в размере границы этой грани. Граничное ребро двух граней по разу считается в их размерах.

## Свойство 2
 Любые две точки на границе грани d можно соединить ломаной, проходящей в d.
## Доказательство.
 Пусть $A$ — внутренняя точка грани $d$. От нее можно провести ломаные, не пересекающие изображение $G$ до любых двух граничных. Все точки на этих ломаных лежат в $d$.

## Свойство 3
 Если две точки A и B на изображении графа G можно соединить ломаной L, не пересекающей изображения G, то A и B лежат на границе некоторой грани.
## Доказательство.
 A и B лежат на границе грани d, содержащей все внутренние точки L (см. рисунок a).
![Рисунок а](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/3.png?raw=true)

# Циклический обход границы грани.

## Определение
 Рассмотрим любую вершину $a$ плоского графа $G$ и упорядочим выходы ребер из $a$ по часовой стрелке. Два ребра, выходы которых — соседние в этом порядке, будем называть **соседними в вершине a**.

## Свойство 4
Пусть $ab_1$ и $ab_2$ — два соседних ребра в вершине a. Тогда рёбра $ab_1$ и $ab_2$ лежат в границе некоторой грани.
## Доказательство.
Вершины $b_1$ и $b_2$ можно соединить ломаной вдоль $b_1ab_2$, не пересекающей изображения $G$ (см. рисунок b). Поэтому, рёбра $ab_1$ и $ab_2$ лежат в границе некоторой грани.
![Рисунок а](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/4.png?raw=true)

• Пусть $G$ — плоский граф, $d \in F(G)$, а $x_1x_2 \in E_d$.
• Пройдем по ребру $x_1x_2$ от $x_1$ к $x_2$. НУО справа по ходу движения расположена грань $d$. Повернем в вершине $x_2$ направо до выхода соседнего ребра $x_2x_3$. (Если $d_G(x_2) = 1$, то $x_3 = x_1$, это нам не мешает.) Очевидно, $x_2x_3 \in E_d$. Пойдем по этому ребру от $x_2$ к $x_3$, справа опять будет расположена грань $d$. И так далее. В конечном итоге мы вернемся на ребро $x_1x_2$ (в вершину $x_1$ мы можем вернуться и раньше!). Получился замкнутый циклический маршрут (см. рис.а).
![Рисунок а](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/5.png?raw=true)
• Пусть получился циклический маршрут $Z = x_1x_2...x_k$. Рассмотрим вершину $x_i$. по построению, $Z$ обходит вокруг $x_i$ — скажем, против часовой стрелки. Пусть мы вышли из вершины $x_i$ по ребру $x_ix_{i+1}$, а следующий раз вернулись в эту вершину по ребру $x_{j−1}x_j$ (в этом случае x$i = x$j, см. рис.b).
![Рисунок а](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/6.png?raw=true)
• Тогда сектор между выходами рёбер $x_ix_{i+1} и x_jx_{j−1}$ из вершины $x_i = x_j$ не принадлежит грани $d$. Следовательно, $Z$ проходит все рёбра из $E_d$, инцидентные вершине $x_i$. Поскольку это верно для любой вершины $Z$, этот маршрут обходит все рёбра одной из компонент графа $B(d)$.
• Обозначим через $Z(U)$ такой маршрут для компоненты $U$, а через $Z(d)$ — объединение построенных маршрутов для всех компонент $B(d)$.
• Если маршрут $Z(d)$ проходит ребро $e$ дважды, то, очевидно, в разных направлениях. Значит, по обе стороны от $e$ расположена грань $d$, то есть $e$ — внутреннее ребро $d$.
• Пусть $e$ — внутреннее ребро грани $d$ (см. ребро $x_2x_3 = x_6x_7$ на рисунке). Тогда при проходе по $e$ в любом из направлений справа будет расположена грань d. Поэтому, маршрут $Z(d)$ дважды пройдет $e$ — в обоих направлениях.

# Несвязная граница грани у несвязного графа.

## Лемма 1
Для плоского графа G выполнены следующие утверждения.
 1) Если $d \in F(G)$ и $B(d)$ несвязна, то разные компоненты связности графа $B(d)$ лежат в разных компонентах связности графа $G$. 
 2) Граф G несвязен, если и только если он имеет грань с несвязной границей.
## Доказательство
1) • Пусть $B_1 и B_2$ — две компоненты $B(d)$. Изображение компоненты $B_1$ ограничено и не пересекает других компонент $B(d)$. Следовательно, изображение $B_1$ можно отделить от изображения $B_2$ замкнутой ломаной в грани $d$, не пересекающей ребер $G$ (такую ломаную можно построить, почти повторив маршрут $Z(B_1)$: вместо каждого прохода по ребру, проведем его копию на малом расстоянии $\delta$ в грани $d$, как в доказательстве теоремы Жордана).
• Значит, между $B_1$ и $B_2$ нет пути в графе G.
 2) Очевидно, можно обойти все грани графа $G$, каждый раз переходя в грань имеющую с предыдущей общую сторону или вершину (достаточно отметить по внутренней точке на каждой грани и проложить на плоскости маршрут, все эти точки обходящий).
 • Тогда, если граница каждой грани связна, то связно и их объединение, а это граф G, противоречие. Значит, несвязный граф имеет грань с несвязной границей.
 • Если G имеет грань с несвязной границей, то G несвязен по пункту 1.

# Внутренние рёбра граней — мосты. Границы граней графа без мостов — циклы.
## Лемма 2
Внутренние рёбра граней плоского графа $G$ — в точности все мосты графа $G$.

## Доказательство. 
• Пусть внутреннее ребро $e$ грани $d$ — не мост, тогда оно лежит в простом цикле $C$. По [теореме Жордана](#теорема-жордана-для-замкнутой-ломаной.) цикл делит плоскость на две области, а грань $d$ может лежать только в одной из них.
 • Наоборот, пусть $e = ab$ — мост. Тогда граф $G −e$ имеет две компоненты $G_a$ и $G_b$, содержащие $a$ и $b$ соответственно. 
• Изображение компоненты $G_a$ ограничено и не пересекает $G_b$, значит, существует замкнутая ломаная $P$ в грани $d$, отделяющая $G_a$ от $G_b$ (см. рис.a). Очевидно, $P$ пересекает ребро $e$, а значит, по обе стороны от моста $e$ расположена одна и та же грань.
![Рисунок а](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/7.png?raw=true)


## Лемма 3 
Пусть $d$ — грань реберно двусвязного графа $G$. Тогда $B(d)$ — цикл (не обязательно простой).

## Доказательство.
 • Так как $G$ связен, $B(d)$ — связный граф по [Лемме 1](#лемма-1). Значит, и $Z(d)$ связен. Так как внутренних рёбер у $d$ нет (граф не имеет мостов), $Z(d)$ — цикл.
 • Докажем, что граница грани почти всегда однозначно задает эту грань.
 
# Если есть две грани с одинаковой границей, то граф — простой цикл.

## Лемма 4
 Если две разные грани $f$ и $f′$ плоского графа G имеют одинаковые границы, то $G$ — простой цикл.

## Доказательство.
 • Пусть $B$ — общая граница этих граней, $e \in E(B)$. По [Лемме 2](#лемма-2) тогда e — не мост графа G, а значит, существует простой цикл Z, содержащий e.
• Тогда Z делит плоскость на две области — $O ⊃ f$ и $O′ ⊃ f′$
• Пусть $e′ \in B$\ $Z$. Тогда $e′$ лежит внутри одной из областей $O$ и $O′$ —скажем, в $O′$. В этом случае, $e′$ не может быть граничным ребром грани $f ⊂ O$, противоречие.
• Докажем, что $G = Z$, тогда $G$ — простой цикл.
• Если $f = O$ и $f′ =O′$, то $G =Z$, что нам и нужно.
• Пусть, скажем, $f \ne O$.
• Так как каждая грань целиком лежит в одной из областей, $O$ разбивается на грани.
• Значит, существует еще одна грань $f^* ⊂ O$.
• Пусть $X ∈ f$ и $X^* ∈f^∗$.
• Так как точки $X$ и $X^∗$ лежат в области $O$, их можно соединить ломаной $L$, проходящей в $O$.
• Пойдем по ломаной $L$ от точки $X$. В некоторый момент мы перейдем из $f$ в другую грань. Значит, мы пересечем изображение графа $G$ — скажем, ребро $e$.
• Тогда $e$ — граничное ребро грани $f$. Но при этом $e$ изображено внутри $O$ (там проходит ломаная $L$), следовательно, $e \not\in E(Z)$. Противоречие с доказанным выше.

# Границы граней двусвязного графа.
## Лемма 5
Пусть G — плоский граф. 
1) Если грань $d$ и ее граничная вершина $a$ таковы, что $B_1$ и $B_2$ — разные компоненты графа $B(d)−a$, то $B_1$ и $B_2$ лежат в разных компонентах графа $G −a$. В частности, $a$ — точка сочленения графа G.
 2) Граф $G$ без петель вершинно двусвязен, если и только если границы его граней — простые циклы.
## Доказательство.
1) Аналогично доказательству [Леммы 1](#лемма-1), плоское изображение $B_1$ можно отделить от изображения $B_2$ ломаной, не пересекающей ребер $G −a$ (см. рис.b), а значит, между $B_1$ и $B_2$ нет рёбер в графе $G −a$. 
• Следовательно, a — точка сочленения графа G
![Рисунок b](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/8.png?raw=true)
2) • Пусть $a$ — точка сочленения графа $G$. Рассмотрим плоское изображение несвязного графа $G −a$, полученное из $G$ удалением вершины $a$. 
• В силу [Леммы 1](#лемма-1), граф $G −a$ имеет несвязную грань $d$, а граф $G$ не имеет. Значит, $a$ лежит на грани $d$ и смежна со всеми компонентами ее границы.
 • Упорядочим выходы ребер из $a$ по часовой стрелке. Тогда есть два соседних ребра, выходящих к разным компонентам графа $B(d)$ — скажем, ребро $ab_1$ к компоненте $B_1$ и ребро $ab_2$ к компоненте $B_2$ (см. рис.c). 
 ![Рисунок c](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/9.png?raw=true)
 • Точка сочленения a отделяет $b_1$ от $b_2$ в графе $G$. Существует грань $f$ графа $G$, граница которой содержит $a$, $b_1$ и $b_2$. Тогда a — точка сочленения $B(f)$. 
 • Наоборот, если грань $d$ такова, что $B(d)$ имеет точку сочленения, то по пункту 1 граф $G$ также имеет точку сочленения.

# Границы граней трёхсвязного графа.
## Определение
 • Цикл $C$ графа $G$ — **неразделяющий**, если граф $G −V(C)$ связен. 
 • Цикл $C$ — **индуцированный**, если он не имеет хорд (то есть, является индуцированным подграфом на своем множестве вершин).
## Лемма 6
 Пусть $G$ — трёхсвязный плоский граф. Тогда множество границ его граней есть в точности множество его неразделяющих индуцированных циклов.
## Доказательство. 
**⊃**. Пусть $C$ — неразделяющий индуцированный цикл в $G$. Тогда в одной из областей, на которые $C$ делит плоскость — назовём ее $d$ — нет вершин графа $G$. Так как индуцированный цикл C не имеет диагоналей, внутри d рёбер тоже нет. Значит d — грань, а цикл C — её граница.
**⊂**. • Пусть $C$ — граница грани $d$ графа $G$. Тогда $C$ — простой цикл.
 • Предположим, что $C$ имеет диагональ $xy$. Вершины $x$ и $y$ делят цикл $C$ на две дуги $C_1$ и $C_2$. • Граф $G −x −y$ должен быть связен ввиду трёхсвязности графа $G$. Значит, в $G −x −y$ есть $C_1C_2$-путь P. 
 • Понятно, что и диагональ $xy$, и путь $P$ должны проходить вне грани $d$, но тогда они пересекаются (см. рис.а), что невозможно.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/10.png?raw=true)
• Докажем, что граф $G −V(C)$ связен.
• Пусть $u,v \in V(G)$\ $V(C)$. По теореме Уитни в трёхсвязном графе $G$ существуют три независимых $uv$-пути $P_1$, $P_2$ и $P_3$, которые делят плоскость на три области.
• Грань $d$ лежит в одной из этих областей, пусть это область, граница которой образована путями $P_2$ и $P_3$ (см. рис.b). Тогда $P_1$ не пересекаетcя с границей грани $d$— циклом $C$ — а значит, вершины $u$ и $v$ связаны в $G −V(C)$.
![Рисунок b](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/11.png?raw=true)

# Изоморфизм графов и плоских изображений. Единственность изображения трёхсвязного планарного графа на плоскости.

## Разные изображения одного графа. Изоморфизм
• Слева и справа на рисунке — плоские изображения одного и того же графа. Но это разные изображения! У правого изображения есть грань, в границе которой 6 вершин, а у левого — нет.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/12.png?raw=true)

## Определение 
Пусть $G$ и $G′$ — два плоских графа, а биекция $\varphi : V(G) →V(G′)$ удовлетворяет следующим условиям. 
1) $xy \in E(G)$ $⇐⇒$ $\varphi(x)\varphi(y) \in E(G′)$; 
2) $U ⊂ V(G)$ является множеством граничных вершин некоторой грани графа $G$, если и только если $\varphi(U)$ = $\{\varphi(x) : x \in U\}$ является множеством граничных вершин некоторой грани графа $G′$. Тогда $\varphi$ — изоморфизм плоских графов $G$ и $G′$, а сами эти плоские графы изоморфны.

## Теорема 2 (H.Whitney, 1933.)
Любые два плоских изображения трёхсвязного планарного графа $G$ изоморфны как плоские графы.
## Доказательство.
 • Пусть $G_1$ и $G_2$ плоские изображения $G$, причем $x_1 \in V(G_1)$ и $x_2 \in V(G_2)$ — изображения вершины $x \in V(G)$.
 • Определим отображение $\varphi : V(G_1) → V(G_2)$ так: $\varphi(x_1) = x_2$ для любой вершины $x_1 \in V(G_1)$. Очевидно, $x_1y_1 \in E(G_1) ⇐⇒ xy \in E(G) ⇐⇒ \varphi (x_1)\varphi(y_1) = x_2y_2 \in E(G_2)$.
 • По [Лемме 6](#лемма-6) границы граней плоского графа $G_1$ — это в точности неразделяющие индуцированные циклы графа $G_1$, а границы граней плоского графа $G_2$ — это в точности неразделяющие индуцированные циклы $G_2$. Это свойство не имеет отношения к плоскому изображению.
 • $U_1 ⊂V(G_1)$ — множество вершин неразделяющего индуцированного цикла в $G_1$ (то есть, границы грани $G_1$) $⇐⇒ U⊂V(G)$множество вершин неразделяющего индуцированного цикла в $G ⇐⇒ \varphi(U_1)=U_2⊂V(G_2)$ — множество вершин неразделяющего индуцированного цикла в $G_2$ (то есть, границы грани $G_2$).
• Следовательно, $\varphi$ — изоморфизм плоских графов.

# Формула Эйлера
 • В разных плоских изображениях планарного графа G могут получаться разные грани. Однако их количество является инвариантом графа, как говорит нам формула Эйлера.
## Теорема 3 (L. Euler, 1752.)
 Пусть G — плоский граф с $v$ вершинами, $e$ рёбрами и $f$ гранями, имеющий $k$ компонент связности. Тогда $v −e+f =1+k$.
 ## Доказательство. Индукцией по количеству рёбер.
#### База
 для случая, когда граф G — лес, очевидна: в этом случае $f = 1$, $e = v −k$.
#### Переход
 • Пусть для меньших графов формула Эйлера уже доказана и $G$ — не лес.
 • Тогда в графе есть цикл, пусть ребро $ℓ$ входит в цикл. Так как $ℓ$ — не мост, по ребру $ℓ$ граничат две разные грани, которые объединяются в одну в графе $G −ℓ$.
 • Таким образом, в графе $G −ℓ$ $v$ вершин, $k$ компонент, $e −1$ ребро и $f −1$ грань. Теперь формула Эйлера для $G$ следует из формулы Эйлера для $G −ℓ$, которая верна по индукционному предположению.
 • Мы будем обозначать количество вершин, рёбер и граней плоского графа $G$ буквами $v$, $e$ и $f$ соответственно.
# Оценки на число ребер плоского графа и существование вершины степени не более 5.
## Следствие 1
 Пусть $G$ — планарный граф без петель и кратных рёбер, $v ≥3$. Тогда выполняются следующие утверждения. 
 1) $e ≤3v −6$.
  2) Если граф G — двудольный, то $e ≤ 2v −4$.
 ## Доказательство. 
 1) • Докажем, что размер границы каждой грани графа G не менее 3. В самом деле, пусть $d \in F(G), b(d) ≤ 2$.
 • Так как петель и кратных рёбер нет, $B(d)$ не имеет циклов. Следовательно, все рёбра внутренние. Тогда такое ребро всего одно, а значит, $e = 1$ и утверждение очевидно.
 • Сумма размеров границ всех граней равна $2e$, а размер каждой границы не менее $3$. Следовательно, $2e ≥ 3f$ или $f ≤ \frac{2e}{3}$ .
 • Тогда из формулы Эйлера $v − \frac{e}{3} = v −e+ \frac{2e}{3} ≥ v −e+f ≥ 2$, откуда следует доказываемое неравенство.
 2) • Докажем, что размер границы каждой грани двудольного графа G не менее 4
 • В самом деле, пусть $d \in F(G), b(d) ≤ 3$. Поскольку в двудольном графе нет циклов длины $3$, и в $G$ нет кратных рёбер, все рёбра внутренние. Тогда такое ребро всего одно, а значит, $e = 1$ и утверждение очевидно.
 • Сумма размеров границ всех граней равна $2e$, а размер каждой границы не менее $4$. Следовательно, $f ≤ \frac{e}{2}$. 
 • Тогда из формулы Эйлера $v − \frac{e}{2} = v −e+ \frac{e}{2} ≥v −e+f ≥2$, откуда следует доказываемое неравенство.

## Следствие 2 существование вершины степени не более 5.
 Пусть $G$ — планарный граф без петель и кратных рёбер. Тогда $\delta(G) ≤ 5$.
## Доказательство.
 • В случае v ≤ 2 утверждение очевидно.
 • Пусть v ≥ 3 и при этом $\delta(G) ≥ 6$. Тогда 6v ≤ 2e, то есть, e ≥ 3v — противоречие со Следствием 1. 

# Непланарность $K_5$ и $K_{3,3}$ и их подразбиений.

## Следствие 3
$K_5$ и $K_{3,3}$ — непланарные графы.
## Доказательство. 
1) Пусть $K_5$ планарен. Для этого графа $v =5$, $e =10$. По пункту 1 следствия 1 мы имеем $10 = e ≤3v −6=9$, что неверно. 2) Пусть K3,3 планарен. Для этого двудольного графа $v =6$, $e =9$. По пункту 2 следствия 1 мы имеем $9 =e ≤2v −4=8$, что неверно

## Определение 
• Граф $H′$ называется подразбиением графа $H$, если $H′$ может быть получен из $H$ заменой некоторых рёбер на простые пути (каждое заменяемое ребро $xy$ меняется на простой $xy$-путь). При этом, все добавлямые вершины различны и имеют степень 2.
• Вершины $H$ в графе $H′$ называются главными.
• $G ⊃H$ означает, что граф $G$ имеет подграф, изоморфный подразбиению графа $H$
## Следствие 4
 1) Подразбиение графа $H$ планарно, если и только если H планарен.
  2) Любое подразбиение графа $K_5$ или $K_{3,3}$ непланарно.
  ## Доказательство.
   1) Изображение как ребра, так и простого пути — ломаная.
    2) Следует из пункта 1 и Следствия 3.

# Подразбиения $K_5$ и $K_{3,3}$ и стягивание ребра.
## Лемма 7
 Пусть $x,y \in V(G)$, $xy \in E(G)$. Тогда выполняются следующие утверждения. 
 1) Если $G \cdot xy⊃ K_{3,3}$, то $G ⊃ K_{3,3}$.
  2) Если $G \cdot xy ⊃ K_5$, то $G ⊃ K_5 \ или \  G ⊃K_{3,3}$
## Доказательство
• Пусть $w = x \cdot y$, а $H$ — подграф $G\cdot xy$, являющийся подразбиением $K_{3,3} или K_5$.
• Если $w \not\in V(H)$ то, очевидно, $G \supset K_{3,3}$ или $G ⊃ K_5$, соответственно.
• Далее $w \in V(H)$. Построим подграф $H′$ графа $G$ следующим образом: $V(H′) = V(H)$\ $\{w\}\cup\{x,y\}$. Все рёбра из $E(H)$, не инцидентные $w$, включим в $E(H′)$. Для каждого ребра $aw \in E(H)$ включим его в $E(H′)$ то из ребер $ax$ или $ay$, которое есть в графе $G$ (если есть оба этих ребра, возьмем любое из них). Наконец, поместим в $E(H′)$ ребро $xy$.
• Рёбра графа $H′ −xy$, инцидентные вершине $x$, назовем **красными**, а рёбра графа $H′ −xy$, инцидентные вершине $y$ — **синими**. Вместе красных и синих рёбер ровно $d_H(w)$.
• Если в графе $H′$ нет синих рёбер, то $H′ −y$ — подграф графа $G$, изоморфный $H$. Аналогично для красных рёбер. В этом случае доказательство леммы закончено.
• Пусть $ay$ — единственное синее ребро в $H′$. Тогда ребру $aw \in E(H)$ соответствует путь $ayx$ в графе $H′$, то есть, $H′$ является подразбиением графа $H$ (см. рис.а). В этом случае лемма доказана, аналогично для случая, когда есть ровно одно красное ребро.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/13.png?raw=true)
• Пусть теперь и красных, и синих рёбер не менее, чем по два. Тогда $d_H(w) ≥ 4$, откуда сразу же следует, что $H ⊃ K_5$, $d_H(w) = 4$.
• Пусть тогда $z_1,z_2,z_3,z_4$ — четыре оставшиеся главные вершины графа $H$. Каждая пара из вершин $w,z_1,z_2,z_3,z_4$ соединена в $H$ путём — подразбиением соответствующего ребра графа $K_5$. Разные пути не имеют общих внутренних вершин. Этим путям соответствуют пути в графе $H′$.
• НУО в $H′$ есть $xz_1$-путь, $xz_2$-путь, $yz_3$-путь и $yz_4$-путь (см. рис.b). Тогда $H′ ⊃ K_{3,3}$: каждая из вершин $x,z_3,z_4$ соединена путём с каждой из вершин $y,z_1,z_2$, разные пути не имеют общих внутренних вершин
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/14.png?raw=true)

# Теорема Куратовского: трёхсвязность минимального контрпримера.

(K.Kuratowski, 1930) Граф G (возможно, имеющий кратные рёбра и петли) непланарен, если и только если G имеет подграф, являющийся подразбиением $K_5$ или $K_{3,3}$.

## Доказательство.
 $⇐$. Следствие 4.
 $⇒$. • Предположим противное и рассмотрим минимальный контрпример $G$ (непланарный граф, не содержащий подразбиений $K_5$ и $K_{3,3}$).
 • Любой не содержащий подразбиений $K_5$ и $K_{3,3}$ граф с меньшим чем G числом вершин или с таким же, как у $G$ числом вершин и меньшим числом рёбер обязательно является планарным.
 ### Утверждение 1
 $G$ не имеет петель и кратных рёбер.
### Доказательство.
• Пусть $e$ — петля графа $G$. Тогда граф $G −e$ планарен и из его планарности следует планарность графа $G$ (можно дорисовать петлю к плоскому изображению $G −e$).
• Теперь пусть $G$ имеет два кратных ребра $e$ и $f$. Тогда граф $G −e$ планарен и из его планарности следует планарность графа $G$ (можно дорисовать ребро $e$ вдоль ребра $f$ в плоском изображении $G −e$).
### Утверждение 2 
G трехсвязен.

### Доказательство.
 • Если G несвязен, то его компоненты не содержат подразбиений $K_5$ и $K_{3,3}$, а значит, планарны. Тогда планарен и граф $G$, противоречие. 
 • Пусть $G$ имеет точку сочленения $a$. Тогда $G = G_1 \cup G_2$, где $V(G_1) \cap V(G_2) = {a}$. 
• Графы $G_1$ и $G_2$ не содержат подразбиений $K_5$ и $K_{3,3}$, а значит, планарны. 
• Тогда планарен и граф $G$ (можно изобразить $G_1$ и $G_2$ так, чтобы $a$ оказалась на границе внешней грани обоих изображений и склеить их, см. рисунок a). Противоречие.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/15.png?raw=true)
• Наконец, пусть $G$ двусвязен, но имеет разделяющее множество $S = \{a,b\}$. Тогда $G = G_1 \cup G_2$, где $V(G_1) \cap V(G_2) = S$. Пусть $G′_i$ = $G_i +ab$.
• Предположим, что $G^′_1$ содержит подграф $H$ — подразбиение графа $K_5$ или $K_{3,3}$. Так как $H$ не может быть подграфом $G$, $ab \in E(H)$ \ $E(G)$.
• Однако, $G$ содержит $ab$-путь $P$ по вершинам $G_2$. Заменив в $H$ ребро $ab$ на путь $P$, мы получим подразбиение $H′$ графа $H$, являющееся подграфом $G$. Тогда $G$ содержит подразбиение $K_5$ или $K_{3,3}$, что не так.
• Таким образом, $G^′_1$ не содержит подразбиений $K_5$ и $K_{3,3}$, а значит, $G^′_1$ планарен. Аналогично, $G^′_2$ планарен.
• Тогда можно изобразить эти графы на плоскости так, чтобы ребро $ab$ в обоих изображениях лежало в границах внешних граней и склеить эти изображения (см. рис.b). Противоречие.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/16.png?raw=true)
• Вернемся к доказательству теоремы.
• Очевидно, $G \ne K4$. По Теореме 4.9 существует такое ребро $xy \in E(G)$, что граф $G ·xy$ трёхсвязен (Теорема Татта), пусть $w = x ·y$. 
• По [Лемме 7](#лемма-7) мы имеем $G ·xy \not\supset K_5, G ·xy \not\supset K_{3,3}$, следовательно, граф G · xy планарен.
• Пусть $G′ = G ·xy −w ≃G −x −y$ (изоморфность этих двух графов очевидна).
• Рассмотрим плоское изображение графа $G′$, получающееся из изображения $G ·xy$ удалением вершины $w$, пусть $q$ — грань $G^′$, на которой расположена вершина $w$.
• Граф $G^′$ двусвязен, поэтому граница грани $q$ — это простой цикл $Z$.
• Отметим на $Z$ вершины, смежные с $y$ (обозначим их множество через $A$) и пронумеруем их в циклическом порядке: $a_1, a_2,...,a_n$. Из трёхсвязности $G$ следует, что $n ≥ 2$. Пусть $B$— множество вершин цикла $Z$, смежных с $x$.
• Если $A =B$ то $n≥3$ (так как граф $G −A$ в этом случае несвязен), тогда $G$ содержит подразбиение $K_5$ с главными вершинами $x,y,a_1,a_2,a_3$, противоречие. 
• Далее НУО $B \not\subset A$ пусть вершина $b \in B$\ $A$ лежит на дуге $L =a_1Za_2$, не содержащей других вершин из $A$.
• Предположим, что вершина $b^′ \in B$ не лежит на $L$ (возможно, $b^′$ совпадает с одной из вершин множества $A$, но $b^′ \not\in \{a_1,a_2\})$.
• Тогда циклический порядок вершин $a_1,b,a_2,b^′$ на $Z$ именно такой, а значит, $G$ содержит подразбиение $K_{3,3}$ с главными вершинами $x,a_1,a_2$ (одна доля) и $y,b,b^′$ (вторая доля), противоречие (см. рис.a).
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/17.png?raw=true)
• Остается случай, когда все вершины множества $B$ лежат на дуге $L$ (возможно, совпадают с $a_1$ или $a_2$).
• В этом случае рассмотрим исходное плоское изображение графа $G ·xy$ и удалим с него все ребра от $w$ до вершин из $B$ \ $A$ (см. рис.b).
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/18.png?raw=true)
• Ребра от $A$ до $w$ делят грань $q$ на $n$ граней, одна из них — грань $d$, ограниченная $L$ и ребрами $wa_1$, $wa_2$.
• Мы можем изобразить внутри $d$ вершину $x$ и соединить ее ребрами с $w$ и вершинами из $B$, не нарушая планарности (см. рис.c). Для построения плоского изображения $G$ остается только переименовать $w$ в $y$.

# Триангуляция графа.
## Триангуляции  
## Определение 
1) Будем называть грань треугольником, если ее граница — это треугольник.
 2) Плоский граф называется триангуляцией, если каждая его грань — треугольник. Кратные рёбра и петли запрещены. 
 3) Триангулировать плоский граф значит провести в нём дополнительные рёбра так, чтобы получилась триангуляция
• По [Лемме 5](#лемма-5) триангуляция — двусвязный граф. Тк границы граней - простые циклы

## Лемма 8
Пусть $G$ — плоский граф без петель, $v(G) ≥ 3$, никакие два кратных ребра не образуют грань. Тогда $G$ можно триангулировать без появления новых пар кратных ребер.
## Доказательство. 
• Пусть G — не триангуляция. Тогда $G$ имеет грань $d$, не являющуюся треугольником. Пусть $H$ = $G(V_d)$.
• По [Лемме 1](#лемма-1) любые две вершины из $V_d$ можно соединить ломаной в d, эта ломаная не будет пересекать ребер графа G.
• Значит, если граф $H$ неполный, то мы можем добавить в него ребро без образования новых пар кратных ребер.
• Пусть $H = K_m$. Так как $|V_d| ≥ 3$ и граф H планарен, $m∈\{3,4\}$.
• Если граница $B(d)$ грани $d$ недвусвязна, то ее точка сочленения по [Лемме 5](#лемма-5) — точка сочленения графа $G$, но это невозможно в случае, когда $V_d$ — клика.
• Следовательно, B(d) — двусвязный граф, а значит, это простой цикл.
• Так как $B(d)$ — не треугольник, это цикл длины 4. Тогда две диагонали этого цикла проведены вне грани $f$, что, очевидно, невозможно: такие диагонали пересекут друг друга (см. рисунок).
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/19.png?raw=true)
• Пусть у триангуляции $T$ $2n$ граней, тогда у нее $3n$ рёбер. По формуле Эйлера $v = n+2$. Тогда $e(T) = 3v(T)−6$.
• Мы знаем, что для любого плоского графа $G$ выполнено $e(G) ≤ 3v(G)−6$. Таким образом, триангуляция — максимальный плоский граф, в котором нельзя дорисовать без пересечений ни одного нового ребра
# Существование в триангуляции ребра, входящего ровно в два треугольника.
## Лемма 9 
В любой триангуляции $T$ с $v(T) ≥ 4$ есть ребро $e$, входящее ровно в два треугольника — в две грани, граничащие по $e$.
## Доказательство.
 • Любое ребро $f \in E(T)$ входит в две грани, и эти грани граничат только по $f$ (иначе в $T$ есть пара кратных рёбер). Значит, нам достаточно найти ребро $e$, не входящее в разделяющий треугольник — такой, что в обеих частях плоскости относительно него есть вершины графа.
 • Если в $T$ нет разделяющего треугольника, то утверждение очевидно — нам подойдет любое ребро.
 • Предположим, что разделяющие треугольники есть и рассмотрим такой разделяющий треугольник $abc$, что внутри него нет других разделяющих треугольников.
 • Однако, внутри $abc$ есть вершины, а значит, есть и ребро $e$. Тогда ребро $e$ не может входит в разделяющий треугольник, так как такой треугольник содержался бы внутри $abc$, что противоречит выбору $abc$.
# Теорема Вагнера о выпрямлении изображения планарного графа.
## Теорема 5 
**(K.Wagner, 1936.)** Пусть G — планарный граф без кратных рёбер. Тогда существует плоское изображение G, в котором все рёбра– отрезки.

## Доказательство.
• Будем доказывать утверждение индукцией по количеству вершин графа, база для графа на одной вершине очевидна.

• Достаточно доказать теорему для случая, когда G — триангуляция, так как по [Лемме 8](#лемма-8) любой граф можно триангулировать без появления кратных рёбер. Будем доказывать, что можно выпрямить триангуляцию, тогда будет выпрямлен и исходный граф.
• По [Лемме 9](#лемма-9) выберем ребро $e = uv ∈ E(G)$ так, чтобы оно входило ровно в два треугольника — грани $xuv$ и $yuv$.
• Тогда $G^′ = G ·uv$ — триангуляция с плоским изображением, в котором “сжаты” грани $xuv$ и $yuv$, а остальные грани — такие же, как в $G$. Кратных рёбер в $G^′$ нет.
• По индукционному предположению, существует изображение $G^′$ с прямыми рёбрами. Далее рассматриваем его.
• Упорядочим вершины из $N_G(u)$ в порядке выхода их рёбер из $u$ по часовой стрелке: $x,v,y,a_1,...,a_k$. Так как $G$– триангуляция, любые две соседние в этом порядке вершины вместе с $u$ образуют треугольную грань.
• Упорядочим вершины из $N_G(v)$ в порядке выхода их рёбер из $v$ по часовой стрелке: $y,u,x,b_1,...,b_m$. Так как $G$– триангуляция, любые две соседние в этом порядке вершины вместе с v образуют треугольную грань.
• Тогда в графе $G^′$ вершины из $N_{G^′}(w)$ будут упорядочены по часовой стрелке в порядке выходов рёбер из $w$ так: $y,a_1,...,a_k,x,b_1,...,b_m$ (рис.a). Любые две соседние (по выходу ребра из $w$) вершины образуют вместе с $w$ треугольную грань.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/20.png?raw=true)
• Найдем минимум расстояний между вершинами в $G^′$, а также минимум расстояний от вершин до не инцидентных им рёбер (напомним, что рёбра — это отрезки). Пусть $d$ — наименьший из этих минимумов. Очевидно, $d > 0$.
• Проведем окружность $S$ радиуса $\delta = \frac{d}{2}$ с центром $w$. Понятно, что внутри $S$ вершин графа $G^′$ нет и пересекают эту окружность только рёбра с концом в $w$.
• Ломаная $xwy$ делит многоугольник $P =ya_1...a_kxb_1...b_m$ на два многоугольника: $P_a$, содержащий $a_1,...,a_k$ и $P_b$, содержащий $b_1,...,b_m$.
• Проведем диаметр $uv$ окружности $S$ так, чтобы $x$ и $y$ лежали по разную сторону от соответствующей прямой и $u$ лежала в $P_a$ (тогда $v$ лежит в $P_b$, см. рис.b).
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/22.png?raw=true)
• Удалим все рёбра, инцидентные $w$, из графа. Теперь проведем отрезки от $u$ до $x$, $y$, $a_1,..., a_k$ и от $v$ до $x$, $y$, $b_1,. . . , b_m$ (см. рис.b). Очевидно, никакие два проведенных отрезка не пересекают друг друга. 
• Остается доказать, что проведенные отрезки не пересекают других рёбер графа $G$.
• Пусть, скажем, ребро $us$ пересекает какое-то другое ребро $e$ (см. рис.c). Стороны $sw$ и $wu$ треугольника $swu$ не могут пересекать $e$. Следовательно, один из концов $e$ — назовем его $t$ — лежит в треугольнике $swu$. Но тогда $t$ лежит в треугольнике $swu$ и расстояние от $t$ до отрезка $sw$, очевидно, меньше $|uw|= \frac{d}{2}$, противоречие.

# Лемма о соединении точки на грани с “серединами” рёбер.

## Лемма 10
 Пусть $G$ — связный плоский граф, $d ∈ F(G)$, Пусть $k =b(d)$, а $e_1...e_k$ — рёбра из $E_d$ в порядке циклического обхода $Z(d)$ (нумерация — циклическая по модулю k, внутренние рёбра грани $d$ встречаются в этой нумерации дважды). Отметим точку $d^∗$ на грани d и по точке $s_i$ на каждом ребре $e_i$. Тогда в грани $d$ можно провести ломаные $L_1, ...,L_k$ без общих внутренних точек, соединяющие $d^∗$ с $s_1, . . . , s_k$ соответственно. При этом, циклический порядок выходов ломаных в точке $d^∗$ будет $L_1,...,L_k$ (см. рис.a).
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/23.png?raw=true)
 
 ## Доказательство.
 Рассмотрим отдельно от всего графа грань $d$ и добавим вершины $s_1,...,s_k,d^∗$.
 • Внутреннюю точку $d^∗$ грани $d$ можно соединить ломаной $L_1$ в грани $d$ с точкой $s_1$ на границе грани. Далее пусть $k ≥ 2.$
 • Так как добавленное ребро $L_1 = d^∗s_1$ — мост, это внутреннее ребро полученной грани $d_0$, в границу которой добавилась вершина $d^∗$.
 • Пусть $v_{i,i+1}$ — вершина, в которой обход $Z(d)$ переходит с ребра $e_i$ на ребро $e_i+1$.
• Докажем индукцией по $2 ≤ ℓ ≤ k$, что можно провести в грани $d$ описанные выше ломаные $L_1,L_2,...,L_ℓ$ так, что грань $d$ будет разбита на грани $d_{1,2},...,d_{ℓ,1}$, причем границу $d_{i,i+1}$ образуют ломаные $L_i$ и $L_{i+1}$, а также участок циклического обхода $Z(d)$ между $s_i$ и $s_{i+1}$, содержащий $v_{i,i+1}$. Границу грани $d_{ℓ,1}$ образуют ломаные $L_i$ и $L_1$, а также участок циклического обхода $Z(d)$ между $s_ℓ$ и $s_1$, содержащий $v_{ℓ,ℓ+1}$.

### База 
для $ℓ = 2$ очевидна — в грани $d_0$ можно провести ломаную $L_2$, соединяющую граничные точки $d^∗$ и $s_2$. В результате ломаная $L_2L_1$ разобьет $d$ на две части $d_{1,2}$ и $d_{2,1}$, очевидно, обладающие нужными свойствами. 
### Переход ℓ → ℓ+1. 
Рассмотрим грань $d_{ℓ,1}$. На ее границе лежат точки $d^∗$ и $s_{ℓ+1}$, которые можно соединить в грани $d_{ℓ,1}$ ломаной $L_{i+1}$ (см. рис.b). В результате грань $d_{ℓ,1}$ будет разбита этой ломаной на две грани $d_{ℓ,ℓ+1}$ и $d_{ℓ+1,1}$ с нужными свойствами.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/dm_graph/planar/24.png?raw=true)