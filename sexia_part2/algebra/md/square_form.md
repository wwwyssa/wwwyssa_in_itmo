# Алгебра. Глава 9. Квадратичные формы и скалярное произведение

# Квадратичные формы. Матрицы квадратичной формы в разных базисах.

## Квадратичные формы

- Здесь и далее $K$ — поле характеристики не $2$ (то есть, $2 \ne 0$ в поле $K$).
- Мы будем иметь дело с линейным пространством $V$ над $K$ с базисом $\{e_1, \ldots, e_n\}$.
- Элементы $V$ будут записываться как столбцы координат в этом базисе: $X = (x_1, \ldots, x_n)^T$.

### Определение

- Функция $f : V \to K$, заданная формулой
  $$
  f((x_1, \ldots, x_n)^T) = \sum_{i=1}^n a_{i,i} x_i^2 + \sum_{1 \leq i < j \leq n} 2a_{i,j}x_i x_j,
  $$
  где все коэффициенты $a_{i,j} \in K$, называется **квадратичной формой**.

- Зачем в определении фигурирует $2a_{i,j}x_i x_j$ при $i \neq j$?
  - Для того, чтобы была возможность расписать этот член как $a_{i,j}x_i x_j + a_{j,i}x_j x_i$, где $a_{i,j} = a_{j,i}$.


- Рассмотрим симметричную матрицу $A = (a_{i,j})_{i,j \in \{1, \ldots, n\}} \in M_n(K)$ (то есть, удовлетворяющую условию $a_{i,j} = a_{j,i}$ для всех пар индексов) и вектор $X = (x_1, \ldots, x_n)^T$.
- Тогда значение квадратичной формы $f$ на векторе $X$ может быть переписано как $f(X) = X^T A X$.
- Матрица $A$ называется **матрицей квадратичной формы $f$.**

### Замена базиса

- Как меняется матрица квадратичной формы при замене базиса $V$?
  - Пусть базис $\{e_1, \ldots, e_n\}$ меняется на $\{e'_1, \ldots, e'_n\}$, в котором координаты записываются как $X' = (x'_1, \ldots, x'_n)^T$ (мы считаем, что столбец координат без штрихов в старом базисе соответствует столбцу со штрихами в новом), а матрица квадратичной формы $f$ обозначается $A'$.
  - Это означает, что квадратичная форма $f$ в исходном базисе записывается как $X^T A X$, а в новом базисе — как $(X')^T A' X'$.

- Как нам известно, изменение координат при замене базиса делается умножением на матрицу перехода.
  - Пусть $C$ — матрица перехода от $\{e'_1, \ldots, e'_n\}$ к $\{e_1, \ldots, e_n\}$.
  - Тогда $X = C X'$ и
    $$
    X^T A X = (C X')^T A (C X') = (X')^T (C^T A C) X'.
    $$
  - Следовательно, $A' = C^T A C$.

# Приведение квадратичной формы к диагональному виду.


## Определение
- Квадратичная форма имеет диагональный вид, если она записывается $f(x_1, \dots, x_n) = \sum_{i=1}^n a_i x_i^2$, то есть, её матрица — диагональная.
- Привести квадратичную форму к диагональному виду значит найти такой базис, в котором эта форма имеет диагональный вид.

## Теорема 1
- Любую квадратичную форму $f : V \to K$ можно привести к диагональному виду.

#### Доказательство
- Индукция по количеству переменных $n$.
- База $n = 1$ очевидна. Также утверждение очевидно в случае, когда все коэффициенты квадратичной формы равны $0$ (такая форма уже имеет диагональный вид).
- Пусть $n > 1$, для меньшего числа переменных теорема доказана, и мы рассматриваем в базисе $e_1, \dots, e_n$ квадратичную форму:
  $$
  f((x_1, \dots, x_n)^T) = \sum_{i=1}^n a_{i,i} x_i^2 + \sum_{1 \leq i < j \leq n} 2a_{i,j}x_i x_j,
  $$
  имеющую хотя бы один ненулевой коэффициент.

#### Случай 1: $a_{i,i} \neq 0$ для $i \in \{1, \dots, n\}$
- Пусть $i = 1$. Рассмотрим члены $f$, содержащие $x_1$:
  $$
  a_{1,1}x_1^2 + 2a_{1,2}x_1x_2 + \dots + 2a_{1,n}x_1x_n = a_{1,1}(x_1 + \frac{a_{1,2}}{a_{1,1}}x_2 + \dots + \frac{a_{1,n}}{a_{1,1}}x_n)^2 - a_{1,1} \sum_{i=2}^n \frac{a_{1,i}}{a_{1,1}}x_i^2.
  $$
- Построим новый базис $e'_1 = e_1$ и $e'_i = e_i - \frac{a_{1,i}}{a_{1,1}}e_1$ при $i \in \{2, \dots, n\}$. (Очевидно, вектора $e'_1, \dots, e'_n$ — линейно независимы, а значит, образуют базис $n$-мерного пространства.)
- Тогда вектор $(x_1, \dots, x_n)^T$ в исходном базисе в новом базисе имеет вид $(x'_1, x'_2, \dots, x'_n)^T$, где:
  $$
  x'_1 = x_1 + \frac{a_{1,2}}{a_{1,1}}x_2 + \dots + \frac{a_{1,n}}{a_{1,1}}x_n, \quad x'_i = x_i \text{ при } i \in \{2, \dots, n\}.
  $$
- Поэтому, ввиду вышеуказанного преобразования, получаем:
  $$
  f(x_1, \dots, x_n) = a_{1,1}(x'_1)^2 + g(x'_2, \dots, x'_n),
  $$
  где $g$ — квадратичная форма, которую можно привести к диагональному виду по индукционному предположению.
- Сделаем это и оставим без изменений базисный вектор $e'_1$, в результате получится базис, в котором $f$ имеет диагональный вид.

#### Случай 2: все коэффициенты $a_{i,i} = 0$
- Но есть ненулевой коэффициент — тогда, не умаляя общности, можно считать, что $a_{1,2} \neq 0$.
- Рассмотрим новый базис, в котором изменён только первый вектор: $e'_1, e_2, e_3, \dots, e_n$, причём $e'_1 = e_1 - e_2$.
- Нетрудно понять, что вектор с координатами $(x_1, \dots, x_n)^T$ в исходном базисе в новом базисе имеет вид $(x'_1, x'_2, \dots, x'_n)^T$, где:
  $$
  x'_2 = x_2 + x_1, \quad x'_i = x_i \text{ при } i \neq 2.
  $$
- Одночлен $2a_{1,2}x_1x_2 = 2a_{1,2}x'_1(x'_2 - x'_1)$ в новом базисе содержит $-2a_{1,2}(x'_1)^2$.
- В других одночленах $(x'_1)^2$ появиться не может, поэтому мы получаем $a'_{1,1} = -2a_{1,2} \neq 0$ и попадаем в разобранный выше случай 1.

# Закон инерции квадратичных форм.
## Вещественные квадратичные формы

- В этом разделе мы рассмотрим вещественные квадратичные формы, то есть, случай $K = \mathbb{R}$.
- Вещественные числа в первую очередь хороши тем, что на них есть отношение порядка больше-меньше.
- Следующую теорему называют **законом инерции квадратичных форм** .

### Теорема 2
- Пусть $f((x_1, \dots, x_n)^T)$ — вещественная квадратичная форма, которая двумя способами приведена к диагональному виду:
  $$
  g((y_1, \dots, y_n)^T) = \sum_{i=1}^n a_i y_i^2, \quad h((z_1, \dots, z_n)^T) = \sum_{i=1}^n b_i z_i^2.
  $$
- Тогда среди $a_1, \dots, a_n$ и $b_1, \dots, b_n$ поровну положительных коэффициентов. Также среди $a_1, \dots, a_n$ и $b_1, \dots, b_n$ поровну отрицательных коэффициентов, а значит, и поровну нулевых коэффициентов.

### Доказательство
- Достаточно доказать равенство количеств положительных коэффициентов. Утверждение для отрицательных коэффициентов доказывается аналогично, после чего утверждение для нулевых выводится.
- Предположим противное, пусть, скажем, у $g$ положительных коэффициентов меньше, чем у $h$.
- Можно занумеровать коэффициенты так, чтобы $a_1, \dots, a_p > 0$, $b_1, \dots, b_{p+q} > 0$, а все остальные коэффициенты не превосходили $0$.
- По определению, диагональный вид квадратичной формы — это её запись в другом базисе, то есть, существуют такие невырожденные матрицы перехода $C, D \in M_n(\mathbb{R})$, что:
  $$
  f((x_1, \dots, x_n)^T) = a_1 y_1^2 + \dots + a_n y_n^2 = b_1 z_1^2 + \dots + b_n z_n^2,
  $$
  где $(y_1, \dots, y_n)^T = C(x_1, \dots, x_n)^T$, $(z_1, \dots, z_n)^T = D(x_1, \dots, x_n)^T$.
- Попробуем подобрать такой ненулевой вектор $(x_1, \dots, x_n)^T$, что для него $y_1 = \dots = y_p = z_{p+q+1} = \dots = z_n = 0$.
- Равенство нулю каждой координаты — это линейное уравнение на $x_1, \dots, x_n$, вместе получаем ОСЛУ с переменными $x_1, \dots, x_n$:
  $$
  \begin{cases}
  y_1 = c_{1,1}x_1 + c_{1,2}x_2 + \dots + c_{1,n}x_n = 0, \\
  \dots \\
  y_p = c_{p,1}x_1 + c_{p,2}x_2 + \dots + c_{p,n}x_n = 0, \\
  z_{p+q+1} = d_{p+q+1,1}x_1 + d_{p+q+1,2}x_2 + \dots + d_{p+q+1,n}x_n = 0, \\
  \dots \\
  z_n = d_{n,1}x_1 + d_{n,2}x_2 + \dots + d_{n,n}x_n = 0.
  \end{cases}
  $$
- Значит, существует ненулевое решение — вектор $x_0$, которому соответствуют:
  $$
  Cx_0 = y_0 = (0, \dots, 0, y_{p+1}, \dots, y_n), \quad Dx_0 = z_0 = (z_1, \dots, z_{p+q}, 0, \dots, 0).
  $$
- Тогда:
  $$
  f(x_0) = \sum_{i=p+1}^n a_i y_i^2 \leq 0, \quad f(x_0) = \sum_{i=1}^{p+q} b_i z_i^2 \geq 0,
  $$
  откуда следует, что $f(x_0) = 0$ и $z_1 = \dots = z_{p+q} = 0$.
- Таким образом, $z_0 = 0$, а это значит, что $D \cdot x_0 = 0$ для $x_0 \neq 0$, что для невырожденной матрицы $D$ невозможно. Противоречие.

# Положительно определенные квадратичные формы.

## Положительно определенные квадратичные формы

- Пусть $V$ — линейное пространство над $\mathbb{R}$.

### Определение
- Вещественная квадратичная форма $f : V \to \mathbb{R}$ называется **положительно определенной**, если для любого $x \in V$, $x \neq 0$, мы имеем $f(x) > 0$.
- На всякий случай заметим, что для квадратичной формы всегда выполнено $f(0) = f((0, \dots, 0)^T) = 0$.

## Теорема 3
- Пусть положительно определенная квадратичная форма $f : \mathbb{R}^n \to \mathbb{R}$ приведена к диагональному виду $a_1y_1^2 + \dots + a_ny_n^2$. Тогда все коэффициенты $a_1, \dots, a_n$ положительны.

### Доказательство
- Пусть это не так и, скажем, $a_1, \dots, a_p > 0$, $a_{p+1}, \dots, a_n \leq 0$, $p < n$.
- По определению, диагональный вид квадратичной формы — это её запись в другом базисе.
- Это означает, что существует такая невырожденная матрица перехода $C \in M_n(\mathbb{R})$, что:
  $$
  f((y_1, \dots, y_n)^T) = a_1y_1^2 + \dots + a_ny_n^2, \quad (y_1, \dots, y_n)^T = C(x_1, \dots, x_n)^T.
  $$
- Попробуем подобрать такой ненулевой вектор $(x_1, \dots, x_n)^T$, что для него $y_1 = \dots = y_p = 0$.
- Получаем ОСЛУ:
  $$
  \begin{cases}
  y_1 = c_{1,1}x_1 + c_{1,2}x_2 + \dots + c_{1,n}x_n = 0, \\
  \dots \\
  y_p = c_{p,1}x_1 + c_{p,2}x_2 + \dots + c_{p,n}x_n = 0.
  \end{cases}
  $$
- В этой ОСЛУ $n$ переменных и $p < n$ уравнений, а значит, существует ненулевое решение — вектор $x_0$.
- Так как матрица $C$ невырождена, вектор $Cx_0 = y_0 = (0, \dots, 0, y_{p+1}, \dots, y_n)$ не равен $0$.
- Тогда:
  $$
  f(x_0) = \sum_{i=1}^n a_i y_i^2 = \sum_{i=p+1}^n a_i y_i^2 \leq 0,
  $$
  что противоречит положительной определенности $f$.

# Кривые второго порядка на плоскости.
## Кривые второго порядка на плоскости

### Определение
- Кривая второго порядка — это все точки $(x, y) \in \mathbb{R}^2$, являющиеся решением уравнения:
  $$
  a'x^2 + b'y^2 + c'xy + d'x + e'y = f',
  $$
  где коэффициенты $a', b', c', d', e', f' \in \mathbb{R}$, среди которых $a', b', c'$ есть ненулевые.

### Уменьшение числа ненулевых коэффициентов
- Невырожденной заменой координат можно привести квадратичную форму $a'x^2 + b'y^2 + c'xy$ к диагональному виду (при этом изменятся коэффициенты $d', e', f'$).
- Таким образом, достаточно рассматривать уравнения вида:
  $$
  ax^2 + by^2 + c''x + e''y = f''.
  $$
- Легко видеть, что хотя бы один из коэффициентов $a, b$ не равен $0$.
- Вне зависимости от способа приведения квадратичной формы к диагональному виду, количество положительных, отрицательных и нулевых коэффициентов среди $a$ и $b$ по закону инерции будет одним и тем же.

### Случай 1: Коэффициенты $a, b$ одного знака
- Пусть $a > 0$ и $b > 0$ (иначе умножим уравнение на $-1$).
- Уравнение:
  $$
  ax^2 + by^2 + e''x + d''y = f'' \implies a\left(x + \frac{d''}{2a}\right)^2 + b\left(y + \frac{e''}{2b}\right)^2 = f'' - \frac{(d'')^2}{4a} - \frac{(e'')^2}{4b}.
  $$
- После замены переменных получится уравнение вида:
  $$
  ax^2 + by^2 = f.
  $$
- При $f < 0$ уравнение не имеет решений.
- При $f = 0$ единственное решение — точка $(0, 0)$.
- При $f > 0$ получаем кривую на плоскости, которая называется эллипсом.
- От исходной системы координат на плоскости мы перешли к итоговой с помощью обратимого линейного оператора (замены базиса) и параллельного переноса на вектор $\left(\frac{d''}{2a}, \frac{e''}{2b}\right)$.

### Случай 2: Коэффициенты $a, b$ разных знаков
- Пусть $a > 0$ и $b < 0$ (иначе умножим уравнение на $-1$).
- Аналогично случаю 1, заменой переменных уравнение приводится к виду:
  $$
  ax^2 + by^2 = f.
  $$
- Поделим $x$ на $\sqrt{a}$, а $y$ на $\sqrt{-b}$ и получим в новых координатах уравнение:
  $$
  x^2 - y^2 = f.
  $$
- При $f = 0$ решение этого уравнения — две прямые $x = y$ и $x = -y$.
- При $f \neq 0$ сделаем еще одну невырожденную замену переменных: $x' := x + y$, $y' := x - y$ и получим уравнение:
  $$
  x'y' = f.
  $$
- Такая кривая на плоскости называется гиперболой.

### Случай 3: Один из коэффициентов $a, b$ равен $0$
- Пусть $a > 0$ и $b = 0$ (иначе переобозначим переменные и при необходимости умножим уравнение на $-1$).
- Уравнение:
  $$
  ax^2 + d'x + e'y = f'.
  $$
- Аналогично случаю 1, заменой переменных уравнение приводится к виду:
  $$
  dy = ax^2 + f.
  $$
- При $d = 0$ уравнение задает на плоскости параболу.
- При $d \neq 0$ решение:
  - $ax^2 = -f$. При $f > 0$ решений нет, при $f = 0$ решения — прямая $x = 0$, а при $f < 0$ — две параллельные прямые $x = \sqrt{-f}$ и $x = -\sqrt{-f}$.\
 - От исходной системы координат на плоскости мы перешли к итоговой с помощью обратимых линейных операторов и параллельного переноса. 
 -  Эти преобразования плоскости обратимы и переводят прямую в прямую, а параллельные прямые– в параллельные прямые. 
 -  Поэтому в случаях, когда получается прямая или две параллельные прямые или когда нет решений, то же самое получается и в исходных координатах.

# Вещественное и комплексное скалярное произведение. Свойства. Матрица Грама
## Вещественное скалярное произведение

### Определение
- Пусть $V$ — линейное пространство над $\mathbb{R}$, а отображение $( , ) : V \times V \to \mathbb{R}$ удовлетворяет следующим условиям:
  1. $(\alpha x + \beta y, z) = \alpha (x, z) + \beta (y, z)$ для любых $\alpha, \beta \in \mathbb{R}$ и $x, y, z \in V$;
  2. $(x, y) = (y, x)$ для любых $x, y \in V$;
  3. $(x, x) > 0$ для любого $x \in V$, отличного от $0$.
- Тогда $( , )$ называется вещественным скалярным произведением, а $V$ — пространством со скалярным произведением, или Евклидовым пространством.

## Комплексное скалярное произведение

### Определение
- Пусть $V$ — линейное пространство над $\mathbb{C}$, а отображение $( , ) : V \times V \to \mathbb{C}$ удовлетворяет следующим условиям:
  1. $(\alpha x + \beta y, z) = \alpha (x, z) + \beta (y, z)$ для любых $\alpha, \beta \in \mathbb{C}$ и $x, y, z \in V$;
  2. $(x, y) = \overline{(y, x)}$ для любых $x, y \in V$;
  3. Для любого $x \in V$, отличного от $0$, число $(x, x)$ — вещественное и положительное.
- Тогда $( , )$ называется комплексным скалярным произведением, а $V$ — пространством со скалярным произведением, или Эрмитовым пространством.

### Свойство 1
- Пусть $V$ — пространство со скалярным произведением над $\mathbb{C}$. Тогда:
  $$
  (z, \alpha x + \beta y) = \alpha (z, x) + \beta (z, y)
  $$
  для любых $\alpha, \beta \in \mathbb{C}$ и $x, y, z \in V$.

#### Доказательство
- $(z, \alpha x + \beta y) = \overline{(\alpha x + \beta y, z)} = \overline{\alpha (x, z) + \beta (y, z)} = \overline{\alpha} \cdot \overline{(x, z)} + \overline{\beta} \cdot \overline{(y, z)} = \overline{\alpha} (z, x) + \overline{\beta} (z, y)$.

### Свойство 2
- Пусть $V$ — пространство со скалярным произведением над $K$, $x \in V$. Тогда:
  $$
  (0, x) = (x, 0) = 0
  $$
  для любого $x \in V$.

#### Доказательство
- Ввиду определения, нам достаточно доказать, что $(0, x) = 0$. Это очевидно следует из:
  $$
  (0, x) = (0 + 0, x) = (0, x) + (0, x).
  $$
## Определение
- Пусть $K \in \{\mathbb{C}, \mathbb{R}\}$, $V$ — пространство со скалярным произведением над $K$, а $e_1, \dots, e_n$ — базис $V$.
- **Матрица Грама** базиса $e_1, \dots, e_n$ — это матрица $G = (g_{i,j})_{i,j \in \{1, \dots, n\}}$, где $g_{i,j} = (e_i, e_j)$.

### Свойства матрицы Грама
- Непосредственно из определений можно вывести свойства матрицы Грама.

#### Свойство 3
- Пусть $V$ — пространство со скалярным произведением над $K$. Тогда на главной диагонали матрицы Грама стоят положительные вещественные коэффициенты.

#### Свойство 4
- Пусть $V$ — пространство со скалярным произведением над $\mathbb{R}$. Тогда матрица Грама симметрична (то есть, $G^T = G$).

#### Свойство 5
- Пусть $V$ — пространство со скалярным произведением над $\mathbb{C}$. Тогда $G^T = \overline{G}$ (то есть, $g_{i,j} = \overline{g_{j,i}}$).

# Неравенство Коши-Буняковского-Шварца.
## Неравенство Коши-Буняковского-Шварца над $\mathbb{R}$

### Теорема 4
- Пусть $V$ — пространство со скалярным произведением над $\mathbb{R}$, $x, y \in V$. Тогда:
  $$
  (x, y)^2 \leq (x, x) \cdot (y, y).
  $$

### Доказательство
- По определению вещественного скалярного произведения, для любого $\lambda \in \mathbb{R}$:
  $$
  0 \leq (\lambda x - y, \lambda x - y) = \lambda^2 (x, x) - 2\lambda (x, y) + (y, y).
  $$
- При фиксированных $x$ и $y$ мы имеем квадратный трехчлен относительно $\lambda$, у которого, очевидно, не более одного корня, а значит, его дискриминант неположителен:
  $$
  4(x, y)^2 - 4(x, x)(y, y) \leq 0,
  $$
  откуда следует доказываемое неравенство.

## Неравенство Коши-Буняковского-Шварца над $\mathbb{C}$

### Теорема 5
- Пусть $V$ — пространство со скалярным произведением над $\mathbb{C}$, $x, y \in V$. Тогда:
  $$
  |(x, y)|^2 \leq (x, x) \cdot (y, y).
  $$

### Доказательство
- Пусть $(x, y) = |(x, y)| e^{i\varphi}$.
- Тогда $\overline{(x, y)} = |(x, y)| e^{-i\varphi}$.
- По определению комплексного скалярного произведения и сказанному выше, для любого $t \in \mathbb{R}$:
  $$
  0 \leq (tx + e^{i\varphi}y, tx + e^{i\varphi}y) = (tx, tx) + (e^{i\varphi}y, tx) + (tx, e^{i\varphi}y) + (e^{i\varphi}y, e^{i\varphi}y).
  $$
- Раскрывая скобки:
  $$
  t^2(x, x) + t \cdot ((e^{i\varphi}y, x) + (x, e^{i\varphi}y)) + e^{i\varphi}\cdot \overline{e^{i\varphi}}(y, y). =\\t^2(x,x)+t\cdot(e^{i\varphi}\overline{(x,y)}+\overline{e^{i\varphi}}(x,y))+N(e^{i\varphi})(y,y)=\\t^2(x,x)+t\cdot(e^{i\varphi}e^{-i\varphi}|(x,y)|+e^{-i\varphi}e^{i\varphi}|(x,y)|)+(y,y)=\\t^2(x,x)+2t|(x,y)|+(y,y)
  $$
- При фиксированных $x$ и $y$ мы имеем квадратный трехчлен относительно $t$, у которого, очевидно, не более одного корня, а значит, его дискриминант неположителен:
  $$
  4 |(x, y)|^2 - 4(x, x)(y, y) \leq 0,
  $$
  откуда следует доказываемое неравенство.

# Длина вектора.
## Длина вектора

### Определение
- Пусть $K \in \{\mathbb{C}, \mathbb{R}\}$, $V$ — пространство со скалярным произведением над $K$, $x \in V$. Длина вектора $x$ — это:
  $$
  \|x\| := \sqrt{(x, x)}.
  $$
- Длина ненулевого вектора — положительное вещественное число.

### Свойство 1
- Если $\lambda \in K$, то:
  $$
  \|\lambda x\| = |\lambda| \cdot \|x\|.
  $$

#### Доказательство
- При $K = \mathbb{R}$ считаем, что $\lambda = \overline{\lambda}$:
  $$
  \|\lambda x\| = (\lambda x, \lambda x) = \lambda \cdot \overline{\lambda} \cdot (x, x) = |\lambda|^2 \cdot (x, x) = |\lambda| \cdot \|x\|.
  $$

### Свойство 2
- Если $x, y \in V$, то:
  $$
  \|x + y\| \leq \|x\| + \|y\|.
  $$

#### Доказательство
- $\|x + y\|^2 = (x + y, x + y) = (x, x) + (y, y) + (x, y) + (y, x)$.
- При $K = \mathbb{R}$ по [Теореме 4](#теорема-4) (Нер-во КБШ) имеем $(x, y) = (y, x) \leq \|x\| \cdot \|y\|$, и продолжаем:
  $$
  \|x + y\|^2 \leq \|x\|^2 + \|y\|^2 + 2\|x\| \cdot \|y\| = (\|x\| + \|y\|)^2,
  $$
  откуда следует доказываемое неравенство.
- При $K = \mathbb{C}$ по Теореме 5 имеем:
  $$
  (x, y) + (y, x) = 2\operatorname{Re}((x, y)) \leq 2|(x, y)| \leq 2\|x\| \cdot \|y\|,
  $$
  и продолжаем точно так же, как в вещественном случае.

### Свойство 3
- (Неравенство треугольника). Если $x, y, z \in V$, то:
  $$
  \|x - y\| \leq \|x - z\| + \|z - y\|.
  $$

#### Доказательство
- Так как $x - y = (x - z) + (z - y)$, утверждение следует из Свойства 2.

# Ортогональный и ортонормированный базиc. Вычисление скалярного произведения.

## Ортогональный и ортонормированный базис

### Определение
- Пусть $K \in \{\mathbb{R}, \mathbb{C}\}$, а $V$ — пространство со скалярным произведением.
- Пусть $e_1, \dots, e_n$ — базис $V$.
  1. Базис называется **ортогональным**, если его матрица Грама диагональна, и **ортонормированным**, если его матрица Грама равна $E_n$.
  2. Векторы $x, y \in V$ называются ортогональными, если $(x, y) = 0$.
- Ортогональность базиса эквивалентна тому, что $(e_i, e_j) = 0$ при $i \neq j$ (то есть, любые два различных базисных вектора ортогональны).
- Базис является ортонормированным, если и только если он ортогональный и $(e_i, e_i) = 1$ для каждого базисного вектора.

### Свойство 1
- Пусть $V$ — пространство со скалярным произведением над $\mathbb{R}$, $e_1, \dots, e_n$ — ортонормированный базис $V$, $x, y \in V$, причем $x = (x_1, \dots, x_n)^T$ и $y = (y_1, \dots, y_n)^T$ — координаты векторов в указанном базисе. Тогда:
  $$
  (x, y) = \sum_{i=1}^n x_i y_i.
  $$

#### Доказательство
- $(x, y) = \left(\sum_{i=1}^n x_i e_i, \sum_{j=1}^n y_j e_j\right) = \sum_{i=1}^n \sum_{j=1}^n x_i y_j (e_i, e_j) = \sum_{i=1}^n x_i y_i,$
  так как $(e_i, e_i) = 1$ и $(e_i, e_j) = 0$ при $i \neq j$. $\square$

### Свойство 2
- Пусть $V$ — пространство со скалярным произведением над $\mathbb{C}$, $e_1, \dots, e_n$ — ортонормированный базис $V$, $x, y \in V$, причем $x = (x_1, \dots, x_n)^T$ и $y = (y_1, \dots, y_n)^T$ — координаты векторов в указанном базисе. Тогда:
  $$
  (x, y) = \sum_{i=1}^n x_i \cdot \overline{y_i}.
  $$

#### Доказательство
- $(x, y) = \left(\sum_{i=1}^n x_i e_i, \sum_{j=1}^n y_j e_j\right) = \sum_{i=1}^n \sum_{j=1}^n x_i \cdot \overline{y_j} (e_i, e_j) = \sum_{i=1}^n x_i \cdot \overline{y_i},$
  так как $(e_i, e_i) = 1$ и $(e_i, e_j) = 0$ при $i \neq j$.

# Ортогонализация набора векторов.
## Ортогонализация Грама-Шмидта

### Теорема 6
- Пусть $V$ — пространство со скалярным произведением над $K$, а $e_1, \dots, e_m \in V$. Тогда существует такой ортогональный набор векторов $f_1, \dots, f_m \in V$, что для любого $p \in \{1, \dots, m\}$ выполнено $\text{Lin}(f_1, \dots, f_p) = \text{Lin}(e_1, \dots, e_p)$.

#### Доказательство
- Будем доказывать утверждение индукцией по $m$.
- **База** для $m = 1$ очевидна: возьмем $f_1 = e_1$.
- **Переход**. Пусть набор $f_1, \dots, f_k$ уже построен.
- Будем искать следующий вектор в виде:
  $$
  f_{k+1} = e_{k+1} + \sum_{i=1}^k \alpha_i f_i.
  $$
- Так как $\text{Lin}(e_1, \dots, e_k) = \text{Lin}(f_1, \dots, f_k)$ и по построению $f_{k+1}$, мы имеем:
  $$
  \text{Lin}(f_1, \dots, f_k, f_{k+1}) = \text{Lin}(f_1, \dots, f_k, e_{k+1}) = \text{Lin}(e_1, \dots, e_k, e_{k+1}).
  $$
- Если $f_i = 0$, коэффициент $\alpha_i$ может быть любым. Пусть $f_i \neq 0$.
- Для того, чтобы найти коэффициент $\alpha_i$ (где $i \in \{1, \dots, k\}$), заметим, что:
  $$
  0 = (f_{k+1}, f_i) = (e_{k+1}, f_i) + \sum_{j=1}^k \alpha_j (f_j, f_i) = (e_{k+1}, f_i) + \alpha_i (f_i, f_i),
  $$
  откуда $\alpha_i = -\frac{(e_{k+1}, f_i)}{(f_i, f_i)}$.
- Если векторы $e_1, \dots, e_k$ (где $k \leq m$) попарно ортогональны, то алгоритм ортогонализации их не изменит, и мы получим $f_i = e_i$ для всех $i \in \{1, \dots, k\}$.

## Следствие 2
- Любое подпространство $W < V$ имеет ортогональный и ортонормированный базис.

#### Доказательство
- Рассмотрим базис $W$ и подвергнем его ортогонализации — получится ортогональный базис $e_1, \dots, e_n$.
- Базис $e'_1, \dots, e'_n$, где $e'_i = \frac{e_i}{\sqrt{(e_i, e_i)}}$, — ортонормированный (извлечение квадратного корня корректно, так как $(e_i, e_i)$ — положительное вещественное число).

# Ортогональное дополнение: теорема о размерности и прямой сумме.

## Ортогональное дополнение

### Определение
- Пусть $K \in \{\mathbb{R}, \mathbb{C}\}$, а $V$ — пространство над $K$ со скалярным произведением.
- Для $W < V$ определим ортогональное дополнение как:
  $$
  W^\perp = \{x \in V : \forall w \in W \ (x, w) = 0\}.
  $$

### Теорема 7
- Пусть $W < V$, $\dim(V) = n$, $\dim(W) = m$. Тогда:
  - $W^\perp < V$,
  - $\dim(W^\perp) = n - m$,
  - $W \oplus W^\perp = V$,
  - $(W^\perp)^\perp = W$.

#### Доказательство
- Пусть $f_1, \dots, f_m$ — ортогональный базис $W$, который мы уже научились строить.
- Дополним его до базиса $V$, пусть получился базис $f_1, \dots, f_m, e_{m+1}, \dots, e_n$.
- Применим к этому базису ортогонализацию Грама-Шмидта, пусть в результате получились векторы $f_1, \dots, f_m, f_{m+1}, \dots, f_n$ (напомним, что первые $m$ векторов не изменились!).
- Рассмотрим $U = \text{Lin}(f_{m+1}, \dots, f_n)$.

#### Утверждение 1
- $U \subset W^\perp$.

##### Доказательство
- Пусть $u \in U$, $w \in W$. Нам нужно доказать, что $(w, u) = 0$.
- Тогда $w = \sum_{i=1}^m \alpha_i f_i$ и $u = \sum_{j=m+1}^n \beta_j f_j$, где $\alpha_i, \beta_j \in \mathbb{R}$.
- Так как для любых $i \in \{1, \dots, m\}$ и $j \in \{m+1, \dots, n\}$ мы имеем $(f_i, f_j) = 0$:
  $$
  (w, u) = \sum_{i=1}^m \sum_{j=m+1}^n \alpha_i \cdot \overline{\beta_j} \cdot (f_i, f_j) = 0.
  $$

#### Утверждение 2
- $U \supset W^\perp$.

##### Доказательство
- Пусть $x \in W^\perp$. Тогда $x = \sum_{i=1}^n \alpha_i f_i$.
- Для любого $s \in \{1, \dots, m\}$ имеем:
  $$
  0 = (x, f_s) = \sum_{i=1}^n \alpha_i (f_i, f_s) = \alpha_s (f_s, f_s),
  $$
  откуда следует, что $\alpha_s = 0$. Но тогда $x \in U$.

#### Итог
- Таким образом, $W^\perp = U = \text{Lin}(f_{m+1}, \dots, f_n)$ и $\dim(W^\perp) = n - m$.
- Так как $f_1, \dots, f_m, f_{m+1}, \dots, f_n$ — базис $V$, то $0$ единственным образом представляется в виде линейной комбинации этих векторов.
- Следовательно:
  $$
  V = \text{Lin}(f_1, \dots, f_m) \oplus \text{Lin}(f_{m+1}, \dots, f_n) = W \oplus W^\perp.
  $$
- Теперь возьмем ортогональный базис $f_{m+1}, \dots, f_n$ пространства $W^\perp$, дополним его векторами $f_1, \dots, f_m$ до базиса $V$.
- Этот базис и так ортогонален, и мы аналогично сказанному выше получаем, что:
  $$
  (W^\perp)^\perp = \text{Lin}(f_1, \dots, f_m) = W.
  $$

# Свойства ортогонального дополнения: сумма и пересечение.

## Свойства ортогонального дополнения

### Свойство 1
- Пусть $W, U < V$, причем $W \subset U$. Тогда $U^\perp \subset W^\perp$.

#### Доказательство
- Непосредственное следствие определения.

### Свойство 2
- Пусть $W, U < V$. Тогда:
  $$
  (W + U)^\perp = W^\perp \cap U^\perp.
  $$

#### Доказательство
- По Свойству 1, $(W + U)^\perp \subset W^\perp$ и $(W + U)^\perp \subset U^\perp$, следовательно:
  $$
  (W + U)^\perp \subset W^\perp \cap U^\perp.
  $$
- Наоборот, пусть $a \in W^\perp \cap U^\perp$.
- Рассмотрим любой вектор $x \in W + U$. Тогда $x = y + z$, где $y \in W$ и $z \in U$.
- Так как $a \in W^\perp$, мы имеем $(a, y) = 0$. Так как $a \in U^\perp$, мы имеем $(a, z) = 0$.
- Но тогда:
  $$
  (a, x) = (a, y + z) = (a, y) + (a, z) = 0.
  $$
- Следовательно:
  $$
  W^\perp \cap U^\perp \subset (W + U)^\perp.
  $$

### Свойство 3
- Пусть $W, U < V$. Тогда:
  $$
  (W \cap U)^\perp = W^\perp + U^\perp.
  $$

#### Доказательство
- По Свойству 2 мы имеем:
  $$
  (W^\perp + U^\perp)^\perp = (W^\perp)^\perp \cap (U^\perp)^\perp = W \cap U.
  $$
- Следовательно:
  $$
  (W \cap U)^\perp = (W^\perp + U^\perp)^{\perp\perp} = W^\perp + U^\perp.
  $$

# Теорема об изоморфизме, сохраняющем скалярное произведение.
## Теорема 8

### Утверждение
- Пусть $V$ и $U$ — два пространства со скалярным произведением над $K \in \{\mathbb{R}, \mathbb{C}\}$, $\dim(V) = \dim(U) = n$. Тогда существует изоморфизм (то есть, биективное линейное отображение) $\varphi : V \to U$, сохраняющий скалярное произведение (то есть, $(x, y) = (\varphi(x), \varphi(y))$ для любых $x, y \in V$).

### Доказательство
- Пусть $e_1, \dots, e_n$ — ортонормированный базис $V$, а $f_1, \dots, f_n$ — ортонормированный базис $U$.
- Зададим $\varphi$ формулами $\varphi(e_i) = f_i$ для всех $i \in \{1, \dots, n\}$.
- Если $(x_1, \dots, x_n)^T$ — координаты $x \in V$ в базисе $e_1, \dots, e_n$, то $\varphi(x)$ имеет такие же координаты в базисе $f_1, \dots, f_n$.
- Аналогично, пусть $(y_1, \dots, y_n)^T$ — координаты $y \in V$ в базисе $e_1, \dots, e_n$ и $\varphi(y)$ в базисе $f_1, \dots, f_n$.

#### Случай $K = \mathbb{R}$
- Тогда:
  $$
  (x, y) = \sum_{i=1}^n x_i y_i = (\varphi(x), \varphi(y)).
  $$

#### Случай $K = \mathbb{C}$
- Тогда:
  $$
  (x, y) = \sum_{i=1}^n x_i \cdot \overline{y_i} = (\varphi(x), \varphi(y)).
  $$