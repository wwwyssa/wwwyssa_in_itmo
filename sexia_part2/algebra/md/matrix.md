# 7. Матрицы, определители и системы линейных уравнений

# Матрицы. Сложение, умножение. Свойства. Кольцо квадратных матриц $M_n(K).$

## Определение
- Пусть $K$ — коммутативное кольцо, $m, n \in \mathbb{N}$. Обозначим через $M_{m,n}(K)$ множество матриц с $m$ строками и $n$ столбцами, коэффициенты которых принадлежат кольцу $K$.
- При $m = n$ (для квадратных матриц $n \times n$) используют обозначение $M_n(K)$ вместо $M_{n,n}(K)$.
- Матрица $A \in M_{m,n}(K)$ имеет вид $\{a_{i,j}\}_{i \in \{1, \dots, m\}, j \in \{1, \dots, n\}}$, где все $a_{i,j} \in K$.

### Сложение матриц
- Для $A, B \in M_{m,n}(K)$ зададим матрицу $A + B \in M_{m,n}(K)$ формулой:
  $$
  \forall i \in \{1, \dots, m\}, \forall j \in \{1, \dots, n\}, \ (A + B)_{i,j} := a_{i,j} + b_{i,j}.
  $$

### Умножение матриц
- Для $A \in M_{m,n}(K)$ и $B \in M_{n,\ell}(K)$ зададим матрицу $A \cdot B \in M_{m,\ell}(K)$ формулой:
  $$
  \forall i \in \{1, \dots, m\}, \forall j \in \{1, \dots, \ell\}, \ (A \cdot B)_{i,j} := \sum_{s=1}^{n} a_{i,s} b_{s,j}.
  $$

### Свойства матриц
- Очевидно, сложение матриц ассоциативно и коммутативно (так как сложение поэлементное, свойства наследуются из $K$).
- $0$-матрица имеет все коэффициенты, равные $0$.
- Обратная по сложению матрица $-A$ задается формулой:
  $$
  \forall i \in \{1, \dots, m\}, \forall j \in \{1, \dots, n\}, \ (-A)_{i,j} := -a_{i,j}.
  $$
  ## Свойство 1
- Умножение матриц ассоциативно.

### Доказательство
- Пусть $A \in M_{m,n}(K)$, $B \in M_{n,\ell}(K)$, $C \in M_{\ell,k}(K)$.
- Так как умножение в $K$ ассоциативно, имеем:
  $$
  ((ab)c)_{s,t} = \sum_{j=1}^{\ell} (ab)_{s,j}c_{j,t}=\sum_{j=1}^{\ell} \left( \sum_{i=1}^{n} a_{s,i}b_{i,j} \right)  \cdot c_{j,t} = \\
  = \sum_{i=1}^{n} \sum_{j=1}^{\ell} a_{s,i} \cdot b_{i,j} \cdot c_{j,t}
  = \sum_{i=1}^{n} a_{s,i} \cdot (bc)_{i,t} = (a(bc))_{s,t}.
  $$
- Таким образом, соответствующие коэффициенты матриц $(AB)C$ и $A(BC)$ одинаковы.
## Определение
- Пусть $K$ — кольцо с $1$. Определим матрицу $E_n \in M_n(K)$ формулами:
  $$
  a_{i,i} = 1, \quad a_{i,j} = 0 \ \text{при} \ i \neq j.
  $$

### Свойство 2
- Для любой матрицы $B \in M_{n,\ell}(K)$ выполнено $E_n \cdot B = B$.
- Для любой матрицы $A \in M_{m,n}(K)$ выполнено $A \cdot E_n = A$.
- Оба равенства легко проверяются.

## Теорема 1
- Пусть $K$ — коммутативное кольцо, $n \in \mathbb{N}$. Тогда $M_n(K)$ — кольцо. Если $K$ — кольцо с $1$, то и $M_n(K)$ тоже.

### Доказательство
- Сложение коммутативно и ассоциативно, нейтральный элемент ($0$-матрица) и обратный элемент по сложению определены.
- Умножение ассоциативно (Свойство 1).
- Если $K$ — кольцо с $1$, то $E_n \in M_n(K)$ — нейтральный элемент по умножению (Свойство 2).
- Осталось проверить дистрибутивность. Пусть $A, B, C \in M_n(K)$.
  $$
  ((a + b)c)_{s,t} = \sum_{i=1}^{n} (a+ b)_{s,i}  c_{i,t} = \sum_{i=1}^{n} a_{s,i} c_{i,t} + \sum_{i=1}^{n} b_{s,i} c_{i,t} = (ac)_{s,t} + (bc)_{s,t}.
  $$
- Таким образом, соответствующие коэффициенты матриц $(A + B)C$ и $AC + BC$ одинаковы, а значит:
  $$
  (A + B)C = AC + BC.
  $$
- Дистрибутивность $C(A + B) = CA + CB$ проверяется аналогично.

# Определитель. Определение и свойства (1 элементарное преобразование, определитель с двумя одинаковыми строками)

## Определитель

### Определение
Пусть $K$ — коммутативное кольцо, $n \in \mathbb{N}$, $A \in M_n(K)$.  
Тогда **определитель** матрицы $A$ — это  
$$
\text{det}(A) = \sum_{\sigma \in S_n} \text{sign}(\sigma) \cdot a_{1,\sigma(1)} \cdots a_{n,\sigma(n)},
$$  
где $\text{sign}(\sigma) := (-1)^{I(\sigma)}$ — **знак** подстановки $\sigma$.

- Строки матрицы $A \in M_{m,n}(K)$ обозначаются $A_1, \ldots, A_m$, а столбцы — $A^{(1)}, \ldots, A^{(n)}$.
- Столбцы и строки удобно рассматривать как вектора из линейных пространств $K^n$ и $K^m$ соответственно.
- Определитель квадратной матрицы $A \in M_n(K)$ удобно рассматривать как функцию от $n$ аргументов — строк этой матрицы: $\text{det}(A_1, \ldots, A_n)$.
- Можно рассматривать определитель и как функцию от столбцов матрицы: $\text{det}(A^{(1)}, \ldots, A^{(n)})$.

### Элементарные преобразования матриц
1. Поменять местами две строки.
2. К одной строке прибавить другую, умноженную на $\lambda \in K$.
3. Умножить строку на $\lambda \in K$, отличное от $0$.

- Аналогичные элементарные преобразования можно выполнять и со столбцами матриц.

### Лемма 1
Все три элементарных типа преобразования обратимы, то есть имеют обратные элементарные преобразования.

#### Доказательство
- Элементарное преобразование типа (1) само себе обратно.
- Рассмотрим элементарное преобразование типа (2), пусть мы к $i$-й строке прибавили $j$-ю, умноженную на $\lambda$.
  - Тогда обратное преобразование — прибавить к $i$-й строке $j$-ю, умноженную на $-\lambda$.
- Наконец, обратное преобразование к умножению строки на $\lambda \neq 0$ — умножить её же на $\lambda^{-1}$.

## Свойства определителя

### Свойство 1
При элементарном преобразовании типа I определитель меняет знак.

#### Доказательство
- Пусть $A, A' \in M_n(K)$, причём $A'$ получена из $A$ перестановкой $i$-й и $j$-й строк ($A'_i = A_j$, $A'_j = A_i$, остальные строки у матриц совпадают).
- Для $\sigma \in S_n$ положим $\sigma' := \sigma \cdot (ij)$. Понятно, что $\sigma$ пробегает все значения из $S_n$, если и только если $\sigma'$ пробегает все значения из $S_n$. По Лемме 6.8, $\text{sign}(\sigma') = -\text{sign}(\sigma)$. Тогда
  ![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/algebra/1.png?raw=true)

- 2 сумма $->$ 3 сумма У нас есть биекция между $\sigma$ и $\sigma'$, так что можно их подменить и как бы кайф

## Свойство 2 определителя
 Определитель матрицы с двумя одинаковыми строками равен $0$.  
   
### Доказательство  
 - Пусть $A_i = A_j$. Тогда перемена местами этих двух строк не меняет матрицу, но должна по Свойству 1 менять знак определителя.  
 - Следовательно, $\text{det}(A) = 0$.  

# 3. Свойства определителя: умножение строки на число, разложение по строке, 2 элементарное преобразование.

## Свойство 3  
  Пусть $A, A' \in M_n(K)$, причём $A'$ получена из $A$ умножением $i$-й строки на $\lambda \in K$ ($A'_i = \lambda A_i$, остальные строки у матриц совпадают). Тогда $\text{det}(A') = \lambda \cdot \text{det}(A)$.  
   
### Доказательство  
  $$  
  \text{det}(A') = \sum_{\sigma \in S_n} \text{sign}(\sigma) \cdot a'_{1,\sigma(1)} \cdots a'_{i,\sigma(i)} \cdots a'_{n,\sigma(n)}.  
 $$  
 - Подставляя $a'_{i,\sigma(i)} = \lambda \cdot a_{i,\sigma(i)}$, получаем:  
 $$  
  \text{det}(A') = \sum_{\sigma \in S_n} \text{sign}(\sigma) \cdot a_{1,\sigma(1)} \cdots (\lambda \cdot a_{i,\sigma(i)}) \cdots a_{n,\sigma(n)} = \lambda \cdot \text{det}(A).  
 $$  
## Свойство 4  
  Определитель матрицы с нулевой строкой равен $0$.
 
 ## Свойство 5
(Разложение определителя по строке.) Пусть $A, A', A'' \in M_n(K)$, причём эти матрицы совпадают во всех строках, кроме $i$-й, а $A_i = A'_i + A''_i$. Тогда
$$
\text{det}(A) = \text{det}(A') + \text{det}(A'').
$$

### Доказательство
$$
\text{det}(A) = \sum_{\sigma \in S_n} \text{sign}(\sigma) \cdot a_{1,\sigma(1)} \cdots a_{i,\sigma(i)} \cdots a_{n,\sigma(n)} =
$$
$$
= \sum_{\sigma \in S_n} \text{sign}(\sigma) \cdot a_{1,\sigma(1)} \cdots (a'_{i,\sigma(i)} + a''_{i,\sigma(i)}) \cdots a_{n,\sigma(n)} =
$$
$$
= \sum_{\sigma \in S_n} \text{sign}(\sigma) \cdot a'_{1,\sigma(1)} \cdots a'_{i,\sigma(i)} \cdots a'_{n,\sigma(n)} +
\sum_{\sigma \in S_n} \text{sign}(\sigma) \cdot a''_{1,\sigma(1)} \cdots a''_{i,\sigma(i)} \cdots a''_{n,\sigma(n)} =
$$
$$
= \text{det}(A') + \text{det}(A'').
$$
$\square$

## Свойство 6
При элементарном преобразовании типа II определитель сохраняется.

### Доказательство
- Пусть $\lambda \in K$, $A, A' \in M_n(K)$, причём $A'$ получена из $A$ преобразованием $i$-й строки: $A'_i = A_i + \lambda A_j$ (остальные строки у матриц совпадают, $j \neq i$).
- Пусть матрица $A^*$ совпадает с $A$ во всех строках, кроме $i$, а $A^*_i = \lambda A_j$.
- По Свойствам 3 и 2:
  $$
  \text{det}(A^*) = \text{det}(A^*_1, \ldots, A^*_i, \ldots, A^*_j, \ldots, A^*_n) =
  \text{det}(A_1, \ldots, \lambda A_j, \ldots, A_j, \ldots, A_n) =
  \lambda \cdot \text{det}(A_1, \ldots, A_j, \ldots, A_j, \ldots, A_n) = 0.
  $$
- По Свойству 5:
  $$
  \text{det}(A') = \text{det}(A'_1, \ldots, A'_i, \ldots, A'_j, \ldots, A'_n) =
  \text{det}(A_1, \ldots, A_i + \lambda A_j, \ldots, A_j, \ldots, A_n) =
  \text{det}(A_1, \ldots, A_i, \ldots, A_j, \ldots, A_n) + \text{det}(A_1, \ldots, \lambda A_j, \ldots, A_j, \ldots, A_n) =
  \text{det}(A) + \text{det}(A^*) = \text{det}(A).
  $$

# Определитель транспонированной матрицы.

## Определение
Пусть $A \in M_{m,n}(K)$. **Транспонированная матрица** $A^T \in M_{n,m}(K)$ — это матрица с элементами $a^T_{i,j} := a_{j,i}$ (для всех $i \in \{1, \ldots, n\}$, $j \in \{1, \ldots, m\}$).

## Теорема 2
Пусть $A \in M_n(K)$. Тогда $\text{det}(A^T) = \text{det}(A)$.

### Доказательство
- По определению:
  $$
  \text{det}(A^T) = \sum_{\sigma \in S_n} \text{sign}(\sigma) \cdot a^T_{1,\sigma(1)} \cdots a^T_{n,\sigma(n)} = \sum_{\sigma \in S_n} \text{sign}(\sigma) \cdot a_{\sigma(1),1} \cdots a_{\sigma(n),n}. (*)
  $$
- Чтобы посчитать $\text{det}(A)$, нужно сложить те же произведения, что в $(\ast)$, вот только с какими знаками?
- Нужно переупорядочить $a_{\sigma(1),1} \cdots a_{\sigma(n),n}$ так, чтобы первые индексы шли в порядке $1, 2, \ldots, n$ (а не $\sigma(1), \sigma(2), \ldots, \sigma(n)$).
- Это означает, что к первым индексам нужно применить подстановку $\sigma^{-1}$, она же применится ко вторым индексам, и мы получим $a_{1,\sigma^{-1}(1)} \cdots a_{n,\sigma^{-1}(n)}$.
- Понятно, что $\sigma$ пробегает все значения из $S_n$, если и только если $\sigma^{-1}$ пробегает все значения из $S_n$.
- Так как по Теореме 6.3, $\text{sign}(\sigma^{-1}) = \text{sign}(\sigma)$, мы можем продолжить $(\ast)$:
  $$
  \text{det}(A^T) = \sum_{\sigma \in S_n} \text{sign}(\sigma) \cdot a_{1,\sigma^{-1}(1)} \cdots a_{n,\sigma^{-1}(n)} = \sum_{\sigma \in S_n} \text{sign}(\sigma^{-1}) \cdot a_{1,\sigma^{-1}(1)} \cdots a_{n,\sigma^{-1}(n)} = \text{det}(A).
  $$
$\square$

### Замечание
- Можно определить аналоги элементарных преобразований строк для столбцов.
- По Теореме 2 понятно, что аналоги всех свойств $1{-}6$ определителя верны и для столбцов вместо строк.

# Минор, алгебраическое дополнение. Сумма произведений элементов строки матрицы на алгебраические дополнения этой (другой) строки (без доказательства теоремы Лапласа).


## Минор и алгебраическое дополнение

### Определение
Пусть $A \in M_{m,n}(K)$ и $k \leq \min(m, n)$.
- Выделим строки с номерами $i_1 < i_2 < \cdots < i_k$ и столбцы с номерами $j_1 < j_2 < \cdots < j_k$.
- На их пересечении находится $k^2$ элементов, составим из них матрицу, не меняя порядка строк и столбцов. Определитель этой матрицы $\Delta$ называется минором порядка $k$.

### Определение
Пусть $A \in M_n(K)$, $k < n$, а $\Delta$ — минор со строками $i_1 < i_2 < \cdots < i_k$ и столбцами $j_1 < j_2 < \cdots < j_k$.
- Вычеркнем указанные строки и столбцы, после чего в остальных $n - k$ строках и $n - k$ столбцах аналогично определим минор $\Delta'$ порядка $n - k$ — это дополнительный минор для $\Delta$.
- Алгебраическое дополнение минора $\Delta$ — это
  $$
  A_\Delta = (-1)^{i_1 + \cdots + i_k + j_1 + \cdots + j_k} \Delta'.
  $$
  
## Теорема Лапласа

### Теорема 3
Пусть $A \in M_n(K)$, $k < n$, $1 \leq i_1 < i_2 < \cdots < i_k \leq n$. Тогда $\text{det}(A)$ равен сумме $\Delta \cdot A_\Delta$ по всем минорам $\Delta$ в строках $i_1, i_2, \ldots, i_k$ (при всех возможных выборах $k$ столбцов).


## Определение
Пусть $A \in M_n(K)$. Для $i, j \in \{1, \ldots, n\}$ обозначим через $A_{i,j}$ **алгебраическое дополнение** элемента $a_{i,j}$ (как минора порядка $1$). Это минор, полученный из $A$ вычеркиванием $i$-й строки и $j$-го столбца, умноженный на $(-1)^{i+j}$.

## Следствие 1
Пусть $A \in M_n(K)$, $s, t \in \{1, \ldots, n\}$, $s \neq t$. Тогда:
1. $\sum_{i=1}^n a_{s,i} A_{s,i} = \text{det}(A)$;
2. $\sum_{i=1}^n a_{t,i} A_{s,i} = 0$.

### Доказательство
1. [Теорема 3](#теорема-3) для разложения по $s$-й строке.
2. 
   - Пусть $A'$ получена из $A$ заменой $s$-й строки на $t$-ю (то есть $A'_s = A_t$ и $A'_j = A_j$ при $j \neq s$).
   - Тогда $A'_{s,i} = A_{s,i}$ и $a'_{s,i} = a_{t,i}$ для всех $i \in \{1, \ldots, n\}$.
   - Так как матрица $A'$ имеет две одинаковые строки, по пункту 1 имеем:
     $$
     0 = \text{det}(A') = \sum_{i=1}^n a'_{s,i} A'_{s,i} = \sum_{i=1}^n a_{t,i} A_{s,i}.
     $$

### Замечание
- Утверждения, аналогичные Теореме 3 и Следствию 1, верны и для столбцов вместо строк (транспонирование матрицы меняет местами строки и столбцы, но не меняет определитель).
- Таким образом, определитель можно раскладывать как по строкам, так и по столбцам.

# Теорема Лапласа.


### Теорема 3
Пусть $A \in M_n(K)$, $k < n$, $1 \leq i_1 < i_2 < \cdots < i_k \leq n$. Тогда $\text{det}(A)$ равен сумме $\Delta \cdot A_\Delta$ по всем минорам $\Delta$ в строках $i_1, i_2, \ldots, i_k$ (при всех возможных выборах $k$ столбцов).

### Доказательство

#### Утверждение 1
Сумма $\Delta \cdot A_\Delta$ по всем минорам $\Delta$ в строках $i_1, \ldots, i_k$ — это в точности сумма (с некоторыми знаками) произведений, входящих в $\text{det}(A)$.

#### Доказательство
- Рассмотрим
  $$
  \text{det}(A) = \sum_{\sigma \in S_n} \text{sign}(\sigma) a_{1,\sigma(1)} \cdots a_{n,\sigma(n)}
  $$
  и конкретное произведение $a_{1,\sigma(1)} \cdots a_{n,\sigma(n)}$, входящее в определитель.
- Для каждой из строк $i_1, i_2, \ldots, i_k$ отметим столбец с номером $\sigma(i_1), \sigma(i_2), \ldots, \sigma(i_k)$ соответственно.
- Мы получили $k$ столбцов, в которых расположены перемножаемые элементы, упорядочим их по возрастанию — пусть получится $j_1 < j_2 < \cdots < j_k$.
- Обозначим через $\Delta$ минор со строками $i_1, i_2, \ldots, i_k$ и столбцами $j_1, j_2, \ldots, j_k$. Тогда произведение $a_{i_1,\sigma(i_1)} \cdots a_{i_k,\sigma(i_k)}$ входит в минор $\Delta$ (с некоторым знаком).
- Элементы вида $a_{s,\sigma(s)}$ при $1 \leq s \leq n$, $s \notin \{i_1, \ldots, i_k\}$ попадут не в столбцы с номерами $j_1, \ldots, j_k$, следовательно, произведение этих $n - k$ элементов войдет в дополнительный минор $\Delta'$, а значит, и в алгебраическое дополнение $A_\Delta$ (опять же, с некоторым знаком).
- Таким образом, $a_{1,\sigma(1)} \cdots a_{n,\sigma(n)}$ входит в произведение $\Delta \cdot A_\Delta$ для столбцов $j_1, j_2, \ldots, j_k$ и не входит в другие аналогичные слагаемые.
- Наоборот, рассмотрим минор $\Delta$ в столбцах $j_1, \ldots, j_k$ и любое произведение из $\Delta \cdot A_\Delta$.
- В этом произведении в каждой строке взято ровно по одному элементу матрицы (для строк $i_1, \ldots, i_k$ — в миноре $\Delta$, для остальных строк — в $A_\Delta$), в каждом столбце взято тоже ровно по одному элементу матрицы (для столбцов $j_1, \ldots, j_k$ — в миноре $\Delta$, для остальных столбцов — в $A_\Delta$).
- Значит, это произведение с некоторым знаком входит в $\text{det}(A)$, и мы получаем обратное соответствие.

#### Утверждение 2
Для каждого минора $\Delta$ в строках $i_1, \ldots, i_k$ все произведения из $\Delta \cdot A_\Delta$ имеют такой же знак, какой они имеют в $\text{det}(A)$.

#### Доказательство
- Рассмотрим конкретный минор $\Delta$ в строках $i_1 < i_2 < \cdots < i_k$ и столбцах $j_1 < j_2 < \cdots < j_k$.
- Для удобства мы переделаем элементарными преобразованиями матрицу $A$ в матрицу $B$ так, чтобы минор $\Delta$ попал в верхний левый угол, и при этом порядок строк и порядок столбцов из $\Delta$ не поменялся, а также порядок остальных строк и порядок остальных столбцов не поменялся.
- Сначала займемся строками: строка $i_1$ всплывает наверх (на место строки $1$), меняясь местами последовательно со строками $i_1 - 1, \ldots, 2, 1$ — всего $i_1 - 1$ обмен.
- Потом аналогично строка $i_2$ всплывает на $2$ место, делая $i_2 - 2$ обмена, и так далее, строка $i_k$ всплывает на $k$ место за $i_k - k$ обменов.
- Аналогично, столбцы $j_1, \ldots, j_k$ двигаются налево, делая $j_1 - 1, \ldots, j_k - k$ обменов.
- В итоге получилась матрица $B$, а каждое из выполненных элементарных преобразований меняло знак определителя, поэтому:
  $$
  \text{det}(B) = (-1)^{(i_1 - 1) + \cdots + (i_k - k) + (j_1 - 1) + \cdots + (j_k - k)} \cdot \text{det}(A) = (-1)^{i_1 + \cdots + i_k + j_1 + \cdots + j_k} \cdot \text{det}(A).
  $$
- В этой матрице минор $\Delta$ занимает левый верхний угол, а его дополнительный минор — по построению, это по-прежнему $\Delta'$ — в правом нижнем углу.
- Поэтому алгебраическое дополнение $\Delta$ в матрице $B$ считается как:
  $$
  B_\Delta = (-1)^{1 + \cdots + k + 1 + \cdots + k} \cdot \Delta' = \Delta' = (-1)^{i_1 + \cdots + i_k + j_1 + \cdots + j_k} \cdot A_\Delta.
  $$
- Итак:
  $$
  \text{det}(B) = (-1)^{i_1 + \cdots + i_k + j_1 + \cdots + j_k} \cdot \text{det}(A), \quad \Delta \cdot B_\Delta = (-1)^{i_1 + \cdots + i_k + j_1 + \cdots + j_k} \cdot \Delta \cdot A_\Delta.
  $$
- Поэтому нам достаточно доказать Утверждение 2 для матрицы $B$.

- Рассмотрим $\Delta \cdot B_\Delta = \Delta \cdot \Delta'$.
- Как мы знаем:
  $$
  \Delta = \sum_{\tau \in S_k} (-1)^{I(\tau)} b_{1,\tau(1)} \cdots b_{k,\tau(k)}.
  $$
- С учетом того, что строки и столбцы в $\Delta'$ имеют в $B$ номера $k + 1, \ldots, n = k + (n - k)$, этот определитель можно переписать как:
  $$
  \Delta' = \sum_{\tau' \in S_{n-k}} (-1)^{I(\tau')} b_{k+1,k+\tau'(1)} \cdots b_{k+(n-k),k+\tau'(n-k)}.
  $$
- Для конкретных $\tau$ и $\tau'$ произведение:
  $$
  b_{1,\tau(1)} \cdots b_{k,\tau(k)} b_{k+1,k+\tau'(1)} \cdots b_{k+(n-k),k+\tau'(n-k)}
  $$
  входит в $\text{det}(B)$ со знаком $(-1)^{I(\sigma)}$, где $\sigma$ — подстановка, переставляющая $1, \ldots, k$ как $\tau$ и переставляющая $k + 1, \ldots, n = k + (n - k)$ как $k + \tau'$.
- Но инверсий между блоками из первых $k$ чисел и последних $n - k$ чисел в $\sigma$ нет (первые $k$ чисел не превосходят $k$, а все следующие больше $k$), поэтому $I(\sigma) = I(\tau) + I(\tau')$, что нам и нужно:
  $$
  \text{det}(B) = \sum_{\sigma \in S_n} (-1)^{I(\sigma)} b_{1,\sigma(1)} \cdots b_{n,\sigma(n)}.
  $$

- Из Утверждения 1 и Утверждения 2 следует Теорема.

# Определитель ступенчатой матрицы.

### Ступенчатые матрицы

#### Определение
Пусть $A_1, \ldots, A_k$ — квадратные матрицы, $A_i \in M_{n_i}(K)$, $n = n_1 + \cdots + n_k$, $A \in M_n(K)$.
- Будем говорить, что $A \in M^+(A_1, \ldots, A_k)$, если в матрице $A$ по диагонали расположены квадратные блоки $A_1, \ldots, A_k$, а все коэффициенты сверху от них равны $0$.
- Будем говорить, что $A \in M^-(A_1, \ldots, A_k)$, если в матрице $A$ по диагонали расположены квадратные блоки $A_1, \ldots, A_k$, а все коэффициенты снизу от них равны $0$.
- Матрицы из
  $$
  M(A_1, \ldots, A_k) := M^+(A_1, \ldots, A_k) \cup M^-(A_1, \ldots, A_k)
  $$
  называются ступенчатыми.
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/algebra/2.png?raw=true)


---

### Теорема 4
Пусть $A \in M(A_1, \ldots, A_k)$. Тогда
$$
\text{det}(A) = \prod_{i=1}^k \text{det}(A_i).
$$

#### Доказательство
- Индукция по $k$. База для $k = 1$ очевидна.
- Переход $k - 1 \to k$. Пусть $k \geq 2$, а матрица $B \in M(A_1, \ldots, A_{k-1})$ — как на рисунке выше. Тогда $A \in M(B, A_k)$.
- Пусть $m = n_1 + \cdots + n_{k-1}$. Тогда применим теорему Лапласа для разложения матрицы $A$ по строкам $1, \ldots, m$.
- Так как определитель матрицы с нулевым столбцом равен $0$, в этих строках есть только один ненулевой минор порядка $m$ — это $\text{det}(B)$.
- Тогда по Теореме 3 и индукционному предположению:
  $$
  \text{det}(A) = \text{det}(B) \cdot \text{det}(A_k) = \prod_{i=1}^k \text{det}(A_i).
  $$
$\square$
![Рисунок a](https://github.com/wwwyssa/wwwyssa_in_itmo/blob/main/sexia_part2/algebra/2.png?raw=true)

# Определитель произведения матриц.

## Определитель произведения матриц

### Теорема 5
Пусть $A, B \in M_n(K)$. Тогда $\text{det}(AB) = \text{det}(A)\text{det}(B)$.

### Доказательство
- Рассмотрим ступенчатую матрицу
  $$
  C =
  \begin{bmatrix}
  A & 0 \\
  -E_n & B
  \end{bmatrix}.
  $$
  (Здесь $-E_n$ — матрица с $-1$ по главной диагонали и остальными $0$.)

- Тогда $C \in M^+(A, B)$ и $\text{det}(C) = \text{det}(A)\text{det}(B)$ по Теореме 4.

- Элементарными преобразованиями столбцов типа II переведем $C$ в матрицу $D \in M_{2n}(K)$ так, чтобы в правой нижней четверти $B$ заменилась на нулевую матрицу.

- Для всех $k \in \{1, \ldots, n\}$ столбец $C_{n+k}$ имеет $n$ нулей, а далее располагается столбец $B_k$.

- Для всех $i \in \{1, \ldots, n\}$ столбец $C_i$ сверху содержит $A_i$, а нижние $n$ его элементов — это $-1$ на позиции $n+i$ и остальные $0$.

- Для всех $k \in \{1, \ldots, n\}$ проделаем следующие операции:
  - Прибавим $\sum_{i=1}^n b_{i,k}C_i$ к столбцу $C_{n+k}$ (каждое прибавление — элементарное преобразование типа II, не меняет определитель).
  - В результате из $C_{n+k}$ получился столбец $D_{n+k}$, нижние $k$ элементов которого — нули. (Элемент $c_{n+s,n+k} = b_{s,k}$ обнуляется при прибавлении $b_{s,k}C_s$ и не меняется при остальных преобразованиях.)
  - Верхние $k$ элементов столбца $C_{n+k}$ были нулями. В результате преобразований для каждого $s \in \{1, \ldots, n\}$ получилось:
    $$
    d_{s,n+k} = \sum_{i=1}^n a_{s,i} \cdot b_{i,k} = (ab)_{s,k}.
    $$

- Таким образом, $D =
  \begin{bmatrix}
  A & AB \\
  -E_n & 0
  \end{bmatrix}$.

- Применим к $D$ $n$ элементарных преобразований столбцов типа I: поменяем местами столбцы $D_k$ и $D_{n+k}$ для всех $k \in \{1, \ldots, n\}$.

- Получится матрица
  $$
  D^* =
  \begin{bmatrix}
  AB & A \\
  0 & -E_n
  \end{bmatrix}
  \in M^-(AB, E_n).
  $$

- Так как каждое элементарное преобразование типа I меняет знак определителя, по Теореме 4 имеем:
  $$
  \text{det}(D^*) = \text{det}(AB)\text{det}(-E_n) = (-1)^n \text{det}(AB),
  $$
  и
  $$
  \text{det}(D^*) = (-1)^n \text{det}(D) = (-1)^n \text{det}(C) = (-1)^n \text{det}(A)\text{det}(B).
  $$

- Откуда следует, что $\text{det}(AB) = \text{det}(A)\text{det}(B)$.

# Невырожденные (обратимые) матрицы. Матрица A обратима тогда и только тогда, когда определитель не равен 0. Обратимость матрицы, имеющей левую (правую) обратную.

## Определение
Пусть $A \in M_n(K)$. Взаимная матрица $\tilde{A} \in M_n(K)$ задается формулой $\tilde{a}_{i,j} := A_{j,i}$ для всех $i, j \in \{1, \ldots, n\}$.

- Для $\lambda \in K$ и $A \in M_n(K)$ через $\lambda A$ обозначается матрица, полученная из $A$ умножением всех коэффициентов на $\lambda$.

### Лемма 2
Для любой матрицы $A \in M_n(K)$ выполнено:
$$
A \cdot \tilde{A} = \tilde{A} \cdot A = \text{det}(A) \cdot E_n.
$$

### Доказательство
$$
(a \cdot \tilde{a})_{s,t} =
\sum_{i=1}^n a_{s,i} \cdot \tilde{a}_{i,t} =
\sum_{i=1}^n a_{s,i} \cdot A_{t,i} =
\begin{cases}
\text{det}(A), & \text{при } s = t, \\
0, & \text{при } s \neq t,
\end{cases}
$$
по [Следствию 1](#следствие-1). Значит, $A \cdot \tilde{A} = \text{det}(A) \cdot E_n$.

Аналогично:
$$
(\tilde{a} \cdot a)_{s,t} =
\sum_{i=1}^n \tilde{a}_{s,i} \cdot a_{i,t} =
\sum_{i=1}^n A_{i,s} \cdot a_{i,t} =
\begin{cases}
\text{det}(A), & \text{при } s = t, \\
0, & \text{при } s \neq t,
\end{cases}
$$
по аналогу Следствия 1 для столбцов. Значит, $\tilde{A} \cdot A = \text{det}(A) \cdot E_n$.

## Определение
Пусть $A \in M_n(K)$.
- Матрица $A$ — **обратимая справа**, если существует такая $B \in M_n(K)$, что $AB = E_n$.
- Матрица $A$ — **обратимая слева**, если существует такая $C \in M_n(K)$, что $CA = E_n$.
- Обратимая и слева, и справа матрица называется **обратимой**, или **невырожденной**. Остальные матрицы — **необратимые**, или **вырожденные**.
- Если $B \in M_n(K)$ такова, что $AB = BA = E_n$, то $B$ называется **обратной** к $A$ и применяется обозначение $A^{-1} = B$.
- Если обратная матрица к $A$ существует, то она единственна: мы знаем, что обратный элемент по умножению к обратимому элементу любого кольца ровно один.

## Теорема 6
1. Обратимые матрицы — это в точности матрицы, имеющие ненулевой определитель.
2. Обратимая слева (или справа) матрица обратима.

### Доказательство
1. 
   - Пусть $A, B \in M_n(K)$, $AB = E_n$. Тогда по [Теореме 5](#теорема-5):
     $$
     \text{det}(A)\text{det}(B) = \text{det}(AB) = \text{det}(E_n) = 1 \implies
     \text{det}(A) \neq 0, \ \text{det}(B) \neq 0.
     $$
   - Таким образом, матрица с нулевым определителем не может быть обратимой ни слева, ни справа.
   - Наоборот, пусть $\text{det}(A) \neq 0$, а $B = \text{det}(A)^{-1} \cdot \tilde{A}$.
   - По [Лемме 2](#лемма-2) мы имеем $AB = BA = E_n$. Значит, $A$ обратима.

2. Выше доказано, что обратимая слева или справа матрица имеет ненулевой определитель, а значит, она обратима.

# Строчный и столбцовый ранг матрицы. Сохранение строчного ранга при элементарных преобразованиях строк.

## Строчный и столбцовый ранг матрицы

### Определение
Пусть $A \in M_{m,n}(K)$.
- **Строчный ранг матрицы $A$** — это
  $$
  r_s(A) := \dim(\text{Lin}(A_1, \ldots, A_m)).
  $$
- **Столбцовый ранг матрицы $A$** — это
  $$
  r^s(A) := \dim(\text{Lin}(A^{(1)}, \ldots, A^{(n)})).
  $$
  это размерность линейной оболочки **строк/столбцов ** матрицы A.
- Наша цель — доказать, что $r_s(A) = r^s(A)$ для любой матрицы $A$. Это число называется **рангом $A$** и обозначается через $\text{rk}(A)$.

### Лемма 3
1. Строчный ранг сохраняется при элементарных преобразованиях строк.
2. Столбцовый ранг сохраняется при элементарных преобразованиях столбцов.

#### Доказательство
- Утверждения аналогичны, достаточно доказать первое.
- Пусть матрица $A' \in M_{n,m}(K)$ получена из $A$ элементарным преобразованием строк. Пусть $L = \text{Lin}(A_1, \ldots, A_n)$ и $L' = \text{Lin}(A'_1, \ldots, A'_n)$.
- Достаточно доказать, что $L = L'$, тогда
  $$
  r_s(A) = \dim(L) = \dim(L') = r_s(A').
  $$
- Если это преобразование типа I, то строки остаются теми же (просто в другом порядке), значит, $L = L'$.
- Пусть это преобразование типа III, скажем, $A'_i = \lambda A_i$ для $\lambda \in K$, $\lambda \neq 0$, а остальные строки матриц совпадают.
  - Тогда $A'_i = \lambda A_i \in L$, значит, $L' \subseteq L$.
  - Так как элементарные преобразования обратимы, аналогично $L \subseteq L'$, а значит, $L = L'$.
- Пусть это преобразование типа II, скажем, $A'_i = A_i + \lambda A_j$ для $\lambda \in K$, а остальные строки матриц совпадают.
  - Тогда $A'_i = A_i + \lambda A_j \in L$, значит, $L' \subseteq L$.
  - Так как элементарные преобразования обратимы, аналогично $L \subseteq L'$, а значит, $L = L'$.

### Лемма 4
Пусть $A, B \in M_{m,n}(K)$, причем $B$ получена из $A$ элементарным преобразованием строк, $1 \leq s_1 < \cdots < s_k \leq n$, $\lambda_1, \ldots, \lambda_k \in K$. Тогда
$$
\lambda_1 A^{(s_1)} + \cdots + \lambda_k A^{(s_k)} = 0 \iff \lambda_1 B^{(s_1)} + \cdots + \lambda_k B^{(s_k)} = 0.
$$

#### Доказательство
- Положим $c_{i,j} := a_{i,s_j}$ и $d_{i,j} := b_{i,s_j}$ для всех $i \in \{1, \ldots, m\}$, $j \in \{1, \ldots, k\}$. Рассмотрим однородную систему линейных уравнений:
  $$
  \begin{cases}
  c_{1,1} y_1 + \cdots + c_{1,k} y_k = 0, \\
  \vdots \\
  c_{m,1} y_1 + \cdots + c_{m,k} y_k = 0,
  \end{cases}
  $$
  и
  $$
  \begin{cases}
  d_{1,1} y_1 + \cdots + d_{1,k} y_k = 0, \\
  \vdots \\
  d_{m,1} y_1 + \cdots + d_{m,k} y_k = 0.
  \end{cases}
  $$
- Так как $B$ получена из $A$ элементарным преобразованием строк, вторая система получена из первой элементарным преобразованием.
- По Лемме 5.2, решения обеих систем совпадают.
**Лемма 5.2** 
- - 1) Элементарные преобразования всех трех типов обратимы, то есть имеют обратные элементарные преобразования. 
- - 2) Элементарные преобразования не меняют решений СЛУ.
- Для завершения доказательства достаточно отметить, что
  $$
  \lambda_1 A^{(s_1)} + \cdots + \lambda_k A^{(s_k)} = 0 \iff y_1 = \lambda_1, \ldots, y_k = \lambda_k
  $$
  — решение первой системы, и
  $$
  \lambda_1 B^{(s_1)} + \cdots + \lambda_k B^{(s_k)} = 0 \iff y_1 = \lambda_1, \ldots, y_k = \lambda_k
  $$
  — решение второй системы.

# Сохранение столбцового ранга при элементарных преобразованиях строк.
## Лемма 5
1. Столбцовый ранг сохраняется при элементарных преобразованиях строк.
2. Строчный ранг сохраняется при элементарных преобразованиях столбцов.

### Доказательство
- Утверждения аналогичны, достаточно доказать первое.
- Пусть $A, B \in M_{m,n}(K)$, причем $B$ получена из $A$ элементарным преобразованием строк.
- Пусть $L = \text{Lin}(A^{(1)}, \ldots, A^{(n)})$ и $L' = \text{Lin}(B^{(1)}, \ldots, B^{(n)})$.
- По Теореме 5.1 из $A^{(1)}, \ldots, A^{(n)}$ можно выбрать базис $L$ — пусть это $A^{(s_1)}, \ldots, A^{(s_k)}$. Тогда $r_s(A) = k$.
- - **Теорема 5.1** Пусть $V$ — конечно порожденное линейное пространство над полем $K$. Тогда $V$ имеет базис. Более того, из любой конечной порождающей системы векторов $V$ можно выделить базис.
- Тогда и $B^{(s_1)}, \ldots, B^{(s_k)}$ линейно независимы (если $\lambda_1 B^{(s_1)} + \cdots + \lambda_k B^{(s_k)} = 0$, то по [Лемме 4](#лемма-4) и $\lambda_1 A^{(s_1)} + \cdots + \lambda_k A^{(s_k)} = 0$, откуда $\lambda_1 = \cdots = \lambda_k = 0$).
- Значит, $r^{(s)}(B) \geq k = r^{(s)}(A)$.
- Так как элементарные преобразования обратимы, аналогично доказывается, что $r^{(s)}(A) \geq r^{(s)}(B)$.

## Определение
Для $r \leq \min(m, n)$ пусть $E^r \in M_{m,n}(K)$ — матрица, в которой $e_{i,i}^r = 1$ для всех $i \in \{1, \ldots, r\}$, а все остальные коэффициенты матрицы равны $0$.

## Лемма 6
Любую матрицу $A \in M_{m,n}(K)$ можно привести элементарными преобразованиями к матрице $E^r$ для некоторого $r \leq \min(m, n)$.

### Доказательство
- Мы будем менять матрицу, не переименовывая её.
- Если все элементы матрицы равны $0$, то $A = E^0$.
- Если в матрице есть ненулевой элемент, то можно считать, что $a_{1,1} \neq 0$ (иначе поменяем местами строки и столбцы так, чтобы ненулевой элемент оказался на этой позиции).
- Далее поделим первую строку на $a_{1,1}$, получим новую матрицу, в которой $a_{1,1} = 1$.
- Для всех $i \in \{2, \ldots, m\}$ заменим строку $A_i$ на $A_i - a_{i,1} A_1$. В результате этих элементарных преобразований в левом столбце все элементы, кроме $a_{1,1} = 1$, будут равны $0$.
- Теперь для всех $j \in \{2, \ldots, n\}$ заменим столбец $A^{(j)}$ на $A^{(j)} - a_{1,j} A^{(1)}$. В результате этих элементарных преобразований в первой строке все элементы, кроме $a_{1,1} = 1$, будут равны $0$. Элементы левого столбца не изменятся.
- Теперь рассмотрим подматрицу $A'$, полученную удалением первой строки и первого столбца. Аналогичными действиями меньшую матрицу $A'$ можно привести к виду $E^{r'}$.
- Выполним те же преобразования, что в матрице $A'$, со столбцами $2, \ldots, n$ и строками $2, \ldots, m$ матрицы $A$. В результате первая строка и первый столбец не изменятся, и мы получим матрицу $E^{r'+1}$.

# Равенство строчного и столбцового ранга матрицы.
## Теорема 7
Для любой матрицы $A \in M_{m,n}(K)$ выполнено:
$$
r_s(A) = r^s(A).
$$

### Доказательство
- По [Лемме 6](#лемма-6) для некоторого $r \leq \min(m, n)$ можно элементарными преобразованиями привести $A$ к $E^r$.
- Очевидно, $r_s(E^r) = r^d(E^r) = r$.
- По [Леммам 3](#лемма-3) и [5](#лемма-5) мы имеем:
  $$
  r_s(A) = r_s(E^r) = r = r^s(E^r) = r^s(A).
  $$
- Теперь мы знаем, что ранг матрицы определён корректно, и его можно вычислять как размерность пространства строк этой матрицы, так и как размерность пространства её столбцов.
- Если $A \in M_{m,n}(K)$, то $\text{rk}(A) \leq m$ и $\text{rk}(A) \leq n$.

# Сохранение наибольшего порядка ненулевого минора матрицы при элементарных преобразованиях.

## Лемма 7
При элементарных преобразованиях наибольший порядок ненулевого минора матрицы не изменяется.

### Доказательство
- Пусть $A, A' \in M_{m,n}(K)$, причем $A'$ получена из $A$ элементарным преобразованием.
- Можно считать, что это преобразование строк (иначе транспонируем матрицу, те же самые миноры останутся ненулевыми по [Теореме 2](#теорема-2), а строки поменяются местами со столбцами).

#### Утверждение
Если у матрицы $A$ нет ненулевых миноров порядка $k$, то и у матрицы $A'$ нет ненулевых миноров порядка $k$.

#### Доказательство
- Пусть $\Delta'$ — ненулевой минор порядка $k$ матрицы $A'$, а $\Delta$ — минор $A$ в тех же строках и столбцах. По условию $\Delta = 0$.
- Тогда $\Delta' \ne \Delta$ не является минором $A$, значит, содержит хотя бы одну из строк, над которыми произведено элементарное преобразование.
- Рассмотрим три случая.

#### Случай 1: элементарное преобразование имеет тип III
- Пусть строка матрицы $A$ умножена на $\lambda \in K$. Тогда
  $$
  \Delta' = \lambda \Delta = 0
  $$
  по Свойству 3 определителя, противоречие.

#### Случай 2: элементарное преобразование имеет тип I
- Пусть, скажем, $A'_i = A_j$ и $A'_j = A_i$.
- Если минор $\Delta'$ содержит части обеих строк $A'_i$ и $A'_j$, то в миноре $\Delta$ они просто стоят в обратном порядке, и $\Delta' = \Delta = 0$ по Свойству 1 определителя, противоречие.
- Пусть $\Delta'$ содержит часть $A'_i$, но не содержит часть $A'_j$.
  - Так как часть $A'_i$ — это аналогичная часть $A_j$, в этом случае матрица $A$ также имеет минор $\Delta^*$ с точно такими же строками и столбцами (нужно вместо строки $A_i$ взять $A_j$), возможно, расставленными в другом порядке.
  - Тогда $\Delta' = \pm \Delta^* = 0$, противоречие.

#### Случай 3: элементарное преобразование имеет тип II
- Пусть, скажем, $A'_i = A_i + \lambda A_j$.
- Пусть $\Delta' = \det(B')$, $\Delta = \det(B)$, где $B, B' \in M_k(K)$ — соответствующие матрицы. Тогда эти матрицы содержат части строк $A_i$ и $A'_i$ соответственно.
- Обозначим через $B^*$ матрицу, полученную из $B$ заменой части $A_i$ на соответствующую часть $A_j$.
- Разложим $\det(B')$ по строке $A'_i$ (точнее, её части). По [Свойству 5](#свойство-5) определителя:
  $$
  \Delta' = \det(B') = \det(B) + \lambda \det(B^*) = \lambda \det(B^*).
  $$
- Если $B$ содержит части строки $A_j$, то $B^*$ содержит две одинаковые строки, тогда по [Свойству 2](#свойство-2-определителя) определителя:
  $$
  \det(B^*) = 0,
  $$
  а значит, и $\Delta' = 0$, противоречие.
- Пусть $B$ не содержит части строки $A_j$. Тогда рассмотрим подматрицу $B^{**}$ матрицы $A$, в которой выбраны все строки матрицы $B$, кроме $A_i$, и строка $A_j$, а столбцы — те же, что в $B$.
- По условию:
  $$
  \det(B^{**}) = 0.
  $$
- Так как $B^*$ получается из $B^{**}$ перестановкой строк:
  $$
  \det(B^*) = \pm \det(B^{**}) = 0,
  $$
  откуда следует, что $\Delta' = 0$, противоречие.

### Возвращение к доказательству Леммы 7
- Так как обе матрицы $A$ и $A'$ получены друг из друга элементарным преобразованием, наибольший порядок ненулевого минора в них — одинаковый.

# Равенство ранга матрицы и наибольшего порядка ненулевого минора. Ранг невырожденной матрицы.

## Теорема 8
Для любой матрицы $A \in M_{m,n}(K)$ её ранг равен наибольшему порядку ненулевого минора в $A$.

### Доказательство
- По [Лемме 6](#лемма-6) матрицу $A$ можно привести элементарными преобразованиями к матрице $E^r$ для некоторого $r \leq \min(m, n)$.
- Тогда $\text{rk}(A) = \text{rk}(E^r) = r$.
- С другой стороны, наибольший порядок ненулевого минора в $E^r$ — это, очевидно, $r$. По [Лемме 7](#лемма-7), это верно и для $A$.

## Следствие 2
Матрица $A \in M_n(K)$ обратима, если и только если $\text{rk}(A) = n$.

### Доказательство
- $(\Rightarrow)$ Если $A$ — обратима, то $\det(A) \neq 0$ по [Теореме 6](#теорема-6). Значит, максимальный порядок ненулевого минора равен $n$, тогда и $\text{rk}(A) = n$ по [Теореме 8](#теорема-8).
- $(\Leftarrow)$ Если $\text{rk}(A) = n$, то по Теореме 8 матрица $A \in M_n(K)$ имеет ненулевой минор порядка $n$. Значит, $\det(A) \neq 0$, и по [Теореме 6](#теорема-6) матрица $A$ обратима.

# Матрицы элементарных преобразований. Представление матрицы в виде произведения элементарных матриц.
## Матрицы элементарных преобразований

- Пусть $A \in M_{m,n}(K)$.
- Элементарные преобразования матрицы $A$ можно представить в виде умножения $A$ на матрицы специального вида.

### Элементарное преобразование I типа

- Пусть $s, t \in \{1, \ldots, m\}$, $s \neq t$. Рассмотрим матрицу $E^{s,t}_m \in M_m(K)$, полученную из $E_m$ переменой позиций двух $1$:
  $$
  e^{s,t}(s, t) = e^{s,t}(t, s) = 1, \quad e^{s,t}(i, i) = 1 \text{ при } i \notin \{s, t\},
  $$
  остальные коэффициенты равны $0$.
- Нетрудно проверить, что $E^{s,t}_m \cdot A$ — это матрица, полученная из $A$ перестановкой $s$ и $t$ строк.
- Наоборот, пусть $s, t \in \{1, \ldots, n\}$, определим аналогично матрицу $E^{s,t}_n \in M_n(K)$.
- Тогда $A \cdot E^{s,t}_n$ — это матрица, полученная из $A$ перестановкой $s$ и $t$ столбцов.

### Элементарное преобразование II типа

- Пусть $s, t \in \{1, \ldots, m\}$, $s \neq t$, $\lambda \in K$. Рассмотрим матрицу $E^{s,t,\lambda}_m \in M_m(K)$, полученную из $E_m$ изменением одного $0$ на $\lambda$:
  $$
  e^{s,t,\lambda}(s, t) = \lambda \quad (\text{остальные коэффициенты как в единичной матрице } E_m).
  $$
- Нетрудно проверить, что $A' = E^{s,t,\lambda}_m \cdot A$ — это матрица, полученная из $A$ преобразованием II типа $A'_s = A_s + \lambda A_t$ (остальные строки в матрицах $A$ и $A'$ совпадают).
- Наоборот, пусть $s, t \in \{1, \ldots, n\}$, определим аналогично матрицу $E^{s,t,\lambda}_n$.
- Тогда $B = A \cdot E^{s,t,\lambda}_n \in M_n(K)$ — это матрица, полученная из $A$ преобразованием II типа $B^{(s)} = A^{(s)} + \lambda A^{(t)}$ (остальные столбцы в матрицах $A$ и $B$ совпадают).

### Элементарное преобразование III типа

- Пусть $s \in \{1, \ldots, m\}$, $\lambda \in K$, $\lambda \neq 0$. Рассмотрим матрицу $E^{s,\lambda}_m \in M_m(K)$, полученную из $E_m$ изменением одной $1$ на $\lambda$:
  $$
  e^{s,\lambda}_m(s, s) = \lambda \quad (\text{остальные коэффициенты как в единичной матрице } E_m).
  $$
- Нетрудно проверить, что $A' = E^{s,\lambda}_m \cdot A$ — это матрица, полученная из $A$ умножением $s$ строки на $\lambda$.
- Наоборот, пусть $s \in \{1, \ldots, n\}$, определим аналогично матрицу $E^{s,\lambda}_n \in M_n(K)$.
- Тогда $A' = A \cdot E^{s,\lambda}_n$ — это матрица, полученная из $A$ умножением $s$ столбца на $\lambda$.

# Алгоритм поиска обратной матрицы с помощью элементарных преобразований строк.

## Алгоритм поиска обратной матрицы

- Пусть $A \in M_n(K)$. По [Лемме 6](#лемма-6) матрицу $A$ можно привести элементарными преобразованиями к виду $E^r$, где $r \leq n$.
- Если $r < n$, то $\text{rk}(A) = r < n$ и матрица $A$ по [Следствию 2](#следствие-2) необратима.
- Пусть $r = n$, произведены элементарные преобразования строк с матрицами $P_1, \ldots, P_k$ (в указанном порядке) и элементарные преобразования столбцов с матрицами $Q_1, \ldots, Q_\ell$ (в указанном порядке). Тогда
  $$
  P_k \cdots P_1 \cdot A \cdot Q_1 \cdots Q_\ell = E_n \implies
  A = P_1^{-1} \cdots P_k^{-1} \cdot E_n \cdot Q_\ell^{-1} \cdots Q_1^{-1} \implies
  A^{-1} = Q_1 \cdots Q_\ell \cdot P_k \cdots P_1.
  $$
- Каждую матрицу можно элементарными преобразованиями строк привести к **ступенчатому виду**: пусть $s_1 < s_2 < \cdots < s_k$, тогда $i$-я строка матрицы для $i \in \{1, \ldots, k\}$ будет иметь вид:
  $$
  a_{i,j} = 0 \text{ при } j < s_i, \quad a_{i,s_i} = 1, \quad \text{далее произвольные коэффициенты};
  $$
  строки с номерами более $k$ будут нулевыми. (Алгоритм для СЛУ из Леммы 5.3 легко применяется для матриц.)
- Если $A \in M_n(K)$ — невырожденная матрица, то $k = n$ и $s_i = i$ для любых $i \in \{1, \ldots, n\}$ (иначе $A$ имеет нулевую строку, а значит, $\det(A) = 0$, что не так).
- Значит, $A$ приводится элементарными преобразованиями строк к верхнетреугольному виду: на главной диагонали $1$, под ней $0$.
- Теперь элементарными преобразованиями строк несложно обнулить верхний треугольник (все элементы над главной диагональю).
- Таким образом, мы приведем $A$ к единичной матрице элементарными преобразованиями только строк, что бывает удобно.
- Соответственно, формула обратной матрицы будет иметь вид $A^{-1} = P_k \cdots P_1$.

# Совместность системы линейных уравнений. Теорема Кронекера-Капелли

### Матричная запись СЛУ

- Пусть $K$ — поле, $a_{i,j} \in K$ (где $i \in \{1, \ldots, n\}$, $j \in \{1, \ldots, m\}$).
- Рассмотрим СЛУ с неизвестными $x_1, \ldots, x_m$:
  $$
  \begin{cases}
  a_{1,1}x_1 + a_{1,2}x_2 + \cdots + a_{1,m}x_m = b_1, \\
  a_{2,1}x_1 + a_{2,2}x_2 + \cdots + a_{2,m}x_m = b_2, \\
  \vdots \\
  a_{n,1}x_1 + a_{n,2}x_2 + \cdots + a_{n,m}x_m = b_n.
  \end{cases}
  $$

- Матрица системы $(*)$ — это матрица $A \in M_{n,m}(K)$ с коэффициентами $a_{i,j}$. Положим $X = (x_1, \ldots, x_m)^T$ — столбец неизвестных, $B = (b_1, \ldots, b_n)^T$.
- $AX = B$ — матричная запись системы $(*)$.
- $(A|B)$ — расширенная матрица системы $(*)$ (справа добавлен столбец $B$).
- Система $(*)$ называется совместной, если она имеет решение.
- ОСЛУ всегда совместна, так как имеет нулевое решение.

## Теорема Кронекера-Капелли

### Теорема 9
- СЛУ $AX = B$ совместна, если и только если $\text{rk}(A) = \text{rk}(A|B)$.

### Доказательство
- $AX = B$ совместна
  $$
  \iff \exists X \in K^m : AX = B \iff \exists x_1, \ldots, x_m \in K : x_1A^{(1)} + x_2A^{(2)} + \cdots + x_mA^{(m)} = B
  $$
  $$
  \iff B \in \text{Lin}(A^{(1)}, \ldots, A^{(m)}) \iff \text{Lin}(A^{(1)}, \ldots, A^{(m)}) = \text{Lin}(A^{(1)}, \ldots, A^{(m)}, B)
  $$
  $$
  \iff \dim(\text{Lin}(A^{(1)}, \ldots, A^{(m)})) = \dim(\text{Lin}(A^{(1)}, \ldots, A^{(m)}, B)) \iff \text{rk}(A) = \text{rk}(A|B).
  $$

- Равенство двух линейных оболочек эквивалентно равенству их размерностей (предпоследний переход), так как одна из них является линейным подпространством другой.

# Пространство решений однородной системы линейных уравнений.
## Пространство решений однородной системы линейных уравнений

- Как нам известно из Леммы 5.3, любую ОСЛУ можно привести к ступенчатому виду, от этого множество решений не меняется.
- Итак, мы имеем ОСЛУ в ступенчатом виде: пусть $1 \leq s_1 < s_2 < \cdots < s_k \leq m$,
  $$
  \begin{cases}
  x_{s_1} + a_{1,s_1+1}x_{s_1+1} + \cdots + a_{1,m}x_m = 0, \\
  x_{s_2} + a_{2,s_2+1}x_{s_2+1} + \cdots + a_{2,m}x_m = 0, \\
  \vdots \\
  x_{s_k} + a_{k,s_k+1}x_{s_k+1} + \cdots + a_{k,m}x_m = 0.
  \end{cases}
  $$
- Назовем главными все переменные, кроме $x_{s_1}, \ldots, x_{s_k}$.

### Лемма 8
- Пусть $A$ — матрица системы $(*)$. Тогда $\text{rk}(A) = k$.

#### Доказательство
- $\text{rk}(A) = \dim(\text{Lin}(A_1, \ldots, A_k))$. Таким образом, нам нужно доказать, что все строки матрицы $A$ линейно независимы.
- Сделаем это индукцией по $k$.
  - База $k = 1$ очевидна.
  - Докажем переход:
    - Пусть $\lambda_1, \ldots, \lambda_k \in K$ таковы, что $\lambda_1A_1 + \cdots + \lambda_kA_k = 0$.
    - В столбце $s_1$ есть $1$ в строке $A_1$, остальные коэффициенты равны $0$. Значит, $\lambda_1 = 0$.
    - Теперь $\lambda_2A_2 + \cdots + \lambda_kA_k = 0$, и по индукционному предположению имеем $\lambda_2 = \cdots = \lambda_k = 0$, то есть, строки $A$ линейно независимы.

### Лемма 9
- Решения ОСЛУ $AX = 0$ $(*)$ с $A \in M_{n,m}(K)$ образуют линейное подпространство $K^m$.

#### Доказательство
- Пусть $U \subset K^m$ — множество всех решений. Тогда $X \in U \iff AX = 0$.
- Пусть $X_1, X_2 \in U$, $\lambda \in K$.
  - Тогда $A(X_1 + X_2) = A(X_1) + A(X_2) = 0 + 0 = 0$, значит, $X_1 + X_2 \in U$.
  - Тогда $A(\lambda X_1) = \lambda A(X_1) = \lambda 0 = 0$, значит, $\lambda X_1 \in U$.
- По Лемме 5.1 получаем, что $U$ — линейное подпространство $K^m$.

### Определение
- $U$ называется пространством решений системы $(*)$.

- Напомним: пусть $1 \leq s_1 < s_2 < \cdots < s_k \leq m$,
   $$
  \begin{cases}
  x_{s_1} + a_{1,s_1+1}x_{s_1+1} + \cdots + a_{1,m}x_m = 0, \\
  x_{s_2} + a_{2,s_2+1}x_{s_2+1} + \cdots + a_{2,m}x_m = 0, \\
  \vdots \\
  x_{s_k} + a_{k,s_k+1}x_{s_k+1} + \cdots + a_{k,m}x_m = 0.
  \end{cases}
  $$
- Главные переменные — все, кроме $x_{s_1}, \ldots, x_{s_k}$.

### Лемма 10
- Для любого набора значений главных переменных существует единственное решение системы с такими значениями.

#### Доказательство
- Из $k$-го уравнения однозначно вычисляется $x_{s_k}$ (все переменные с большими номерами нам известны).
- Потом из $(k-1)$-го уравнения однозначно вычисляется $x_{s_{k-1}}$, и так далее, однозначно находятся значения всех неглавных переменных.
- Если в решении $(*)$ все главные переменные равны $0$, то и все остальные тоже равны $0$ (это следует из Леммы 10, а кроме того, несложно проверить напрямую).


# Размерность пространства решений однородной системы линейных уравнений.

## Теорема 10
Пусть $U$ — пространство решений ОСЛУ $AX = 0$ $(*)$ с $m$ неизвестными. Тогда $\dim(U) = m - \text{rk}(A)$.

### Доказательство
- Так как $\text{rk}(A) = \dim(\text{Lin}(A_1, \ldots, A_k)) = k$, достаточно доказать, что $\dim(U)$ равняется количеству главных переменных.
- Пронумеруем главные переменные: $x_{i_1}, \ldots, x_{i_{m-k}}$.
- Определим решение $r^s \in U$: Положим $r^s_{i_s} = 1$ и $r^s_{i_j} = 0$ при $j \in \{1, \ldots, m-k\}, j \neq s$. После чего по Лемме 10 однозначно определим значения неглавных переменных.

#### Докажем, что $r^1, \ldots, r^{m-k}$ — базис $U$.

##### Порождающая система
- Пусть $x \in U$. Рассмотрим
  $$
  x' = x_{i_1}r^1 + \cdots + x_{i_{m-k}}r^{m-k}.
  $$
- По [Лемме 9](#лемма-9), $x' \in U$.
- Заметим, что
  $$
  x'_{i_s} = \sum_{j=1}^{m-k} x_{i_j}r^j_{i_s} = x_{i_s}r^s_{i_s} = x_{i_s},
  $$
  для всех $s \in \{1, \ldots, m-k\}$.
- Таким образом, $x, x' \in U$ — два решения $(*)$, в которых совпадают все значения главных переменных.
- По [Лемме 10](#лемма-10) тогда $x = x'$. Значит, $x \in \text{Lin}(r^1, \ldots, r^{m-k})$.

##### Линейная независимость
- Пусть $\alpha_1r^1 + \cdots + \alpha_{m-k}r^{m-k} = 0$.
- Тогда для любого $s \in \{1, \ldots, m-k\}$
  $$
  \alpha_1r^1_{i_s} + \cdots + \alpha_{m-k}r^{m-k}_{i_s} = 0.
  $$
- Так как $r^j_{i_s} = 0$ при $j \neq s$ и $r^s_{i_s} = 1$, отсюда следует, что $\alpha_s = 0$.
- Таким образом, $r^1, \ldots, r^{m-k}$ — ЛНЗ, а следовательно, базис пространства решений системы $(*)$.

- Следовательно, $\dim(U) = m - k = m - \text{rk}(A)$.

### Определение
**Фундаментальная система решений** ОСЛУ $AX = 0$ — это любой базис её пространства решений.

# Решения неоднородной системы линейных уравнений.

## Решения неоднородной СЛУ

- Рассмотрим совместную СЛУ $AX = B$ $(*)$ с $m$ неизвестными и соответствующую ей ОСЛУ $AX = 0$ $(**)$.
- Как мы знаем, решения ОСЛУ $(**)$ образуют линейное пространство — пространство решений $U$.

### Лемма 11

- Множество решений $W$ системы $(*)$ — аффинное подпространство $K^m$. Если $U$ — пространство решений системы $(**)$, а $X^0$ — решение $(*)$, то $W = U + X^0$.

#### Доказательство

- Достаточно доказать второе утверждение.
- Пусть $X' \in W$. Тогда
  $$
  A(X' - X^0) = AX' - AX^0 = B - B = 0,
  $$
  значит, $X' - X^0 \in U$.
- Наоборот, пусть $X' \in U + X^0$.
- Тогда $X' - X^0 \in U$, значит,
  $$
  AX' = AX^0 + A(X' - X^0) = B + 0 = B,
  $$
  следовательно, $X' \in W$.
- Таким образом, $W = U + X^0$.